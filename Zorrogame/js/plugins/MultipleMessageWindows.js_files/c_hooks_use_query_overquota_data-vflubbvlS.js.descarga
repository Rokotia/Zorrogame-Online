!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="4e09d91b-9a21-3528-bd13-021787ce203d")}catch(e){}}();
define(["exports","react","./e_file_viewer_static_scl_page_file","./c_data_store","./c_quota_use_query_quota_upsell_info","./e_data_modules_stormcrow"],(function(e,t,a,o,u,i){"use strict";function r(e){var t,o,u;const i=null!==(t=null==e?void 0:e.path)&&void 0!==t?t:"/get_info_for_quota_upsell",r=null!==(o=null==e?void 0:e.routeParams)&&void 0!==o?o:{},s=null!==(u=null==e?void 0:e.base)&&void 0!==u?u:window.location.origin;return new a.AjaxURL(a.replacePattern(i,r),s)}const s=["UploadOverQuotaFetch"],n=18e4,_=6e5,m=new a.DbxGrowthBook({});e.UPLOAD_OVERQUOTA_FETCH_KEY=s,e.useQueryOverQuota=e=>{const l=a.useSelector(o.getUserSelector(e)),d=o.getUploadActionCreators(l),c=a.useSelector(o.getPathStartsWithCdmTmfPathSelector(e)),v=a.useDispatch(),f=u.useQuotaUpsellInfo(l),[p,Q]=t.useState(!1);t.useEffect((()=>{l&&m.init().then((()=>{m.setAttributes({dbx51_email_regex:l.email});const e=m.getFeatureValue("end_state_2025_07_07_quota_upsell_info_apiv2_enabled",!1);Q(e)}))}),[l]);const{data:g,error:h}=i.useQuery(s,(async()=>await a.SilentBackgroundRequest({url:r(),data:{_subject_uid:l.id}})),{refetchOnReconnect:!1,refetchOnWindowFocus:!0,refetchInterval:l&&l.is_team?6e5:18e5,staleTime:l&&l.is_team?n:_,cacheTime:l&&l.is_team?n:_,retry:1});t.useEffect((()=>{}),[h]);const S=t.useMemo((async()=>{var t,a,u,i,r,s,n,_;if(!f||!l)return;const m={userQuotaUsageRatio:(null===(t=f.quota_ratio)||void 0===t?void 0:t.user_quota_usage_ratio)||0,tsdQuotaUsageRatio:(null===(a=f.quota_ratio)||void 0===a?void 0:a.tsd_quota_usage_ratio)||0,inExcludedNses:(null===(u=f.quota_ratio)||void 0===u?void 0:u.in_excluded_nses)||!1,promptAdminToUpgradeEmailTemplateUrl:(null===(i=f.team_info)||void 0===i?void 0:i.prompt_admin_to_upgrade_email_template_url)||"",numTeamMembers:(null===(r=f.team_info)||void 0===r?void 0:r.num_team_members)||0,numTeamAdmins:(null===(s=f.team_info)||void 0===s?void 0:s.num_team_admins)||0,teamAdminEmail:(null===(n=f.team_info)||void 0===n?void 0:n.team_admin_email)||"",teamAdminFname:(null===(_=f.team_info)||void 0===_?void 0:_.team_admin_fname)||""};return{overQuotaDetails:m,overQuotaStatus:await o.determineOverQuotaStatus({...m,user:l,pathStartsWithCdmTmfPath:c,viewer:e})}}),[f,l,c,e]),T=t.useMemo((async()=>{if(!g||!l)return;let t;try{t=JSON.parse(g)}catch(e){return}const a={userQuotaUsageRatio:t.user_quota_usage_ratio,tsdQuotaUsageRatio:t.tsd_quota_usage_ratio,inExcludedNses:t.in_excluded_nses,promptAdminToUpgradeEmailTemplateUrl:t.prompt_admin_to_upgrade_email_template_url,numTeamMembers:t.num_team_members,numTeamAdmins:t.num_team_admins,teamAdminEmail:t.team_admin_email,teamAdminFname:t.team_admin_fname};return{overQuotaDetails:a,overQuotaStatus:await o.determineOverQuotaStatus({...a,user:l,pathStartsWithCdmTmfPath:c,viewer:e})}}),[g,l,c,e]);return t.useEffect((()=>{p&&S&&S.then((e=>{e&&(v(d.setOverQuotaDetails(e.overQuotaDetails)),v(d.setOverQuotaStatus(e.overQuotaStatus)))}))}),[S,p]),t.useEffect((()=>{!p&&T&&T.then((e=>{e&&(v(d.setOverQuotaDetails(e.overQuotaDetails)),v(d.setOverQuotaStatus(e.overQuotaStatus)))}))}),[T,p]),p?S:T}}));
//# sourceMappingURL=c_hooks_use_query_overquota_data.js-vfl3-lhwL.map

//# debugId=4e09d91b-9a21-3528-bd13-021787ce203d