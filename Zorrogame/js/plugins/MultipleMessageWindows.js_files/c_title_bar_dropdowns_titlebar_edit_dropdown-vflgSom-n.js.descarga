!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="ec1926bf-a347-32a4-beff-35f64b6543d6")}catch(e){}}();
define(["require","exports","react","./c_core_i18n","./e_file_viewer_static_scl_page_file","./c_file_viewer_components_titlebar_menu_content","./e_core_exception","./c_lodash-es_lodash","./c_src_sink_index","./c_api_v2_routes_password_confirmation_provider","./c_memoize-one","./c_api_v2_routes_cloud_docs_provider","metaserver/static/js/langpack","./c_init_data_edison","./c_init_data_debug_panel","./e_edison","./c_chat_chat_constants","./c_react-use_misc_util","./e_data_modules_stormcrow","./c_watermarking_utils_getImageDefaultSizes","./c_api_v2_client_base","./c_spectrum_util_raf_throttle","./c_core_notify","react-dom","./c_spectrum_util_uuid_generator","./c_security_csrf_hmac"],(function(e,i,t,n,o,r,a,c,s,l,d,u,_,A,E,g,S,p,T,f,I,C,U,b,N,P){"use strict";function h(e){if(e&&e.__esModule)return e;var i=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(i,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),i.default=e,Object.freeze(i)}var L=h(t);const R=({logUserAction:e,setActiveEditorCallback:i})=>[{icon:o.ShapeRotateLeftLine,label:o.ROTATE_LEFT_TOOLTIP,userAction:o.UserAction.RotateLeft,disabled:{disabled:!1},action:{type:"click",handler:o.rotateLeftHandler(e,i,o.UserActionContext.EditMenu)}},{icon:o.ShapeRotateRightLine,label:o.ROTATE_RIGHT_TOOLTIP,userAction:o.UserAction.RotateRight,disabled:{disabled:!1},action:{type:"click",handler:o.rotateRightHandler(e,i,o.UserActionContext.EditMenu)}}],v=({logUserAction:e,setActiveEditorCallback:i})=>[{icon:o.FlipHorizontalLine,label:o.FLIP_HORIZONTAL_LABEL,userAction:o.UserAction.FlipHorizontal,disabled:{disabled:!1},action:{type:"click",handler:o.flipHorizontalHandler(e,i,o.UserActionContext.EditMenu)}},{icon:o.FlipVerticalLine,label:o.FLIP_VERTICAL_LABEL,userAction:o.UserAction.FlipVertical,disabled:{disabled:!1},action:{type:"click",handler:o.flipVerticalHandler(e,i,o.UserActionContext.EditMenu)}}],m=({logUserAction:e,setActiveEditorCallback:i})=>({icon:o.CropLine,label:o.CROP_TOOLTIP,disabled:{disabled:!1},userAction:o.UserAction.Crop,action:{type:"click",handler:o.cropHandler(e,i,o.UserActionContext.EditMenu)}}),w=({logUserAction:e,setActiveEditorCallback:i,previewType:t})=>({icon:o.CutLine,label:o.TRIM_TOOLTIP,userAction:o.UserAction.Trim,disabled:{disabled:!1},action:{type:"click",handler:o.trimHandler(e,i,o.UserActionContext.EditMenu)}}),D=(e,i,t)=>{if(!o.getActionCondition(e,o.audioVideoEditingActionCondition))return[];const n=e.previewType===o.PreviewType.Video,r=e.previewType===o.PreviewType.Audio;return n?O(i,t):r?y(i,t):[]},O=(e,i)=>{const t={logUserAction:e,setActiveEditorCallback:i,previewType:o.PreviewType.Video};return[w(t),m(t),...R(t),...v(t)]},y=(e,i)=>{const t={logUserAction:e,setActiveEditorCallback:i,previewType:o.PreviewType.Video};return[w(t)]},M=n.defineMessage({id:"1wQEUl",defaultMessage:"Rotate right"}),F=n.defineMessage({id:"2BgLiN",defaultMessage:"Rotate left"}),k=n.defineMessage({id:"tupnL9",defaultMessage:"Crop"}),H=n.defineMessage({id:"VghM9c",defaultMessage:"Flip"}),x=n.defineMessage({id:"nUBVPc",defaultMessage:"Adjust"}),G=n.defineMessage({id:"qBO39c",defaultMessage:"Enhance"}),W=o.withActionCondition(o.imageEditingActionCondition,((e,i,t,n,r,a)=>((e,i,t,n,r)=>{const a=(null==t?void 0:t.upscale)||(null==t?void 0:t.colorCorrect)||(null==t?void 0:t.autoStraighten)||(null==t?void 0:t.filter),c=[{icon:o.ShapeRotateLeftLine,label:F,userAction:o.UserAction.RotateLeft,disabled:{disabled:!1},action:{type:"click",handler:o.onRotate(o.RotationDirection.LEFT,e,i,o.UserActionContext.EditMenu)}},{icon:o.ShapeRotateRightLine,label:M,userAction:o.UserAction.RotateRight,disabled:{disabled:!1},action:{type:"click",handler:o.onRotate(o.RotationDirection.RIGHT,e,i,o.UserActionContext.EditMenu)}},{icon:o.FlipHorizontalLine,label:H,userAction:o.UserAction.FlipHorizontal,disabled:{disabled:!1},action:{type:"click",handler:o.onFlip(e,i,o.UserActionContext.EditMenu)}},{icon:o.CropLine,label:k,userAction:o.UserAction.Crop,disabled:{disabled:!1},action:{type:"click",handler:o.onCrop(e,i,o.UserActionContext.EditMenu)}},{icon:o.SliderLine,label:x,userAction:o.UserAction.Adjust,disabled:{disabled:!1},action:{type:"click",handler:o.onAdjust(e,i,o.UserActionContext.EditMenu)}}];if(a){let r;n&&"image"===n[".tag"]&&n.image_width&&n.image_height&&(r={width:n.image_width,height:n.image_height}),c.push({icon:o.ImageEnhanceLine,label:G,userAction:o.UserAction.Enhance,disabled:{disabled:!1},action:{type:"menu",menu:L.default.createElement(o.MagicTools,{onUpscale:o.onUpscale(e,i,o.UserActionContext.EditMenu),onColorCorrect:o.onColorCorrect(e,i,o.UserActionContext.EditMenu),onAutoStraighten:o.onAutoStraighten(e,i,o.UserActionContext.EditMenu),onFilter:o.onImageFilter(e,i,o.UserActionContext.EditMenu),imageDimensions:r,previewsImageEnhancements:t})}})}return c.concat(r)})(i,t,n,r,a)),[]),V=o.withActionCondition(o.pdfEditActionCondition,((i,t,n,r,a,c,s)=>{const l=[{label:o.DRAW_PDF_ACTION_STRING,icon:o.ScribbleLine,userAction:o.UserAction.Draw,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_pdf_edit_action_action"],i,t)})).then((({pdfEditAction:e})=>e({setActiveEditorCallback:n,logUserAction:t,getCurrentPage:r,previewSurface:s},o.UserActionContext.EditMenu,(e=>{let i=o.NonSignEntryPoints.UNFURL_ACTIONS_DRAW;return e===o.SDKPreviewSurface.BROWSE?i=o.NonSignEntryPoints.BROWSE_PREVIEW_UNFURL_ACTIONS_DRAW:e===o.SDKPreviewSurface.STANDALONE_PREVIEW?i=o.NonSignEntryPoints.STANDALONE_PREVIEW_UNFURL_ACTIONS_DRAW:e===o.SDKPreviewSurface.SHARED_LINK&&(i=o.NonSignEntryPoints.SHARED_LINK_UNFURL_ACTIONS_DRAW),i})(s))))}}],d=[{label:o.HIGHLIGHT_PDF_ACTION_STRING,icon:o.HighlightLine,userAction:o.UserAction.Highlight,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_pdf_edit_action_action"],i,t)})).then((({pdfEditAction:e})=>e({setActiveEditorCallback:n,logUserAction:t,getCurrentPage:r,previewSurface:s},o.UserActionContext.EditMenu,(e=>{let i=o.NonSignEntryPoints.UNFURL_ACTIONS_HIGHLIGHT;return e===o.SDKPreviewSurface.BROWSE?i=o.NonSignEntryPoints.BROWSE_PREVIEW_UNFURL_ACTIONS_HIGHLIGHT:e===o.SDKPreviewSurface.STANDALONE_PREVIEW?i=o.NonSignEntryPoints.STANDALONE_PREVIEW_UNFURL_ACTIONS_HIGHLIGHT:e===o.SDKPreviewSurface.SHARED_LINK&&(i=o.NonSignEntryPoints.SHARED_LINK_UNFURL_ACTIONS_HIGHLIGHT),i})(s))))}}],u=[{label:o.ADD_TEXT_PDF_ACTION_STRING,icon:o.TextBoxLine,userAction:o.UserAction.AddText,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_pdf_edit_action_action"],i,t)})).then((({pdfEditAction:e})=>e({setActiveEditorCallback:n,logUserAction:t,getCurrentPage:r,previewSurface:s},o.UserActionContext.EditMenu,(e=>{let i=o.NonSignEntryPoints.UNFURL_ACTIONS_ADD_TEXT;return e===o.SDKPreviewSurface.BROWSE?i=o.NonSignEntryPoints.BROWSE_PREVIEW_UNFURL_ACTIONS_ADD_TEXT:e===o.SDKPreviewSurface.STANDALONE_PREVIEW?i=o.NonSignEntryPoints.STANDALONE_PREVIEW_UNFURL_ACTIONS_ADD_TEXT:e===o.SDKPreviewSurface.SHARED_LINK&&(i=o.NonSignEntryPoints.SHARED_LINK_UNFURL_ACTIONS_ADD_TEXT),i})(s))))}}],_=a?[{label:o.EDIT_TEXT_PDF_ACTION_STRING,icon:o.PlaceholderTextLine,userAction:o.UserAction.EditPdfText,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_pdf_edit_action_action"],i,t)})).then((({pdfEditAction:e})=>e({setActiveEditorCallback:n,logUserAction:t,getCurrentPage:r,previewSurface:s},o.UserActionContext.EditMenu,(e=>{let i=o.NonSignEntryPoints.UNFURL_ACTIONS_EDIT_TEXT;return e===o.SDKPreviewSurface.BROWSE?i=o.NonSignEntryPoints.BROWSE_PREVIEW_UNFURL_ACTIONS_EDIT_TEXT:e===o.SDKPreviewSurface.STANDALONE_PREVIEW?i=o.NonSignEntryPoints.STANDALONE_PREVIEW_UNFURL_ACTIONS_EDIT_TEXT:e===o.SDKPreviewSurface.SHARED_LINK&&(i=o.NonSignEntryPoints.SHARED_LINK_UNFURL_ACTIONS_EDIT_TEXT),i})(s))))}}]:[];return[...l,...d,...u,..._,...c,...[{label:o.ALL_EDITING_TOOLS_ACTION_STRING,icon:o.EditLine,userAction:o.UserAction.EditPdf,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_pdf_edit_action_action"],i,t)})).then((({pdfEditAction:e})=>e({setActiveEditorCallback:n,logUserAction:t,getCurrentPage:r,previewSurface:s},o.UserActionContext.EditMenu)))}}]]}),[]),K=o.withActionCondition(o.selfSignActionCondition,((e,i,t,n,r,a,c,s)=>{if(r||a)return;const l=o.getSelfSignActionArgs(i,t,e.user,e.file,n,o.UserActionContext.EditMenu,c);return B(l,s)}),void 0),B=(i,t)=>({label:o.SIGN_YOURSELF_ACTION_STRING,icon:o.SignatureLine,userAction:o.UserAction.SelfSign,disabled:{disabled:!1},action:{type:"click",handler:async()=>{i.user?await new Promise((function(i,t){e(["./c_action_plugins_self_sign_action_action"],i,t)})).then((({selfSignAction:e})=>e(i))):null==t||t()}}}),j=o.withActionCondition(o.sendForSignatureActionCondition,((e,i,t,n,r,a,c,s)=>{if(r||a)return;const l=o.getActionArgs(t,i,e.user,e.file,n,c);return X(l,s)}),void 0),X=(i,t)=>({label:o.GET_SIGNAURES_ACTION_STRING,icon:o.SignableDocumentPictogram,userAction:o.UserAction.SendForSignature,disabled:{disabled:!1},action:{type:"click",handler:async()=>{i.user?await new Promise((function(i,t){e(["./c_action_plugins_send_for_signature_action_action"],i,t)})).then((({sendForSignatureAction:e})=>e(i))):null==t||t()}}}),z=o.withActionCondition(o.textEditingActionCondition,((e,i,t)=>((e,i)=>[{icon:o.EditLine,label:o.editContentText,disabled:{disabled:!1},action:{type:"click",handler:o.onEdit(e,i,o.UserActionContext.EditMenu)},userAction:o.UserAction.EditText}])(i,t)),[]),q=o.withActionCondition(o.watermarkActionCondition,((e,i)=>({label:n.defineMessage({id:"MqyPTe",defaultMessage:"Watermark"}),userAction:o.UserAction.Watermark,disabled:{disabled:!1},icon:o.StampLine,action:{type:"click",handler:async()=>i(o.WATERMARKING_PLUGIN_ID,o.UserActionContext.EditMenu)}})),void 0);i.default=({contentProps:i,setMenuDisabled:t})=>{var a,c;const s=n.useIntl(),{pluginArgs:l,previewSurface:d}=o.usePluginMigrationContext(),{logUserAction:u}=o.useFileViewerContext(),_=null!==(a=o.useCurrentPreviewMetadata().previewType)&&void 0!==a?a:o.PreviewType.Loading,A=l.getActiveFile().file,E=l.getActiveFile().sharePermission,g=l.getActiveFile().sharedLinkInfo,S=o.useCurrentPageCount(),p=o.useSetActiveEditorCallback(),T=o.useIsNestedArchiveFile(),f=o.useRootFile(),{data:I}=o.useFileContentMetadataQuery(f),C=null===(c=null==I?void 0:I.apiData)||void 0===c?void 0:c.metadata,U=o.useGetCurrentDocPageCallback(),{user:b,encryptionOptions:N}=l,P=o.useCanEditTextPDF(b),h=o.useUserHasDmtConflict(),R=o.useShouldDisableFeaturesIfTeamSuspended(),v=o.useIsHidePdfSignaturesEnabled(),m=L.useMemo((()=>({file:A,user:b,previewSurface:d,previewType:_,isNestedArchiveFile:T,sharePermission:E,sharedLinkInfo:g})),[A,b,d,_,E,T,g]),w=o.useImageEnhancements(b).previewsImageEnhancements,O=((e,i)=>{const t=o.useCanWatermarkFile({file:e.file,user:e.user});return L.default.useMemo((()=>t?q(e,i):void 0),[t,e,i])})(m,p),y=L.useMemo((()=>O?[O]:[]),[O]),M=L.useMemo((()=>async()=>{const{showAuthModal:i}=await new Promise((function(i,t){e(["./e_file_viewer_static_scl_page_file"],i,t)})).then((function(e){return e.show_auth_modal_esnext}));i({...{mode:o.Mode.REGISTER,encryptionOptions:N,kind:o.LoginOrRegisterKind.LOGGED_OUT_PDF_SIGN,authDialogPreviousElement:o.AuthDialogPreviousElementTag.EDIT,loggingExtra:{signup_source:"sign"},sharedLinkUrl:null==g?void 0:g.url,webSignInTag:o.getWebSignInTag(!!m.user,m.previewSurface,m.sharePermission),sharedLinkInfo:g}})}),[m.previewSurface,m.sharePermission,m.user,N,g]),F=L.useMemo((()=>{const e=_===o.PreviewType.Image||v?[]:[K(m,u,p,S,h,R,m.previewSurface,M),j(m,u,p,S,h,R,m.previewSurface,M)];return[[...V(m,u,p,U,P,y,m.previewSurface),...W(m,p,u,w,C,y),...D(m,u,p),...z(m,p,u)],[...e]]}),[m,u,p,U,y,S,h,R,_,w,P,C,M]),k=o.useAudioVideoEditDisabledTooltipMsg(null==f?void 0:f.name,null==f?void 0:f.size),H=o.useIsAudioOnlyVideo(),x=_===o.PreviewType.Image||_===o.PreviewType.SsrDoc;let G;const B=F.every((e=>e.every((e=>!e))));k?G=k:o.isDownloadPluginEnabled(A,E)?l.user||x?(B||H)&&(G=s.formatMessage({id:"qURjdV",defaultMessage:"Not available for this file"})):G=s.formatMessage({id:"8QvtQB",defaultMessage:"Log in or sign up to edit"}):G=s.formatMessage(o.DISABLED_FOR_THIS_FILE_TOOLTIP_STRING),L.useEffect((()=>{t({disabled:!!G,tooltip:G})}),[t,F,G]);const X=L.useCallback((e=>u(e,o.UserActionContext.EditMenu)),[u]);return L.createElement(r.TitlebarMenuContent,{contentProps:i,elementId:"edit-menu",options:F,logAction:X})}}));
//# sourceMappingURL=c_title_bar_dropdowns_titlebar_edit_dropdown.js-vflETDxIz.map

//# debugId=ec1926bf-a347-32a4-beff-35f64b6543d6