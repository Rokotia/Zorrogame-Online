!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="5985efbb-2e3e-314e-9ca5-c8b7cc0dbe5c")}catch(e){}}();
define(["require","exports","react","./c_core_i18n","react-dom","./e_file_viewer_static_scl_page_file","./c_utils_dsx_dsx-react","./c_api-v2-client_src_dropbox","./c_init_data_debug_panel","./c_api_v2_client_base","./c_react_query_helpers_queries_login_and_register_constants","./c_abuse_fingerprintjs_abuse_fpjs_provider","./c_browse_welcome_hub_lib_types","./c_shared_with_redux_store","./c_contacts_contact","./c_validators","./c_dig-components_chip_index","./c_dig-components_typeahead_index","./c_common_components_buttons","./c_dig-icons_assets_ui-icon_line_share"],(function(e,t,a,r,n,i,o,s,_,l,d,c,u,g,m,p,E,h,v,S){"use strict";function A(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var r=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,r.get?r:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var f=A(a),y=A(n);const b=e=>"file"===e[".tag"]?e.fileId:"file_folder"===e[".tag"]?e.path:"shared_folder"===e[".tag"]?`ns:${e.sharedFolderId}`:`ns:${e.nsId}`,T={".tag":"owner"},I={".tag":"viewer"},R={".tag":"editor"},w={".tag":"viewer_no_comment"},C={".tag":"other"};function M(e){return e.requested_visibility===i.RequestedVisibilityPolicy.password||e.require_password}function L(e){return e.audience_options.filter((e=>"password"===e.audience&&e.allowed)).length>0}function k(e){if(e.effective_audience)return e.effective_audience;switch(e.resolved_visibility){case"public":case"password":case"no_one":return e.resolved_visibility;case"team_only":return"team";case"team_and_password":return"password";case"shared_folder_only":case"only_you":return"no_one"}}const N={day_1:1,day_3:3,day_7:7,day_30:30,day_90:90,day_180:180,year_1:365};function O(e){return["public","password"].includes(e)}function x(e){return!!e.days_to_expire_policy&&"none"!==e.days_to_expire_policy}function D(e){return!!e.enforce_shared_link_password_policy&&"required"===e.enforce_shared_link_password_policy}function P(e){return x(e)&&!!e.change_shared_link_expiration_policy&&"not_allowed"===e.change_shared_link_expiration_policy}function F(e,t){return O(e.audience)&&(!e.expires&&P(t)||!M(t)&&D(t))}const H=(e,t)=>Boolean(!e||t);class ${static initClass(){this.ACCURACY=2,this.CODEPOINT_TO_WIDTH={32:38,33:25,34:42,35:67,36:58,37:92,38:75,39:25,40:33,41:33,42:58,43:58,44:25,45:33,46:25,47:42,48:58,49:58,50:58,51:58,52:58,53:58,54:58,55:58,56:58,57:58,58:25,59:25,60:58,61:58,62:58,63:50,64:100,65:67,66:67,67:67,68:75,69:58,70:58,71:75,72:83,73:33,74:25,75:67,76:58,77:100,78:83,79:83,80:67,81:83,82:67,83:58,84:58,85:75,86:67,87:100,88:67,89:58,90:58,91:33,92:42,93:33,94:58,95:50,96:67,97:58,98:67,99:50,100:67,101:58,102:33,103:58,104:67,105:25,106:25,107:58,108:25,109:100,110:67,111:67,112:67,113:67,114:42,115:50,116:42,117:67,118:58,119:83,120:58,121:58,122:50,123:42,124:58,125:42,126:58,161:25,162:58,163:58,164:58,165:58,166:58,167:58,168:67,169:92,170:42,171:50,172:58,174:92,175:58,176:50,177:58,178:42,179:42,180:67,181:67,182:75,183:25,184:25,185:42,186:42,187:50,188:83,189:83,190:83,191:50,192:67,193:67,194:67,195:67,196:67,197:67,198:92,199:67,200:58,201:58,202:58,203:58,204:33,205:33,206:33,207:33,208:75,209:83,210:83,211:83,212:83,213:83,214:83,215:58,216:83,217:75,218:75,219:75,220:75,221:58,222:67,223:67,224:58,225:58,226:58,227:58,228:58,229:58,230:92,231:50,232:58,233:58,234:58,235:58,236:25,237:25,238:25,239:25,240:67,241:67,242:67,243:67,244:67,245:67,246:67,247:58,248:67,249:67,250:67,251:67,252:67,253:58,254:67,255:58,256:75,257:67,258:75,259:67,260:75,261:67,262:75,263:58,264:75,265:58,266:75,267:58,268:75,269:58,270:83,271:83,272:83,273:75,274:67,275:67,276:67,277:67,278:67,279:67,280:67,281:67,282:67,283:67,284:83,285:75,286:83,287:75,288:83,289:75,290:83,291:75,292:83,293:75,294:92,295:75,296:33,297:33,298:33,299:33,300:33,301:33,302:33,303:33,304:33,305:25,306:67,307:67,308:42,309:33,310:75,311:67,312:67,313:58,314:33,315:58,316:33,317:58,318:42,319:58,320:50,321:67,322:42,323:83,324:75,325:83,326:75,327:83,328:75,329:83,330:83,331:75,332:92,333:67,334:92,335:67,336:92,337:67,338:100,339:100,340:75,341:50,342:75,343:50,344:75,345:50,346:67,347:58,348:67,349:58,350:67,351:58,352:67,353:58,354:75,355:42,356:75,357:42,358:75,359:42,360:83,361:75,362:83,363:75,364:83,365:75,366:83,367:75,368:83,369:75,370:83,371:75,372:100,373:92,374:75,375:58,376:75,377:67,378:67,379:67,380:67,381:67,382:67,383:42,384:75,385:83,386:67,387:75,388:75,389:67,390:75,391:83,392:58,393:83,394:100,395:67,396:75,397:67,398:67,399:75,400:58,401:58,402:75,403:83,404:75,405:100,406:50,407:50,408:75,409:67,410:50,411:67,412:117,413:83,414:75,415:92,416:92,417:75,418:117,419:100,420:75,421:75,422:75,423:67,424:58,425:67,426:58,427:42,428:75,429:42,430:75,431:83,432:75,433:92,434:83,435:75,436:75,437:67,438:67,439:67,440:67,441:58,442:58,443:75,444:75,445:58,446:50,447:67,448:33,449:50,450:50,451:33,452:142,453:142,454:133,455:100,456:92,457:67,458:117,459:117,460:100,461:75,462:67,463:33,464:33,465:92,466:67,467:83,468:75,469:83,470:75,471:83,472:75,473:83,474:75,475:83,476:75,477:67,478:75,479:67,480:75,481:67,482:100,483:100,484:92,485:75,486:83,487:75,488:75,489:67,490:92,491:67,492:92,493:67,494:67,495:58,496:33,497:142,498:142,499:133,500:83,501:75,502:117,503:67,504:83,505:75,506:75,507:67,508:100,509:100,510:92,511:67,512:75,513:67,514:75,515:67,516:67,517:67,518:67,519:67,520:33,521:33,522:33,523:33,524:92,525:67,526:92,527:67,528:75,529:50,530:75,531:50,532:83,533:75,534:83,535:75,536:67,537:58,538:75,539:42,540:58,541:58,542:83,543:75,544:83,545:100,546:92,547:67,548:67,549:67,550:75,551:67,552:67,553:67,554:92,555:67,556:92,557:67,558:92,559:67,560:92,561:67,562:75,563:58,564:67,565:100,566:67,567:33,568:100,569:100,570:75,571:75,572:58,573:58,574:67,575:58,576:58,577:67,578:50,579:75,580:75,581:75,582:75,583:58,584:58,585:25,586:83,587:58,588:75,589:33,590:75,591:58,880:67,881:50,882:67,883:50,884:33,885:33,886:75,887:67,888:108,889:108,890:67,891:58,892:58,893:58,894:42,895:108,896:108,897:108,898:108,899:108,900:67,901:67,902:75,903:42,904:83,905:100,906:58,907:108,908:100,909:108,910:100,911:100,912:42,913:75,914:67,915:58,916:83,917:67,918:67,919:83,920:92,921:33,922:75,923:75,924:100,925:83,926:75,927:92,928:83,929:67,930:108,931:67,932:75,933:75,934:83,935:75,936:83,937:92,938:33,939:75,940:83,941:58,942:75,943:42,944:67,945:83,946:67,947:67,948:67,949:58,950:75,951:75,952:67,953:42,954:67,955:67,956:75,957:67,958:67,959:67,960:92,961:67,962:67,963:75,964:67,965:67,966:92,967:67,968:92,969:100,970:42,971:67,972:67,973:67,974:100,975:108,976:58,977:75,978:75,979:100,980:75,981:92,982:100,983:67,984:92,985:67,986:75,987:58,988:58,989:58,990:67,991:58,992:75,993:92,994:100,995:92,996:75,997:58,998:75,999:58,1e3:75,1001:75,1002:67,1003:67,1004:83,1005:58,1006:50,1007:42,1008:67,1009:67,1010:58,1011:33,1012:92,1013:58,1014:58,1015:67,1016:67,1017:75,1018:100,1019:83,1020:58,1021:75,1022:75,1023:75,1024:67,1025:67,1026:92,1027:58,1028:75,1029:67,1030:33,1031:33,1032:42,1033:108,1034:108,1035:83,1036:75,1037:83,1038:75,1039:83,1040:75,1041:67,1042:67,1043:58,1044:83,1045:67,1046:92,1047:67,1048:83,1049:83,1050:75,1051:83,1052:100,1053:83,1054:92,1055:83,1056:67,1057:75,1058:75,1059:75,1060:83,1061:75,1062:83,1063:75,1064:108,1065:108,1066:75,1067:92,1068:67,1069:75,1070:108,1071:75,1072:67,1073:67,1074:58,1075:58,1076:75,1077:67,1078:83,1079:58,1080:75,1081:75,1082:67,1083:67,1084:83,1085:75,1086:67,1087:75,1088:75,1089:58,1090:58,1091:58,1092:92,1093:67,1094:75,1095:58,1096:92,1097:100,1098:67,1099:83,1100:58,1101:58,1102:92,1103:58,1104:67,1105:67,1106:75,1107:58,1108:58,1109:58,1110:33,1111:33,1112:42,1113:92,1114:92,1115:75,1116:67,1117:75,1118:58,1119:75,1120:100,1121:75,1122:75,1123:67,1124:83,1125:83,1126:75,1127:67,1128:100,1129:92,1130:92,1131:83,1132:117,1133:108,1134:67,1135:67,1136:83,1137:83,1138:92,1139:67,1140:83,1141:67,1142:83,1143:67,1144:133,1145:125,1146:92,1147:67,1148:100,1149:75,1150:100,1151:75,1152:75,1153:58,1154:75,1155:0,1156:0,1157:0,1158:0,1159:108,1160:0,1161:0,1162:83,1163:75,1164:67,1165:58,1166:67,1167:75,1168:58,1169:58,1170:67,1171:58,1172:75,1173:67,1174:100,1175:92,1176:67,1177:58,1178:75,1179:67,1180:83,1181:75,1182:75,1183:67,1184:83,1185:75,1186:83,1187:75,1188:100,1189:83,1190:117,1191:100,1192:92,1193:75,1194:75,1195:58,1196:75,1197:58,1198:75,1199:58,1200:75,1201:58,1202:75,1203:75,1204:100,1205:83,1206:75,1207:67,1208:75,1209:67,1210:75,1211:58,1212:92,1213:75,1214:92,1215:75,1216:33,1217:92,1218:83,1219:75,1220:67,1221:83,1222:67,1223:83,1224:75,1225:83,1226:75,1227:75,1228:58,1229:100,1230:83,1231:25,1232:75,1233:67,1234:75,1235:67,1236:100,1237:100,1238:67,1239:67,1240:75,1241:67,1242:75,1243:67,1244:92,1245:83,1246:67,1247:58,1248:67,1249:58,1250:83,1251:75,1252:83,1253:75,1254:92,1255:67,1256:92,1257:67,1258:92,1259:67,1260:75,1261:58,1262:75,1263:58,1264:75,1265:58,1266:75,1267:58,1268:75,1269:58,1270:58,1271:42,1272:92,1273:83,1274:58,1275:42,1276:75,1277:58,1278:75,1279:58,2026:67,19977:108,65403:58},this._ELLIPSIS_LENGTH=new $("…").length}static em_snippet(e,t,a){return null==t&&(t=50),null==a&&(a=.75),new $(e.toString()).snippet(t,a).toString()}constructor(e){if(!(this instanceof $))return new $(e);this.s=e,this.info=this.widthInfo(),this.length=e.length?this.info[this.s.length-1]:0}widthInfo(){const e={"-1":0};for(let t=0,a=this.s.length,r=0<=a;r?t<a:t>a;r?t++:t--)e[t]=e[t-1]+this.ems(this.s.charAt(t));return e}findSpot(e){let t;if(!e)return 0;let a=0,r=this.s.length;for(;a<=r;){t=Math.floor(a/2+r/2);const n=this.info[t-1];if(n>e)r=t-1;else{if(!(n<e))return t;a=t+1}}return a>t?a:t}ems(e){const t=e.charCodeAt(0),a=$.CODEPOINT_TO_WIDTH[t];return a?a/Math.pow(10,$.ACCURACY):768<=t&&t<=879?0:65377<=t&&t<=65500?.58:11904<=t&&t<=40911||44032<=t&&t<=55215||4352<=t&&t<=4607||63744<=t&&t<=64255||65280<=t&&t<=65535||131072<=t&&t<=196607?1.08:.65}substr(e,t){const a=this.findSpot(e);if(null!=t){let r=this.findSpot(e+t);if(r-a<this.s.length){const e=this.s.charCodeAt(r-a);65024<=e&&e<=65039&&r--}return new $(this.s.substr(a,r-a))}return new $(this.s.substr(a))}toString(){return this.s}snippet(e=50,t=.75){if(this.length<=e)return this;const a=(e-=$._ELLIPSIS_LENGTH)*t,r=e-a,n=this.length-r,i=this.substr(0,a),o=this.substr(n);return new $(i.toString()+"…"+o.toString())}}function U(e,t,a=!1){return e.filter((e=>void 0!==e.email)).map((e=>({email:e.email,checkForInvite:t,isResurface:a})))}function V(e,t,a){return[...U(e,!0),...U(a,!0,!0),...U(t,!1)]}function B(e){return["member_invite_expand_eligibility","member_suggestion_expand_eligibility","member_invite_partial_eligibility"].includes(e)}function z(e,t,a){const r=e.length>0,n=t.length>0,i=(r||n)&&(function(e){return["admin_invite_after_move","admin_invite_expand_eligibility"].includes(e)}(a)||B(a));return Boolean(i)}$.initClass();const G=e=>i.create("email",{email:e}),j=e=>"user"===e[".tag"]?""===e.dbx_account_id?`EMAIL:${e.email}`:`DBX_ID:${e.dbx_account_id}`:"group"===e[".tag"]?`DBX_ID:${e.group_id}`:"email"===e[".tag"]?`EMAIL:${e.email}`:i.exhausts(e,"UNKNOWN"),W=e=>"user"===e[".tag"]&&e.photo_url||null,K=(e,t)=>"user"===e[".tag"]||"email"===e[".tag"]?e.email:"group"===e[".tag"]?t.formatMessage({id:"XMHn5C",defaultMessage:"{count, plural, one{# member} other{# members}}"},{count:e.group_size||0}):"",q=e=>"email"===e[".tag"]?{".tag":"email",email:e.email}:"group"===e[".tag"]?{".tag":"dropbox_id",dropbox_id:e.group_id}:"user"===e[".tag"]?""===e.dbx_account_id?{".tag":"email",email:e.email}:{".tag":"dropbox_id",dropbox_id:e.dbx_account_id}:{".tag":"other"},Y={".tag":"public"},Z={".tag":"team_only"},J={".tag":"password"},Q={".tag":"team_and_password"},X={".tag":"shared_folder_only"},ee={".tag":"no_one"},te={".tag":"only_you"},ae={".tag":"other"},re={".tag":"day_1"},ne={".tag":"day_180"},ie={".tag":"day_3"},oe={".tag":"day_30"},se={".tag":"day_7"},_e={".tag":"day_90"},le={".tag":"none"},de={".tag":"year_1"},ce={".tag":"other"},ue={".tag":"allowed"},ge={".tag":"not_allowed"},me={".tag":"other"},pe={".tag":"optional"},Ee={".tag":"required"},he={".tag":"other"},ve={".tag":"no_one"},Se={".tag":"team"},Ae={".tag":"public"},fe={".tag":"viewer"},ye={".tag":"editor"},be={".tag":"admin_invite_expand_eligibility"},Te={".tag":"member_suggestion_expand_eligibility"},Ie={".tag":"member_invite_expand_eligibility"},Re={".tag":"member_invite_partial_eligibility"},we={".tag":"not_enabled"},Ce={".tag":"anyone"},Me={".tag":"team"},Le={".tag":"team_and_approved"},ke={".tag":"other"},Ne={".tag":"from_team_only"},Oe={".tag":"from_anyone"},xe={".tag":"other"},De={".tag":"default_public"},Pe={".tag":"default_team_only"},Fe={".tag":"team_only"},He={".tag":"default_no_one"},$e={".tag":"other"},Ue={".tag":"admins_and_members"},Ve={".tag":"admins_only"},Be={".tag":"members"},ze={".tag":"anyone"},Ge={".tag":"other"},je={".tag":"optional"},We={".tag":"required"},Ke={".tag":"other"},qe={".tag":"day_1"},Ye={".tag":"day_180"},Ze={".tag":"day_3"},Je={".tag":"day_30"},Qe={".tag":"day_7"},Xe={".tag":"day_90"},et={".tag":"none"},tt={".tag":"year_1"},at={".tag":"other"},rt={".tag":"default"},nt={".tag":"edit"},it={".tag":"view"},ot=e=>"email"===e[".tag"]?m.Contact.buildFromRawEmail(e.email):"group"===e[".tag"]?new m.Contact({type:i.ContactTypes.NEW_STYLE_GROUP,dbx_team_id:e.dbx_team_id,members:e.members,name:e.name,group_id:e.group_id,group_size:e.group_size}):"user"===e[".tag"]?e.dbx_account_id?new m.Contact({type:i.ContactTypes.EMAIL,dbx_team_id:e.dbx_team_id,...void 0!==e.photo_url?{photo_url:e.photo_url}:{},name:e.name,invalid:!p.validateEmail(e.email),dbx_account_id:e.dbx_account_id,email:e.email}):m.Contact.buildFromRawEmail(e.email):i.exhausts(e,m.Contact.buildFromRawEmail("")),st=e=>"invalid"===e.state?{".tag":"disallowed",disallowed:{".tag":"other"}}:"ok"===e.state?"NOT_DROPBOX_USER"===e.msg?{".tag":"allowed",allowed:{".tag":"not_dropbox_user"}}:{".tag":"allowed",allowed:{".tag":"no_warning"}}:"warn"===e.state?e.msg===i.CONTACT_ERROR_MESSAGES.OUT_OF_TEAM?{".tag":"allowed",allowed:{".tag":"outside_of_team"}}:{".tag":"allowed",allowed:{".tag":"other"}}:{".tag":"other"},_t=e=>"owner"===e?T:"reader"===e?I:"writer"===e?R:"reader_no_comment"===e?w:C,lt=e=>void 0===e?i.OTHER:"editor"===e?i.EDITOR:"viewer"===e?i.VIEWER:i.exhausts(e,i.OTHER),dt=e=>"public"===e?Y:"team_only"===e?Z:"password"===e?J:void 0,ct=e=>"public"===e?i.PUBLIC:"team"===e?i.TEAM:"password"===e?i.PASSWORD:"no_one"===e?i.NO_ONE:i.OTHER$1,ut=e=>{var t,a,r,n,i,o,s,_,l,d,c,u,g;const m=[];return void 0===e||(void 0!==(null===(t=e.change_options)||void 0===t?void 0:t.allow)&&m.push({action:{".tag":"change_options"},allow:e.change_options.allow}),void 0!==(null===(a=e.disable_viewer_info)||void 0===a?void 0:a.allow)&&m.push({action:{".tag":"disable_viewer_info"},allow:e.disable_viewer_info.allow}),void 0!==(null===(r=e.edit_contents)||void 0===r?void 0:r.allow)&&m.push({action:{".tag":"edit_contents"},allow:e.edit_contents.allow}),void 0!==(null===(n=e.enable_viewer_info)||void 0===n?void 0:n.allow)&&m.push({action:{".tag":"enable_viewer_info"},allow:e.enable_viewer_info.allow}),void 0!==(null===(i=e.invite_editor)||void 0===i?void 0:i.allow)&&m.push({action:{".tag":"invite_editor"},allow:e.invite_editor.allow}),void 0!==(null===(o=e.invite_viewer)||void 0===o?void 0:o.allow)&&m.push({action:{".tag":"invite_viewer"},allow:e.invite_viewer.allow}),void 0!==(null===(s=e.invite_viewer_no_comment)||void 0===s?void 0:s.allow)&&m.push({action:{".tag":"invite_viewer_no_comment"},allow:e.invite_viewer_no_comment.allow}),void 0!==(null===(_=e.leave_a_copy)||void 0===_?void 0:_.allow)&&m.push({action:{".tag":"leave_a_copy"},allow:e.leave_a_copy.allow}),void 0!==(null===(l=e.relinquish_membership)||void 0===l?void 0:l.allow)&&m.push({action:{".tag":"relinquish_membership"},allow:e.relinquish_membership.allow}),void 0!==(null===(d=e.update_confidentiality)||void 0===d?void 0:d.allow)&&m.push({action:{".tag":"update_confidentiality"},allow:e.update_confidentiality.allow}),void 0!==(null===(c=e.unmount)||void 0===c?void 0:c.allow)&&m.push({action:{".tag":"unmount"},allow:e.unmount.allow}),void 0!==(null===(u=e.unshare)||void 0===u?void 0:u.allow)&&m.push({action:{".tag":"unshare"},allow:e.unshare.allow}),void 0!==(null===(g=e.create_link)||void 0===g?void 0:g.allow)&&m.push({action:{".tag":"create_link"},allow:e.create_link.allow})),m},gt=e=>{var t,a,r,n,i,o,s,_,l,d,c,u,g,m,p;const E=[];return void 0===e||(void 0!==(null===(t=e.create_edit_link)||void 0===t?void 0:t.allow)&&E.push({action:{".tag":"create_edit_link"},allow:e.create_edit_link.allow}),void 0!==(null===(a=e.create_view_link)||void 0===a?void 0:a.allow)&&E.push({action:{".tag":"create_view_link"},allow:e.create_view_link.allow}),void 0!==(null===(r=e.change_options)||void 0===r?void 0:r.allow)&&E.push({action:{".tag":"change_options"},allow:e.change_options.allow}),void 0!==(null===(n=e.disable_viewer_info)||void 0===n?void 0:n.allow)&&E.push({action:{".tag":"disable_viewer_info"},allow:e.disable_viewer_info.allow}),void 0!==(null===(i=e.edit_contents)||void 0===i?void 0:i.allow)&&E.push({action:{".tag":"edit_contents"},allow:e.edit_contents.allow}),void 0!==(null===(o=e.enable_viewer_info)||void 0===o?void 0:o.allow)&&E.push({action:{".tag":"enable_viewer_info"},allow:e.enable_viewer_info.allow}),void 0!==(null===(s=e.invite_viewer)||void 0===s?void 0:s.allow)&&E.push({action:{".tag":"invite_viewer"},allow:e.invite_viewer.allow}),void 0!==(null===(_=e.invite_editor)||void 0===_?void 0:_.allow)&&E.push({action:{".tag":"invite_editor"},allow:e.invite_editor.allow}),void 0!==(null===(l=e.invite_viewer_no_comment)||void 0===l?void 0:l.allow)&&E.push({action:{".tag":"invite_viewer_no_comment"},allow:e.invite_viewer_no_comment.allow}),void 0!==(null===(d=e.relinquish_membership)||void 0===d?void 0:d.allow)&&E.push({action:{".tag":"relinquish_membership"},allow:e.relinquish_membership.allow}),void 0!==(null===(c=e.remove_download_policy)||void 0===c?void 0:c.allow)&&E.push({action:{".tag":"remove_download_policy"},allow:e.remove_download_policy.allow}),void 0!==(null===(u=e.set_download_policy)||void 0===u?void 0:u.allow)&&E.push({action:{".tag":"set_download_policy"},allow:e.set_download_policy.allow}),void 0!==(null===(g=e.unshare)||void 0===g?void 0:g.allow)&&E.push({action:{".tag":"unshare"},allow:e.unshare.allow}),void 0!==(null===(m=e.create_link)||void 0===m?void 0:m.allow)&&E.push({action:{".tag":"create_link"},allow:e.create_link.allow}),void 0!==(null===(p=e.share_message_as_comment)||void 0===p?void 0:p.allow)&&E.push({action:{".tag":"share_message_as_comment"},allow:e.share_message_as_comment.allow})),E},mt=(e,t,a)=>{var r,n,i,o,s,_,l,d;if(void 0===e)throw new Error("Adapter error.");if(e.isFolder()){if(e.isNewSharedFolder()){const r=e;return{".tag":"file_folder",access_type:_t(e.access_type),is_inside_team_folder:t,is_team_folder:a,owner_team:r.owner_team,parent_shared_folder_id:r.parent_shared_folder_id?String(r.parent_shared_folder_id):void 0,path_lower:r.path_lower,parent_folder_name:r.parent_folder_name,...void 0!==r.is_confidential?{is_confidential:r.is_confidential}:{},name:e.name,policy:{member_policy:r.policy.member_policy?{".tag":r.policy.member_policy}:void 0,resolved_member_policy:r.policy.resolved_member_policy?{".tag":r.policy.resolved_member_policy}:void 0,acl_update_policy:r.policy.acl_update_policy?{".tag":r.policy.acl_update_policy}:{".tag":"other"},shared_link_policy:r.policy.shared_link_policy?{".tag":r.policy.shared_link_policy}:{".tag":"other"},viewer_info_policy:r.policy.viewer_info_policy?{".tag":r.policy.viewer_info_policy}:void 0},permissions:ut(e.permissions),members_cursor:e.members_cursor,owner_team_policies:pt(r.owner_team_policies),folder_id:r.folder_id}}{const n=e;return{".tag":"shared_folder",access_type:_t(e.access_type),is_inside_team_folder:t,is_team_folder:a,owner_team:n.owner_team,parent_shared_folder_id:n.parent_shared_folder_id?String(n.parent_shared_folder_id):void 0,path_lower:n.path_lower,parent_folder_name:n.parent_folder_name,...void 0!==n.is_confidential?{is_confidential:n.is_confidential}:{},name:e.name,permissions:ut(e.permissions),policy:{member_policy:n.policy.member_policy?{".tag":n.policy.member_policy}:void 0,resolved_member_policy:n.policy.resolved_member_policy?{".tag":n.policy.resolved_member_policy}:void 0,acl_update_policy:n.policy.acl_update_policy?{".tag":n.policy.acl_update_policy}:{".tag":"other"},shared_link_policy:n.policy.shared_link_policy?{".tag":n.policy.shared_link_policy}:{".tag":"other"},download_policy:n.policy.download_policy?{".tag":n.policy.download_policy}:{".tag":"other"},viewer_info_policy:n.policy.viewer_info_policy?{".tag":n.policy.viewer_info_policy}:void 0},preview_url:n.preview_url||"",shared_folder_id:n.shared_folder_id.toString(),time_invited:(null===(r=n.time_invited)||void 0===r?void 0:r.toString())||"",folder_size:n.folder_size,can_mount:n.can_mount,invite_info:n.invite_info,owner_team_policies:pt(n.owner_team_policies),is_encrypted:n.is_encrypted,folder_id:n.folder_id}}}{const t=e;return{".tag":"file",access_type:_t(t.access_type),download_policy:{".tag":"other"},id:t.id,name:t.name,owner_team:t.owner_team,parent_shared_folder_id:t.parent_shared_folder_id?String(t.parent_shared_folder_id):void 0,path_display:t.path_display,path_lower:t.path_lower,permissions:gt(t.permissions),policy:{member_policy:(null===(n=t.policy)||void 0===n?void 0:n.member_policy)?{".tag":t.policy.member_policy}:void 0,resolved_member_policy:(null===(i=t.policy)||void 0===i?void 0:i.resolved_member_policy)?{".tag":t.policy.resolved_member_policy}:void 0,acl_update_policy:(null===(o=t.policy)||void 0===o?void 0:o.acl_update_policy)?{".tag":t.policy.acl_update_policy}:{".tag":"other"},shared_link_policy:(null===(s=t.policy)||void 0===s?void 0:s.shared_link_policy)?{".tag":t.policy.shared_link_policy}:{".tag":"other"},download_policy:(null===(_=t.policy)||void 0===_?void 0:_.download_policy)?{".tag":t.policy.download_policy}:{".tag":"other"},viewer_info_policy:(null===(l=t.policy)||void 0===l?void 0:l.viewer_info_policy)?{".tag":t.policy.viewer_info_policy}:void 0},preview_url:t.preview_url||"",time_invited:null===(d=t.time_invited)||void 0===d?void 0:d.toString(),is_cloud_doc:t.is_cloud_doc,owner_team_policies:pt(t.owner_team_policies)}}},pt=e=>{if(e)return{shared_folder_member_policy:Et(e.shared_folder_member_policy),shared_folder_join_policy:ht(e.shared_folder_join_policy),shared_link_create_policy:vt(e.shared_link_create_policy),group_creation_policy:St(e.group_creation_policy),shared_folder_link_restriction_policy:At(e.shared_folder_link_restriction_policy),enforce_link_password_policy:ft(e.enforce_link_password_policy),default_link_expiration_days_policy:yt(e.default_link_expiration_days_policy),shared_link_default_permissions_policy:bt(e.shared_link_default_permissions_policy)}},Et=e=>{switch(e){case"team":return Me;case"team_and_approved":return Le;case"other":return ke;default:return Ce}},ht=e=>{switch(e){case"from_team_only":return Ne;case"other":return xe;default:return Oe}},vt=e=>{switch(e){case"default_team_only":return Pe;case"team_only":return Fe;case"default_no_one":return He;case"other":return $e;default:return De}},St=e=>"admins_only"===e?Ve:Ue,At=e=>{switch(e){case"members":return Be;case"other":return Ge;default:return ze}},ft=e=>{switch(e){case"required":return We;case"other":return Ke;default:return je}},yt=e=>{switch(e){case"day_1":return qe;case"day_180":return Ye;case"day_3":return Ze;case"day_30":return Je;case"day_7":return Qe;case"day_90":return Xe;case"year_1":return tt;case"other":return at;default:return et}},bt=e=>{switch(e){case"default":default:return rt;case"edit":return nt;case"view":return it}},Tt=e=>{switch(e){case i.LinkAudienceDisallowedReason.DeleteAndRecreate:return i.DISALLOWED_REASON_DELETE_AND_RECREATE;case i.LinkAudienceDisallowedReason.RestrictedBySharedFolder:return i.DISALLOWED_REASON_RESTRICTED_BY_SHARED_FOLDER;case i.LinkAudienceDisallowedReason.RestrictedByTeam:return i.DISALLOWED_REASON_RESTRICTED_BY_TEAM;case i.LinkAudienceDisallowedReason.UserAccountType:return i.DISALLOWED_REASON_USER_ACCOUNT_TYPE;case i.LinkAudienceDisallowedReason.UserNotOnTeam:return i.DISALLOWED_REASON_USER_NOT_ON_TEAM;case i.LinkAudienceDisallowedReason.PermissionDenied:return i.DISALLOWED_REASON_PERMISSION_DENIED;default:return}},It=e=>{if(void 0!==e)return e.map((e=>({audience:ct(e.audience),allowed:e.allowed,disallowed_reason:Tt(e.disallowed_reason)})))},Rt=e=>{switch(e){case"day_1":return re;case"day_180":return ne;case"day_3":return ie;case"day_30":return oe;case"day_7":return se;case"day_90":return _e;case"none":return le;case"year_1":return de;case"other":return ce;default:return}},wt=e=>{switch(e){case"allow":return ue;case"not_allowed":return ge;case"other":return me;default:return}},Ct=e=>{switch(e){case"optional":return pe;case"required":return Ee;case"other":return he;default:return}},Mt=e=>({id:e.id,name:e.name}),Lt=e=>{switch(e){case"admin_invite_expand_eligibility":return be;case"member_suggestion_expand_eligibility":return Te;case"member_invite_expand_eligibility":return Ie;case"member_invite_partial_eligibility":return Re;default:return we}},kt=(...e)=>{},Nt=i.SHARE_ACTION_ORIGIN_TYPE.SHARING_SDK_SANDBOX,Ot=(...e)=>(...t)=>{e.forEach((e=>{try{e(...t)}catch(e){}}))},xt=f.createContext({sink:kt,metadata:{},origin:Nt,actionInfo:void 0}),Dt=({sink:e,children:t,origin:a,actionInfo:r})=>{const n=f.useMemo((()=>({sink:e,metadata:{},origin:a,actionInfo:r})),[e,a,r]);return f.createElement(xt.Provider,{value:n},t)};Dt.displayName="Provider";const Pt=()=>{const e=f.useContext(xt);return f.useCallback(((t,a)=>{const r={type:t,payload:a};e.sink(r,e.metadata,e.origin,e.actionInfo)}),[e])},Ft=({children:e,...t})=>{const a=f.useContext(xt),[r]=f.useState({sink:a.sink,metadata:{},origin:a.origin,actionInfo:a.actionInfo});return r.metadata={...a.metadata,...t},f.createElement(xt.Provider,{value:r},e)};Ft.displayName="MetadataProvider";const Ht=f.createContext(new s.Dropbox({})),$t=({sdk:e,children:t})=>f.createElement(Ht.Provider,{value:e},t);$t.displayName="DropboxSdkProvider";r.createIntl({locale:"en"});const Ut=({children:e,intl:t})=>t?f.createElement(r.Provider,{value:t},e):e;var Vt;Ut.displayName="Provider",t.Platforms=void 0,(Vt=t.Platforms||(t.Platforms={})).SANDBOX="SANDBOX",Vt.METASERVER="METASERVER",Vt.PAPER="PAPER",Vt.DESKTOP="DESKTOP",Vt.MS_TEAMS="MS_TEAMS",Vt.MS_TEAMS_MOBILE="MS_TEAMS_MOBILE";const Bt=f.createContext(t.Platforms.SANDBOX),zt=({platform:e,children:t})=>f.createElement(Bt.Provider,{value:e},t);zt.displayName="Provider";const Gt=()=>f.useContext(Bt),jt=f.createContext({redirectWindowToken:null}),Wt=()=>f.useContext(jt).redirectWindowToken,Kt=({children:e,...t})=>{const a=f.useMemo((()=>({redirectWindowToken:t.redirectWindowToken})),[t.redirectWindowToken]);return f.createElement(jt.Provider,{value:a},e)};function qt(e){const t=window.document.createElement("a");t.href=e;let a=t.protocol||window.location.protocol;":"===t.protocol&&(a=window.location.protocol);const r=t.hostname||window.location.hostname;let n=t.port||window.location.port;"443"===n&&"https:"===a&&(n="");let i=r;return n&&(i=i+":"+n),a+"//"+i+(0===t.pathname.indexOf("/")?t.pathname:`/${t.pathname}`)+t.search+t.hash}Kt.displayName="Provider";const Yt=e=>window.open(e,"_blank"),Zt=f.createContext(Yt),Jt=({openUrl:e,children:t})=>f.createElement(Zt.Provider,{value:e},t);Jt.displayName="Provider";const Qt=()=>{const e=f.useContext(Zt);return f.useCallback((t=>{e(t)}),[e])},Xt=e=>e.formatMessage({id:"0NA7+K",defaultMessage:"Close"}),ea=f.createContext({store:{$item:o.store(null),$props:o.store({})}}),ta=()=>{const{store:e}=f.useContext(ea),t=f.useRef(null);return a=>{var r,n;const i=Math.random().toString();return e.$item.set({key:i,Snackbar:a,snackbarRef:t}),null===(n=(r=e.$props.get()).onSnackbarShownChange)||void 0===n||n.call(r,!0,t),()=>{var t,a;const r=e.$item.get();r&&r.key===i&&(e.$item.set(null),null===(a=(t=e.$props.get()).onSnackbarShownChange)||void 0===a||a.call(t,!1))}}},aa=()=>{const{store:e}=f.useContext(ea),t=o.useStore(e.$item),a=(e=>{const{store:t}=f.useContext(ea);return f.useCallback((()=>{var a,r;const n=t.$item.get();n&&n.key===e&&(t.$item.set(null),null===(r=(a=t.$props.get()).onSnackbarShownChange)||void 0===r||r.call(a,!1))}),[t,e])})(t?t.key:"");return t?y.createPortal(f.createElement("div",{ref:t.snackbarRef,key:t.key,style:{position:"fixed",display:"flex",zIndex:2e4,width:"100%",bottom:"1em",justifyContent:"center"},"data-sharing-sdk":"1"},f.createElement(t.Snackbar,{style:{flexGrow:1},key:t.key,open:!0,onRequestClose:a})),document.body):null},ra=({children:e,onSnackbarShownChange:t})=>{const a=o.useInitStore({onSnackbarShownChange:t},(e=>({$item:o.store(null),$props:e}))),r=f.useMemo((()=>({store:a})),[a]);return f.createElement(ea.Provider,{value:r},f.createElement(f.Fragment,null,e,f.createElement(aa,null)))};ra.displayName="Provider";var na;!function(e){e.SUCCESS="SUCCESS",e.ERROR="ERROR",e.FATAL="FATAL"}(na||(na={}));const ia=i.isObjectOf({status:i.isNumber,headers:i.isUnknown,error:i.isObjectOf({error:i.isObjectOf({".tag":i.isString})})}),oa=i.isObjectOf({status:i.isNumber}),sa=async e=>{try{const t=await e;return{status:na.SUCCESS,output:t.result}}catch(e){const t=e;return ia(t)?{status:na.ERROR,error:t.error.error,statusCode:t.status}:oa(e)?{status:na.FATAL,statusCode:e.status,error:e}:{status:na.FATAL,error:e}}},_a=(e,t)=>({name:e.name,fetch:t,type:"standard"}),la=_a({name:"sharing_receiving.SharingTiburonLogger"},(e=>t=>{const a={...t,extras:ca(ua(JSON.stringify(t.extras)))};return sa(e.sharingReceivingSharingTiburonLogger(a))})),da=e=>e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65,ca=e=>{let t=2,a="";const r=e.length;let n=0;for(let i=0;i<r;i++)t=i%3,i>0&&4*i/3%76==0&&(a+="\r\n"),n|=e[i]<<(16>>>t&24),2!==t&&e.length-i!=1||(a+=String.fromCodePoint(da(n>>>18&63),da(n>>>12&63),da(n>>>6&63),da(63&n)),n=0);return a.substr(0,a.length-2+t)+(2===t?"":1===t?"=":"==")},ua=e=>{let t;const a=e.length;let r=0;for(let n=0;n<a;n++)t=e.codePointAt(n),t>65536&&n++,r+=t<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;const n=new Uint8Array(r);let i=0,o=0;for(;i<r;)t=e.codePointAt(o),t<128?n[i++]=t:t<2048?(n[i++]=192+(t>>>6),n[i++]=128+(63&t)):t<65536?(n[i++]=224+(t>>>12),n[i++]=128+(t>>>6&63),n[i++]=128+(63&t)):t<2097152?(n[i++]=240+(t>>>18),n[i++]=128+(t>>>12&63),n[i++]=128+(t>>>6&63),n[i++]=128+(63&t),o++):t<67108864?(n[i++]=248+(t>>>24),n[i++]=128+(t>>>18&63),n[i++]=128+(t>>>12&63),n[i++]=128+(t>>>6&63),n[i++]=128+(63&t),o++):(n[i++]=252+(t>>>30),n[i++]=128+(t>>>24&63),n[i++]=128+(t>>>18&63),n[i++]=128+(t>>>12&63),n[i++]=128+(t>>>6&63),n[i++]=128+(63&t),o++),o++;return n},ga=e=>{if(i.getAccessType(e))switch(i.getAccessType(e)){case"owner":return"owner";case"editor":return"writer";default:return"reader"}},ma=e=>({user_access_type:ga(e),is_folder:i.getIsFolder(e),fq_path:i.isNewApiMetadata(e)?e.common_metadata.path_lower:e.path_lower,content_id:i.isNewApiMetadata(e)?e.common_metadata.file_id:i.getIsFile(e)?e.id:i.getIsSharedFolder(e)?e.shared_folder_id:i.getIsFolder(e)?e.path_lower:i.getIsCollection(e)?e.collectionId:"",...{...i.getIsSharedFolder(e)||i.getIsCollection(e)?{ns_id:i.getSharedFolderId(e)}:{}},can_create_edit_link:i.getCanDoAction(e,i.CREATE_EDIT_LINK_TAG),can_create_view_link:i.getCanDoAction(e,i.CREATE_VIEW_LINK_TAG),can_edit_inband_invite:i.getCanDoAction(e,i.INVITE_EDITOR_TAG),can_view_inband_invite:i.getCanDoAction(e,i.INVITE_VIEWER_TAG),max_access:i.getCanDoAction(e,i.CREATE_EDIT_LINK_TAG)||i.getCanDoAction(e,i.INVITE_EDITOR_TAG)?"editor":"viewer"}),pa=e=>e&&"other"!==e[".tag"]?"viewer"===e[".tag"]?"reader":"writer":null,Ea=e=>{const t={link_id:e.id,link_access_level:(a=e.link_permissions.link_access_level,a?a[".tag"]:i.VIEWER[".tag"]),audience:i.getCurrentAudience(e)[".tag"]};var a;const r=(e=>{const t=new URL(e);if(t.search.includes("rlkey"))return{kind:"rlkey",val:t.searchParams.get("rlkey"),link_type:"righteous"};if(t.pathname.includes("/s/")||t.pathname.includes("/sh/")){const e=e=>e.pathname.includes("/raw/")||e.pathname.includes("/dl/")||e.pathname.includes("/print/"),a=e(t)?3:2;return{kind:"tkey",val:t.pathname.split("/")[a],link_type:"shmodel"}}return null})(e.url);return r&&(t[r.kind]=r.val,t.link_type=r.link_type),t},ha=e=>{const t={tray_style:e.loggingExtras.tray_style,tray_variants:e.loggingExtras.variants};return{platform_name:e.platformName,platform_version:e.platformVersion,build_channel:e.buildChannel,build_number:e.buildNumber,...t}},va=(e,t,a,r)=>{const n=t.shareModalSessionId,o=t.sharingObjectMetadata,s=t.desktopMetadata;return n&&(r={...r,modal_session_id:n}),t.sharingObjectIdentifier&&("file"===t.sharingObjectIdentifier[".tag"]?r={...r,file_id:t.sharingObjectIdentifier.fileId}:"shared_folder"===t.sharingObjectIdentifier[".tag"]?r={...r,ns_id:t.sharingObjectIdentifier.sharedFolderId}:"file_folder"===t.sharingObjectIdentifier[".tag"]?r={...r,fq_path:t.sharingObjectIdentifier.path}:"collection"===t.sharingObjectIdentifier[".tag"]&&(r={...r,ns_id:t.sharingObjectIdentifier.nsId,collection_id:t.sharingObjectIdentifier.collectionId})),o&&!i.isNewApiMetadata(o)&&o.path_lower&&(r={...r,fq_path:o.path_lower}),o&&i.isNewApiMetadata(o)&&o.common_metadata.path_lower&&(r={...r,fq_path:o.common_metadata.path_lower}),o&&!i.isNewApiMetadata(o)&&i.getIsFile(o)&&(r={...r,file_id:o.id}),o&&i.isNewApiMetadata(o)&&i.getIsFile(o)&&(r={...r,file_id:o.common_metadata.file_id}),o&&!i.isNewApiMetadata(o)&&i.getIsSharedFolder(o)&&(r={...r,ns_id:o.shared_folder_id}),o&&i.isNewApiMetadata(o)&&i.getIsSharedFolder(o)&&(r={...r,ns_id:o.metadata_response&&"shared_folder_id"in o.metadata_response?o.metadata_response.shared_folder_id:""}),o&&i.getIsCollection(o)&&(r={...r,ns_id:o.shared_folder_id,collection_id:o.collectionId}),s&&(r={...r,...ha(s)}),{share_tiburon_event_type:e,share_tib_action_origin_type:a,extras:r}},Sa=(e,t,a,r)=>{const n=t.shareModalSessionId,i=t.sharingLinkMetadata,o=t.sharingObjectMetadata,s=t.desktopMetadata;return n&&(r={...r,modal_session_id:n}),i&&(r={...r,...Ea(i)}),o&&(r={...r,...ma(o)}),s&&(r={...r,...ha(s)}),{share_tiburon_event_type:e,share_tib_action_origin_type:a,extras:r}},Aa=e=>{const t=f.useContext(Ht),a=Pt();if("standard"===e.type){const r=f.useMemo((()=>e.fetch(t)),[e,t]);return f.useCallback((async t=>{const n=Math.random().toString();a("ENDPOINT_FETCH_BEGIN",{name:e.name,input:t,id:n});const i=Date.now(),o=await r(t),s=Date.now();return a("ENDPOINT_FETCH_END",{name:e.name,id:n,latency:s-i,response:o}),o}),[r,e,a])}{const t=e.useFetch();return f.useCallback((async r=>{const n=Math.random().toString();a("ENDPOINT_FETCH_BEGIN",{name:e.name,input:r,id:n});const i=Date.now(),o=await t(r),s=Date.now();return a("ENDPOINT_FETCH_END",{name:e.name,id:n,latency:s-i,response:o}),o}),[t,e,a])}},fa=(e,t)=>{let a={is_alpha:!0};return t.sharingAccessLevel&&(a={...a,access:t.sharingAccessLevel[".tag"]}),e.createSharedLinkStartTime&&(a={...a,timing:Date.now()-e.createSharedLinkStartTime}),a={...a,include_ns_creation:!1},a},ya=e=>{if(e.shareMe24Metadata){if(e.shareMe24Metadata.shouldStyleForSM21)return i.ScreenName.ManageAccessScreen;if(e.shareMe24Metadata.isShareMe24)return i.ScreenName.ShareMe24ShareScreen}return i.ScreenName.ShareScreen},ba=()=>{const e=(()=>{const e=Aa(la);return f.useMemo((()=>({SHARE_MODAL_SHARE__PREVALIDATION__API_START:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.AttemptTargetValidation,t,r,a))},SHARE_MODAL_SHARE__INVITE__VALIDATION_API_START:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.AttemptTargetValidation,t,r,a))},SHARE_MODAL_SHARE__PREVALIDATION__API_SUCCESS:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.SucceedTargetValidation,t,r,a))},SHARE_MODAL_SHARE__INVITE__VALIDATION_API_SUCCESS:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.SucceedTargetValidation,t,r,a))},SHARE_MODAL_SHARE__PREVALIDATION__API_ERROR:({event:t,metadata:a,extras:r,origin:n})=>{e(va(i.TiburonEventName.FailTargetValidation,a,n,{...r,error:t.payload.error[".tag"]}))},SHARE_MODAL_SHARE__PREVALIDATION__API_FATAL:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.FailTargetValidation,t,r,{...a,error:"unknown server error"}))},SHARE_MODAL_SHARE__INVITE__VALIDATION_API_ERROR:({event:t,metadata:a,extras:r,origin:n})=>{e(va(i.TiburonEventName.FailTargetValidation,a,n,{...r,error:t.payload.error[".tag"]}))},SHARE_MODAL_SHARE__INVITE__VALIDATION_API_FATAL:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.FailTargetValidation,t,r,{...a,error:"unknown server error"}))},SHARE_MODAL_MANAGE_ACCESS__MANAGE_ACCESS__CLICK:({metadata:t,extras:a,origin:r})=>{t.sharingObjectMembership&&(a={...a,access_level:t.sharingObjectMembership.access_type[".tag"]}),e(va(i.TiburonEventName.ClickManageAccess,t,r,a))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_MEMBER_ACCESS__CLICK:({event:t,metadata:a,extras:r,origin:n})=>{e(va(i.TiburonEventName.SelectChangeMemberPermission,a,n,{...r,new_access:"editor"===t.payload.next[".tag"]?"writer":"reader",old_access:"editor"===t.payload.previous[".tag"]?"writer":"reader"}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_SUCCESS:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.SucceedChangeMemberPermission,t,r,{...a,http_status_code:200,response_status:"success",is_alpha:!1}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_SUCCESS:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.SucceedChangeMemberPermission,t,r,{...a,http_status_code:200,response_status:"success",is_alpha:!1}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_FATAL:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.FailChangeMemberPermission,t,r,{...a,is_alpha:!1,http_status_code:0,error_tag:"undefined"}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_ERROR:({event:t,metadata:a,extras:r,origin:n})=>{e(va(i.TiburonEventName.FailChangeMemberPermission,a,n,{...r,is_alpha:!1,http_status_code:t.payload.response.statusCode,error_tag:t.payload.response.error[".tag"]}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_FATAL:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.FailChangeMemberPermission,t,r,{...a,is_alpha:!1,http_status_code:0,error_tag:"undefined"}))},SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_ERROR:({event:t,metadata:a,extras:r,origin:n})=>{e(va(i.TiburonEventName.FailChangeMemberPermission,a,n,{...r,is_alpha:!1,http_status_code:t.payload.response.statusCode,error_tag:t.payload.response.error[".tag"]}))},SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_ERROR:({event:t,metadata:a,extras:r,origin:n})=>{e(va(i.TiburonEventName.FailTransferFolder,a,n,{...r,is_alpha:!1,http_status_code:t.payload.response.statusCode,error_tag:t.payload.response.error[".tag"]}))},SHARE_MODAL_SHARE__CREATE_LINK__API_START:({metadata:t,extras:a,origin:r,cache:n})=>{t.sharingAccessLevel&&(a={...a,access:t.sharingAccessLevel[".tag"]}),n.createSharedLinkStartTime=Date.now(),e(va(i.TiburonEventName.AttemptCreateSharedLinkWithSettings,t,r,a))},SHARE_MODAL_SETTINGS__CREATE_LINK_API_START:({metadata:t,extras:a,origin:r,cache:n})=>{t.sharingAccessLevel&&(a={...a,access:t.sharingAccessLevel[".tag"]}),n.createSharedLinkStartTime=Date.now(),e(va(i.TiburonEventName.AttemptCreateSharedLinkWithSettings,t,r,a))},SHARE_MODAL_SHARE__CREATE_LINK__API_SUCCESS:({metadata:t,event:a,origin:r,extras:n,cache:o})=>{(t={...t,sharingLinkMetadata:a.payload.response.output}).sharingLinkMetadata&&(n={...n,...Ea(t.sharingLinkMetadata)}),e(va(i.TiburonEventName.SucceedCreateSharedLinkWithSettings,t,r,{http_status_Code:200,response_status:"success",...fa(o,t),...n}))},SHARE_MODAL_SETTINGS__CREATE_LINK_API_SUCCESS:({metadata:t,event:a,origin:r,extras:n,cache:o})=>{(t={...t,sharingLinkMetadata:a.payload.response.output}).sharingLinkMetadata&&(n={...n,...Ea(t.sharingLinkMetadata)}),e(va(i.TiburonEventName.SucceedCreateSharedLinkWithSettings,t,r,{http_status_Code:200,response_status:"success",...fa(o,t),...n}))},SHARE_MODAL_SHARE__CREATE_LINK__API_ERROR:({metadata:t,event:a,extras:r,origin:n,cache:o})=>{"shared_link_already_exists"!==a.payload.response.error[".tag"]?e(va(i.TiburonEventName.FailCreateSharedLinkWithSettings,t,n,{error_tag:a.payload.response.error[".tag"],http_status_code:a.payload.response.statusCode,fail_at:"link_creation",...fa(o,t),...r})):e(va(i.TiburonEventName.SucceedCreateSharedLinkWithSettings,t,n,{http_status_code:a.payload.response.statusCode,response_status:"success",...fa(o,t),...r}))},SHARE_MODAL_SETTINGS__CREATE_LINK_API_ERROR:({metadata:t,extras:a,cache:r,origin:n,event:o})=>{"shared_link_already_exists"!==o.payload.response.error[".tag"]?e(va(i.TiburonEventName.FailCreateSharedLinkWithSettings,t,n,{error_tag:o.payload.response.error[".tag"],http_status_code:o.payload.response.statusCode,fail_at:"link_creation",...fa(r,t),...a})):e(va(i.TiburonEventName.SucceedCreateSharedLinkWithSettings,t,n,{http_status_code:o.payload.response.statusCode,response_status:"success",...fa(r,t),...a}))},SHARE_MODAL_SHARE__CREATE_LINK__API_FATAL:({metadata:t,extras:a,origin:r,cache:n})=>{e(va(i.TiburonEventName.FailCreateSharedLinkWithSettings,t,r,{fail_at:"link_creation",...fa(n,t),http_status_code:0,error_tag:"undefined_error",...a}))},SHARE_MODAL_SETTINGS__CREATE_LINK_API_FATAL:({metadata:t,extras:a,origin:r,cache:n})=>{e(va(i.TiburonEventName.FailCreateSharedLinkWithSettings,t,r,{fail_at:"link_creation",...fa(n,t),http_status_code:0,error_tag:"undefined_error",...a}))},SHARE_MODAL_SHARE__CREATE_LINK__CLICK:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.ClickTibCreateLink,t,r,a))},SHARE_MODAL_SETTINGS__CREATE_LINK__CLICK:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.ClickTibCreateLink,t,r,a))},SHARE_MODAL_SHARE__INVITE__START:({metadata:t,extras:a,origin:r,cache:n})=>{n.inviteStartTime=Date.now(),e(va(i.TiburonEventName.ClickInbandShareButton,t,r,{in_progress:!1,access_level:pa(t.sharingAccessLevel),screen:ya(t),...a}));const o=t.sharingLinkMetadata;o&&e(Sa(i.TiburonEventName.ClickShareButtonLinkSettingsStatus,t,r,{...a,isPasswordRequired:o.link_permissions.require_password||!1,isExpirationEnabled:!!o.expires,isDisabledDownloadEnabled:!o.link_permissions.allow_download}))},SHARE_MODAL_SHARE__COPY_LINK__CLICK:({metadata:t,extras:a,origin:r})=>{var n,o;e(Sa(i.TiburonEventName.CopySharedLink,t,r,{...a,tokenized_contact_count:null===(n=t.sharingInviteTargets)||void 0===n?void 0:n.length,sender_trackey:i.getSenderTrackeyFromURL(null===(o=t.sharingLinkMetadata)||void 0===o?void 0:o.url)}))},SHARE_MODAL_SHARE__CREATE_LINK__COPY_START:({metadata:t,event:a,origin:r,extras:n})=>{var o,s;t={...t,sharingLinkMetadata:a.payload.linkMetadata},e(Sa(i.TiburonEventName.CopySharedLink,t,r,{...n,tokenized_contact_count:null===(o=t.sharingInviteTargets)||void 0===o?void 0:o.length,sender_trackey:i.getSenderTrackeyFromURL(null===(s=t.sharingLinkMetadata)||void 0===s?void 0:s.url)}))},SHARE_MODAL_SHARE__CREATE_LINK__COPY_ERROR:({metadata:t,extras:a,origin:r})=>{var n;e(Sa(i.TiburonEventName.CopySharedLinkFailure,t,r,{...a,tokenized_contact_count:null===(n=t.sharingInviteTargets)||void 0===n?void 0:n.length,error:"failed_copy_to_clipboard"}))},SHARE_MODAL_SHARE__COPY_LINK__COPY_ERROR:({metadata:t,extras:a,origin:r})=>{var n;e(Sa(i.TiburonEventName.CopySharedLinkFailure,t,r,{...a,tokenized_contact_count:null===(n=t.sharingInviteTargets)||void 0===n?void 0:n.length,error:"failed_copy_to_clipboard"}))},SHARE_MODAL_SHARE__CREATE_LINK__COPY_FORBIDDEN:({metadata:t,extras:a,origin:r})=>{var n;e(Sa(i.TiburonEventName.CopySharedLinkFailure,t,r,{...a,tokenized_contact_count:null===(n=t.sharingInviteTargets)||void 0===n?void 0:n.length,error:"failed_copy_to_clipboard"}))},SHARE_MODAL_SHARE__INVITE__CANCELLED:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.FailInbandShare,t,r,{error_tag:"contacts_error",error_message:"contact validation error",num_recipients:t.sharingInviteTargets?t.sharingInviteTargets.length:0,access_level:pa(t.sharingAccessLevel),screen:ya(t),...a}))},SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_ERROR:({metadata:t,extras:a,origin:r,cache:n,event:o})=>{n.inviteStartTime&&(a.timing=Date.now()-n.inviteStartTime),e(Sa(i.TiburonEventName.FailInbandShare,t,r,{...a,error_tag:o.payload.response.error[".tag"],http_status_code:o.payload.response.statusCode,num_recipients:t.sharingInviteTargets?t.sharingInviteTargets.length:0,screen:ya(t)}))},SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_FATAL:({metadata:t,extras:a,origin:r,cache:n})=>{n.inviteStartTime&&(a.timing=Date.now()-n.inviteStartTime),e(Sa(i.TiburonEventName.FailInbandShare,t,r,{...a,error_tag:"undefined",http_status_code:0,num_recipients:t.sharingInviteTargets?t.sharingInviteTargets.length:0,screen:ya(t)}))},SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_ERROR:({event:t,metadata:a,extras:r,origin:n,cache:o})=>{o.inviteStartTime&&(r={...r,timing:Date.now()-o.inviteStartTime}),e(Sa(i.TiburonEventName.FailInbandShare,a,n,{...r,error_tag:t.payload.response.error[".tag"],http_status_code:t.payload.response.statusCode,num_recipients:a.sharingInviteTargets?a.sharingInviteTargets.length:0,screen:ya(a)}))},SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_FATAL:({metadata:t,extras:a,origin:r,cache:n})=>{n.inviteStartTime&&(a={...a,timing:Date.now()-n.inviteStartTime}),e(Sa(i.TiburonEventName.FailInbandShare,t,r,{...a,error_tag:"undefined",http_status_code:0,num_recipients:t.sharingInviteTargets?t.sharingInviteTargets.length:0,screen:ya(t)}))},SHARE_MODAL_SHARE__INVITE__SHARE_FILE_FOLDER__FAILURE:({event:t,metadata:a,extras:r,origin:n,cache:o})=>{var s;o.inviteStartTime&&(r={...r,timing:Date.now()-o.inviteStartTime}),"ApiError"===t.payload.output.type||"PollingApiError"===t.payload.output.type?r={...r,error_tag:t.payload.output.value.response.error[".tag"],http_status_code:t.payload.output.value.response.statusCode}:"NetworkFailure"===t.payload.output.type||"PollingNetworkFailure"===t.payload.output.type?r={...r,error_tag:"network",http_status_code:null!==(s=t.payload.output.value.response.statusCode)&&void 0!==s?s:0}:"PollingFailed"===t.payload.output.type?r={...r,error_tag:"failed",http_status_code:0}:"PollingTimeout"===t.payload.output.type&&(r={...r,error_tag:"network",http_status_code:408}),e(Sa(i.TiburonEventName.FailInbandShare,a,n,{...r,num_recipients:a.sharingInviteTargets?a.sharingInviteTargets.length:0,screen:ya(a)}))},SHARE_MODAL_SETTINGS__PAGE_VIEW:({metadata:t,extras:a,origin:r,event:n})=>{e(va(i.TiburonEventName.ViewSettingsScreen,t,r,{...a,settings_tab:n.payload.selected_tab})),e(va(i.TiburonEventName.ViewSettingsTab,t,r,{...a,settings_tab:n.payload.selected_tab}))},SHARE_MODAL_SETTINGS__TAB_CHANGE:({metadata:t,extras:a,origin:r,event:n})=>{e(va(i.TiburonEventName.ViewSettingsTab,t,r,{...a,settings_tab:n.payload.selected_tab}))},SHARE_MODAL_MANAGE_ACCESS__SETTINGS_GEAR__CLICK:({metadata:t,extras:a,origin:r})=>{e(Sa(i.TiburonEventName.ClickSettingsGear,t,r,{...a,screen:i.ScreenName.ManageAccessScreen}));const n=t.sharingObjectMetadata;n&&(i.getIsFile(n)?e(va(i.TiburonEventName.OpenFileSettingsModal,t,r,a)):i.getIsFolder(n)&&e(va(i.TiburonEventName.OpenFolderSettingsModal,t,r,a)))},SHARE_MODAL_MANAGE_ACCESS__SETTINGS_TEXT__CLICK:({metadata:t,extras:a,origin:r,event:n})=>{e(Sa(i.TiburonEventName.ClickManageAccessPageSettingsText,t,r,{...a,screen:i.ScreenName.ManageAccessScreen,settings_tab:n.payload.settings_tab,link_access_level:n.payload.link_access_level,link_type:n.payload.link_type}));const o=t.sharingObjectMetadata;o&&e(va(i.getIsFile(o)?i.TiburonEventName.OpenFileSettingsModal:i.TiburonEventName.OpenFolderSettingsModal,t,r,a))},SHARE_MODAL_SHARE__SETTINGS_GEAR__CLICK:({metadata:t,extras:a,origin:r})=>{e(Sa(i.TiburonEventName.ClickSettingsGear,t,r,{...a,screen:i.ScreenName.ShareScreen}));const n=t.sharingObjectMetadata;n&&(i.getIsFile(n)?e(va(i.TiburonEventName.OpenFileSettingsModal,t,r,a)):i.getIsFolder(n)&&e(va(i.TiburonEventName.OpenFolderSettingsModal,t,r,a)))},SHARE_MODAL_SHARE__SETTINGS_LINK__CLICK:({metadata:t,extras:a,origin:r})=>{a=t.sharingAccessLevel&&"editor"===t.sharingAccessLevel[".tag"]?{...a,settings_tab:"edit_link_settings"}:{...a,settings_tab:"view_link_settings"},e(Sa(i.TiburonEventName.ClickSettingsText,t,r,a))},SHARE_MODAL_SHARE__MODIFY_LINK__CLICK:({metadata:t,extras:a,origin:r})=>{a=t.sharingAccessLevel&&"editor"===t.sharingAccessLevel[".tag"]?{...a,settings_tab:"edit_link_settings"}:{...a,settings_tab:"view_link_settings"},e(Sa(i.TiburonEventName.OpenLinkSettingsModal,t,r,a))},SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_SUCCESS:({metadata:t,extras:a,origin:r,cache:n})=>{n.inviteStartTime&&(a={...a,timing:Date.now()-n.inviteStartTime}),e(va(i.TiburonEventName.SucceedInbandShare,t,r,{...a,access_level:pa(t.sharingAccessLevel),num_recipients:t.sharingInviteTargets?t.sharingInviteTargets.length:0,screen:ya(t)}))},SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_SUCCESS:({metadata:t,extras:a,cache:r,origin:n})=>{r.inviteStartTime&&(a={...a,timing:Date.now()-r.inviteStartTime}),e(va(i.TiburonEventName.SucceedInbandShare,t,n,{...a,num_recipients:t.sharingInviteTargets?t.sharingInviteTargets.length:0,screen:ya(t)}))},SHARE_MODAL_SHARE__INVITE__NAVIGATE_ATTEMPT:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.AttemptNavigateAwayDuringShare,t,r,a))},SHARE_MODAL_SHARE__INVITE__NAVIGATE_AWAY:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.SucceedNavigateAwayDuringShare,t,r,a))},SHARE_MODAL_SETTINGS__UPSELL_LINK__CLICKED:({event:t,metadata:a,extras:r,origin:n})=>{r={...r,element_trackingId:"link_settings_pro_upsell",element_href:t.payload.href},e(va(i.TiburonEventName.ElementClick,a,n,r))},SHARE_MODAL_SETTINGS__UPSELL_LINK__EXPOSED:({event:t,metadata:a,extras:r,origin:n})=>{r={...r,element_trackingId:"link_settings_pro_upsell",element_href:t.payload.href},e(va(i.TiburonEventName.ElementView,a,n,r))},SHARE_MODAL_SETTINGS__UNSHARE_OBJECT_API_START:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.AttemptRemoveAllMembers,t,r,a))},SHARE_MODAL_SETTINGS__UNSHARE_OBJECT_API_ERROR:({metadata:t,event:a,origin:r,extras:n})=>{e(va(i.TiburonEventName.FailRemoveAllMembers,t,r,{http_status_code:a.payload.response.statusCode,error_message:a.payload.response.error[".tag"],...n}))},SHARE_MODAL_SETTINGS__UNSHARE_OBJECT_API_FATAL:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.FailRemoveAllMembers,t,r,{http_status_code:0,error_message:"undefined_error",...a}))},SHARE_MODAL_SETTINGS__UNSHARE_OBJECT_API_SUCCESS:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.SucceedRemoveAllMembers,t,r,{http_status_code:200,response_status:"success",...a}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_START:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.AttemptRemoveMember,t,r,a))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_START:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.AttemptRemoveMember,t,r,a))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_START:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.AttemptRemoveMember,t,r,{relinquish_membership:!0,...a}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_START:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.AttemptRemoveMember,t,r,{relinquish_membership:!0,...a}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_ERROR:({metadata:t,extras:a,origin:r,event:n})=>{e(va(i.TiburonEventName.FailRemoveMember,t,r,{http_status_code:n.payload.response.statusCode,error_tag:n.payload.response.error[".tag"],...a}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_FATAL:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.FailRemoveMember,t,r,{http_status_code:0,error_tag:"undefined_error",...a}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_ERROR:({metadata:t,extras:a,origin:r,event:n})=>{e(va(i.TiburonEventName.FailRemoveMember,t,r,{relinquish_membership:!0,http_status_code:n.payload.response.statusCode,error_tag:n.payload.response.error[".tag"],...a}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_FATAL:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.FailRemoveMember,t,r,{relinquish_membership:!0,http_status_code:0,error_tag:"undefined_error",...a}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_FAILURE:({event:t,metadata:a,extras:r,origin:n,cache:o})=>{o.inviteStartTime&&(r={...r,timing:Date.now()-o.inviteStartTime}),"ApiError"===t.payload.output.type||"PollingApiError"===t.payload.output.type?r={...r,error_tag:t.payload.output.value.response.error[".tag"],http_status_code:t.payload.output.value.response.statusCode}:"NetworkFailure"===t.payload.output.type||"PollingNetworkFailure"===t.payload.output.type?r={...r,error_tag:"unknown",http_status_code:0}:"PollingFailed"===t.payload.output.type?r={...r,error_tag:"failed",http_status_code:0}:"PollingTimeout"===t.payload.output.type&&(r={...r,error_tag:"timeout",http_status_code:0}),e(Sa(i.TiburonEventName.FailRemoveMember,a,n,r))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_FAILURE:({event:t,metadata:a,extras:r,origin:n,cache:o})=>{o.inviteStartTime&&(r={...r,timing:Date.now()-o.inviteStartTime}),"ApiError"===t.payload.output.type||"PollingApiError"===t.payload.output.type?r={...r,error_tag:t.payload.output.value.response.error[".tag"],http_status_code:t.payload.output.value.response.statusCode}:"NetworkFailure"===t.payload.output.type||"PollingNetworkFailure"===t.payload.output.type?r={...r,error_tag:"unknown",http_status_code:0}:"PollingFailed"===t.payload.output.type?r={...r,error_tag:"failed",http_status_code:0}:"PollingTimeout"===t.payload.output.type&&(r={...r,error_tag:"timeout",http_status_code:0}),e(Sa(i.TiburonEventName.FailRemoveMember,a,n,{relinquish_membership:!0,...r}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_SUCCESS:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.SucceedRemoveMember,t,r,{http_status_code:200,...a}))},SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_SUCCESS:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.SucceedRemoveMember,t,r,{http_status_code:200,...a}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_SUCCESS:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.SucceedRemoveMember,t,r,{relinquish_membership:!0,http_status_code:200,...a}))},SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_SUCCESS:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.SucceedRemoveMember,t,r,{relinquish_membership:!0,http_status_code:200,...a}))},SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_START:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.AttemptTransferFolder,t,r,a))},SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_FATAL:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.FailTransferFolder,t,r,{http_status_code:0,error_tag:"undefined_error",...a}))},SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_SUCCESS:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.SucceedTransferFolder,t,r,{http_status_code:200,...a}))},SHARE_MODAL_DATA_LOADER__INITIAL_LOADER__START:({metadata:t,extras:a,origin:r,cache:n})=>{n.shareModalDataLoadStartTime=Date.now(),n.inviteStartTime=void 0,n.createSharedLinkStartTime=void 0,e(va(i.TiburonEventName.BeginShareFlow,t,r,a))},SHARE_MODAL_DATA_LOADER__INITIAL_LOADER__SUCCESS:({metadata:t,extras:a,origin:r,cache:n})=>{n.shareModalDataLoadStartTime&&(a={...a,timing:Date.now()-n.shareModalDataLoadStartTime}),e(va(i.TiburonEventName.ViewShareModal,t,r,a))},SHARE_MODAL_RELINQUISHED_SCREEN__VIEW:({metadata:t,extras:a,origin:r,cache:n})=>{a={...a,is_relinquished_screen:!0},n.shareModalDataLoadStartTime&&(a={...a,timing:Date.now()-n.shareModalDataLoadStartTime}),e(va(i.TiburonEventName.ViewShareModal,t,r,a))},SHARE_MODAL_ERROR_SCREEN__VIEW:({metadata:t,extras:a,origin:r,event:n})=>{if("response"in n.payload.initialLoadError){const e=n.payload.initialLoadError.response;let t;e.status!==na.FATAL&&(t=e.error[".tag"]);const r=e.error;a={...a,http_status_code:e.statusCode,error_summary:t,error_message:r,failing_endpoint:n.payload.initialLoadError.type}}else a={...a,event:n};e(va(i.TiburonEventName.ViewErrorScreen,t,r,a))},SHARE_MODAL_SETTINGS__LINK_AUDIENCE_CHANGE:({metadata:t,extras:a,origin:r,event:n})=>{if(t.sharingLinksMetadata){const e=i.getByAccessLevel(t.sharingLinksMetadata,n.payload.link_access_level);e&&(a={...a,...Ea(e)})}e(va(i.TiburonEventName.ChangeSharedLinkAudience,t,r,{old_audience:n.payload.previous[".tag"],new_audience:n.payload.next[".tag"],screen:i.ScreenName.SettingsScreen,...a}))},SHARE_MODAL_MANAGE_ACCESS__PARENT_FOLDER_CHANGE_ACCESS_MODAL__VIEW:({metadata:t,extras:a,event:r,origin:n})=>{e(va(i.TiburonEventName.OpenParentFolderAccessModal,t,n,{...a,num_parent_folders:r.payload.numParents}))},SHARE_MODAL_MANAGE_ACCESS__PARENT_FOLDER_REMOVE_ACCESS_MODAL__VIEW:({metadata:t,extras:a,event:r,origin:n})=>{e(va(i.TiburonEventName.OpenParentFolderAccessModal,t,n,{...a,num_parent_folders:r.payload.numParents}))},SHARE_MODAL_SHARE__VIEW:({metadata:t,extras:a,origin:r})=>{let n;t.sharingObjectMetadata&&(n=i.getCanDoAction(t.sharingObjectMetadata,i.INVITE_EDITOR_TAG)),t.sharingObjectMetadata&&i.getIsNonSharedFolder(t.sharingObjectMetadata)&&!n?a={...a,link_only_reason:"limited_permissions"}:t.sharingObjectMetadata&&i.getIsLinkOnlyMode(t.sharingObjectMetadata)?(a=t.sharingObjectMetadata.tooManyMountsError?{...a,link_only_reason:t.sharingObjectMetadata.tooManyMountsError[".tag"]}:{...a,link_only_reason:"is_family"},e(Sa(i.TiburonEventName.ViewLinkOnlyModal,t,r,{...a,share_tab:t.sharingAccessLevel&&"editor"===t.sharingAccessLevel[".tag"]?"edit_tab":"view_tab"}))):(e(Sa(i.TiburonEventName.ViewShareScreen,t,r,{...a,share_tab:t.sharingAccessLevel&&"editor"===t.sharingAccessLevel[".tag"]?"edit_tab":"view_tab"})),e(Sa(i.TiburonEventName.ViewShareTab,t,r,{...a,share_tab:t.sharingAccessLevel&&"editor"===t.sharingAccessLevel[".tag"]?"edit_tab":"view_tab"})))},SHARE_MODAL_SHARE__LINK_ACCESS_LEVEL__CHANGE:({metadata:t,extras:a,origin:r,event:n})=>{e(Sa(i.TiburonEventName.ViewShareTab,t,r,{...a,share_tab:"editor"===n.payload.next[".tag"]?"edit_tab":"view_tab"}))},SHARE_MODAL_MANAGE_ACCESS__VIEW:({metadata:t,extras:a,origin:r,event:n})=>{e(Sa(i.TiburonEventName.ViewManageAccessScreen,t,r,{...a,manage_tab:n.payload.manage_tab,share_modal_initial_screen:n.payload.share_modal_initial_screen}))},SHARE_MODAL_MANAGE_ACCESS_TAB__VIEW:({metadata:t,extras:a,origin:r,event:n})=>{e(Sa(i.TiburonEventName.ViewManageAccessTab,t,r,{...a,manage_tab:n.payload.manage_tab,share_modal_initial_screen:n.payload.share_modal_initial_screen}))},SHARE_MODAL_SHARE__MANAGE_ACCESS__CLICK:({metadata:t,extras:a,origin:r})=>{e(Sa(i.TiburonEventName.ClickWhoCanAccess,t,r,a))},SHARE_MODAL__REQUEST_CLOSE__CALLED:({metadata:t,extras:a,origin:r,event:n,cache:o})=>{t={...t,sharingObjectIdentifier:n.payload.objectIdentifier},t={...t,shareModalSessionId:n.payload.sessionId},o.inviteStartTime&&(a={...a,time_modal_opened:Date.now()-o.inviteStartTime}),e(va(i.TiburonEventName.CloseShareModal,t,r,a))},TARGETS_TOKENIZER__TARGETS_SEARCH__API_START:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.AttemptTargetSearch,t,r,a))},TARGETS_TOKENIZER__TARGETS_SEARCH__API_SUCCESS:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.SucceedTargetSearch,t,r,a))},TARGETS_TOKENIZER__TARGETS_SEARCH__API_ERROR:({metadata:t,extras:a,origin:r,event:n})=>{e(va(i.TiburonEventName.FailTargetSearch,t,r,{...a,error:n.payload.response.error[".tag"]}))},TARGETS_TOKENIZER__TARGETS_SEARCH__API_FATAL:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.FailTargetSearch,t,r,{...a,error:"unknown"}))},SHARE_MODAL_SETTINGS__DELETE_LINK_API_START:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.AttemptDeleteSharedLink,t,r,a))},SHARE_MODAL_SETTINGS__DELETE_LINK_API_ERROR:({metadata:t,event:a,origin:r,extras:n})=>{e(va(i.TiburonEventName.FailDeleteSharedLink,t,r,{http_status_code:a.payload.response.statusCode,error_message:a.payload.response.error[".tag"],...n}))},SHARE_MODAL_SETTINGS__DELETE_LINK_API_FATAL:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.FailDeleteSharedLink,t,r,{http_status_code:0,error_message:"undefined_error",...a}))},SHARE_MODAL_SETTINGS__DELETE_LINK_API_SUCCESS:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.SucceedDeleteSharedLink,t,r,{http_status_code:200,response_status:"success",...a}))},SHARE_MODAL_SETTINGS__CREATE_LINK__NAMESPACE_CREATE_ERROR:({metadata:t,extras:a,event:r,origin:n})=>{var o,s;a={...a,http_status_code:0,error_tag:"undefined_error",access:(null===(o=t.sharingAccessLevel)||void 0===o?void 0:o[".tag"])||"unknown"},a="ApiError"===r.payload.output.type||"PollingApiError"===r.payload.output.type?{...a,http_status_code:200,error_tag:r.payload.output.value.response.error[".tag"],access:(null===(s=t.sharingAccessLevel)||void 0===s?void 0:s[".tag"])||"unknown"}:"NetworkFailure"===r.payload.output.type||"PollingNetworkFailure"===r.payload.output.type?{...a,http_status_code:r.payload.output.value.response.statusCode||0}:{...a,error_tag:r.payload.output.type},e(va(i.TiburonEventName.FailCreateNamespaceAfterLinkCreated,t,n,a))},SHARE_MODAL_SHARE__CREATE_LINK__NAMESPACE_CREATE_ERROR:({metadata:t,extras:a,event:r,origin:n})=>{var o,s;a={...a,http_status_code:0,error_tag:"undefined_error",access:(null===(o=t.sharingAccessLevel)||void 0===o?void 0:o[".tag"])||"unknown"},a="ApiError"===r.payload.output.type||"PollingApiError"===r.payload.output.type?{...a,http_status_code:200,error_tag:r.payload.output.value.response.error[".tag"],access:(null===(s=t.sharingAccessLevel)||void 0===s?void 0:s[".tag"])||"unknown"}:"NetworkFailure"===r.payload.output.type||"PollingNetworkFailure"===r.payload.output.type?{...a,http_status_code:r.payload.output.value.response.statusCode||0}:{...a,error_tag:r.payload.output.type},e(va(i.TiburonEventName.FailCreateNamespaceAfterLinkCreated,t,n,a))},SHARE_MODAL_SHARE__SOLVE_DEFAULT_AUDIENCE_CONFLICT__ATTEMPT:({metadata:t,extras:a,origin:r,event:n})=>{e(va(i.TiburonEventName.AttemptSolveDefaultAudienceConflict,t,r,{...a,user_default_link_audience:n.payload.user_default_link_audience,team_default_link_audience:n.payload.team_default_link_audience,final_audience:n.payload.final_audience,is_team_user:n.payload.is_team_user}))},SHARE_MODAL_SHARE__SOLVE_DEFAULT_AUDIENCE_CONFLICT__FAIL:({metadata:t,extras:a,origin:r,event:n})=>{e(va(i.TiburonEventName.FailSolveDefaultAudienceConflict,t,r,{...a,user_default_link_audience:n.payload.user_default_link_audience,team_default_link_audience:n.payload.team_default_link_audience,final_audience:n.payload.final_audience,is_team_user:n.payload.is_team_user}))},SHARE_MODAL_SHARE__SOLVE_DEFAULT_AUDIENCE_CONFLICT__SUCCEED:({metadata:t,extras:a,origin:r,event:n})=>{e(va(i.TiburonEventName.SucceedSolveDefaultAudienceConflict,t,r,{...a,user_default_link_audience:n.payload.user_default_link_audience,team_default_link_audience:n.payload.team_default_link_audience,final_audience:n.payload.final_audience,is_team_user:n.payload.is_team_user}))},SHARE_MODAL_VALIDATE_FOLDER_PATH_NO_PERMISSION:({metadata:t,extras:a,origin:r})=>{e(va(i.TiburonEventName.ValidateFolderPathNoPermission,t,r,a))}})),[e])})(),t=f.useMemo((()=>({})),[]);return f.useCallback(((a,r,n)=>{const i=e[a.type];if(i&&n)try{i({event:a,metadata:r,origin:n,cache:t,extras:{is_sdk:!0}})}catch(e){}}),[e,t])},Ta=({sink:e,children:a,origin:r,actionInfo:n})=>{const i=(()=>{const e=Gt();return f.useCallback(((a,r)=>{var n;("SANDBOX"===e||e===t.Platforms.DESKTOP&&"developer"===(null===(n=r.desktopMetadata)||void 0===n?void 0:n.buildChannel))&&window.console.log(a,r)}),[e])})(),o=ba(),s=f.useMemo((()=>Ot(e,i,o)),[e,i,o]);return f.createElement(Dt,{sink:s,origin:r,actionInfo:n},a)};Ta.displayName="LoggingProviderWithBuiltIns";const Ia=({loggingSink:e,sdk:a,children:r,redirectWindowToken:n=null,intl:o,platform:s=t.Platforms.SANDBOX,openUrl:_=null,origin:l,actionInfo:d,apiContext:c,onSnackbarShownChange:u})=>f.createElement(Ut,{intl:o},f.createElement(zt,{platform:s},f.createElement(Jt,{openUrl:_||Yt},f.createElement($t,{sdk:a},f.createElement(Kt,{redirectWindowToken:n},f.createElement(Ta,{sink:e||kt,origin:l,actionInfo:d},f.createElement(ra,{onSnackbarShownChange:u},f.createElement(i.Provider$1,{apiContext:c},r))))))));Ia.displayName="Provider";const Ra=/^www\.dropbox\.com$/,wa=/^meta-.*\.dev\.corp\.dropbox\.com$/,Ca=["/2/sharing_receiving/sharing_tiburon_logger","/2/sharing/targets/search","/2/sharing/check_remove_member_job_status","/2/profile_services/list_linked_services"],Ma=(e,t)=>{if(!e.sharingObjectIdentifier)throw new Error("Missing objectIdentifier while trying to log to PAP");if(!e.sharingObjectMetadata)throw new Error("Missing objectMetadata while trying to log to PAP");if(!t)throw new Error("Missing actionInfo while trying to log to PAP")},La=async(e,t)=>{const a=i.PAP_Copy_SharedLink({...e,contentAction:e.contentAction?i.getContentActionFromString(e.contentAction):void 0}),r={isDir:e.isDir?"true":"false"};"start"===e.eventState?i.UDCL.logStart(a,{tags:r,key:t}):i.UDCL.logEnd(a,{tags:r,key:t})},ka=async(e,t)=>{const a=i.PAP_Create_SharedLink({...e,contentAction:e.contentAction?i.getContentActionFromString(e.contentAction):void 0});"start"===e.eventState?i.UDCL.logStart(a,{key:t}):i.UDCL.logEnd(a,{key:t})},Na=()=>(({logCopyLinkEvent:e,logCreateLinkEvent:t})=>f.useCallback(((a,r,n,o)=>{switch(a.type){case"SHARE_MODAL_SHARE__COPY_LINK__CLICK":Ma(r,o),i.getLinkMetadataSharedLinkProps(a.payload.linkMetadata).then((t=>e({...i.getBaseCopySharedLinkProps("start",o,r,!0),...t},i.getFileIdOrPath(r))));break;case"SHARE_MODAL_SHARE__COPY_LINK__COPY_SUCCESS":Ma(r,o),i.getLinkMetadataSharedLinkProps(a.payload.linkMetadata).then((t=>e({...i.getBaseCopySharedLinkProps("success",o,r,!0),...t},i.getFileIdOrPath(r))));break;case"SHARE_MODAL_SHARE__COPY_LINK__COPY_ERROR":Ma(r,o),i.getLinkMetadataSharedLinkProps(a.payload.linkMetadata).then((t=>e({...i.getBaseCopySharedLinkProps("rejected",o,r,!0),...t},i.getFileIdOrPath(r))));break;case"SHARE_MODAL_SHARE__CREATE_LINK__API_START":Ma(r,o),t(i.getBaseCreateSharedLinkProps("start",o,r),i.getFileIdOrPath(r)),e(i.getBaseCopySharedLinkProps("start",o,r,!1),i.getFileIdOrPath(r));break;case"SHARE_MODAL_SETTINGS__CREATE_LINK_API_START":Ma(r,o),t(i.getBaseCreateSharedLinkProps("start",o,r),i.getFileIdOrPath(r));break;case"SHARE_MODAL_SHARE__CREATE_LINK__API_SUCCESS":case"SHARE_MODAL_SETTINGS__CREATE_LINK_API_SUCCESS":Ma(r,o),i.getLinkMetadataSharedLinkProps(a.payload.response.output,200).then((e=>t({...i.getBaseCreateSharedLinkProps("success",o,r),...e},i.getFileIdOrPath(r))));break;case"SHARE_MODAL_SHARE__CREATE_LINK__API_ERROR":case"SHARE_MODAL_SHARE__CREATE_LINK__API_FATAL":Ma(r,o);const n=i.getErrorState$1(a.payload.response);t({...i.getBaseCreateSharedLinkProps(n,o,r),...i.getCreateLinkExceptionProps(a.payload.response)},i.getFileIdOrPath(r)),e({...i.getBaseCopySharedLinkProps(n,o,r,!1),...i.getCreateLinkExceptionProps(a.payload.response)},i.getFileIdOrPath(r));break;case"SHARE_MODAL_SETTINGS__CREATE_LINK_API_ERROR":case"SHARE_MODAL_SETTINGS__CREATE_LINK_API_FATAL":Ma(r,o);const s=i.getErrorState$1(a.payload.response);t({...i.getBaseCreateSharedLinkProps(s,o,r),...i.getCreateLinkExceptionProps(a.payload.response)},i.getFileIdOrPath(r));break;case"SHARE_MODAL_SHARE__CREATE_LINK__COPY_ERROR":Ma(r,o),i.getLinkMetadataSharedLinkProps(a.payload.linkMetadata,200).then((t=>e({...i.getBaseCopySharedLinkProps("rejected",o,r,!1),...t},i.getFileIdOrPath(r))));break;case"SHARE_MODAL_SHARE__CREATE_LINK__COPY_FORBIDDEN":Ma(r,o),i.getLinkMetadataSharedLinkProps(a.payload.linkMetadata,200).then((t=>e({...i.getBaseCopySharedLinkProps("canceled",o,r,!1),...t},i.getFileIdOrPath(r))));break;case"SHARE_MODAL_SHARE__CREATE_LINK__COPY_SUCCESS":Ma(r,o),i.getLinkMetadataSharedLinkProps(a.payload.linkMetadata,200).then((t=>e({...i.getBaseCopySharedLinkProps("success",o,r,!1),...t},i.getFileIdOrPath(r))))}}),[t,e]))({logCopyLinkEvent:La,logCreateLinkEvent:ka}),Oa=({userApiProps:e,origin:a,actionInfo:n,children:o,platform:c=t.Platforms.METASERVER,shouldDisableImportContacts:u,apiContext:g})=>{const{user:m,isLoading:p}=i.useActiveUser(),E=Na(),h=f.default.useCallback((e=>{"TEAMS_WEB"===e.type&&i.TeamsWebActionsLogger.log(e.payload.name,e.payload.extra)}),[]),v=f.default.useMemo((()=>Ot(E,h)),[E,h]),S=(null==g?void 0:g.isNonUserRelativeContext)&&!p?null==m?void 0:m.team_member_id:void 0,A=f.default.useMemo((()=>((e,t)=>{const a=window.location.hostname;if(!Ra.test(a)&&!wa.test(a))throw new Error("Cannot initialize the SDK on an unsupported domain.");const r=new s.DropboxAuth({domain:window.location.hostname,domainDelimiter:""});return new s.Dropbox({auth:r,fetch:(a,r)=>{const n=new Headers((null==r?void 0:r.headers)||[]),i=window.location.hostname,o=e.root_ns_id;(Ra.test(i)||wa.test(i))&&n.append("X-CSRF-Token",_.readCsrfToken()||""),n.append("X-Dropbox-Uid",e.id.toString());const s=new URL(a.toString()).pathname;t&&!Ca.includes(s)?n.append(l.ApiV2HeaderNames.DropboxApiSelectAdmin,t):t&&Ca.includes(s)?n.append("X-Dropbox-Path-Root",o.toString()):null!==o&&n.append("Dropbox-API-Path-Root",JSON.stringify({".tag":"namespace_id",namespace_id:o.toString()}));const d={...r||{},headers:n};return fetch(a,d)}})})(e,S)),[e,S]),{data:y,isLoading:b,isError:T}=(()=>{const{data:e,isLoading:t,isError:a,error:r}=d.loginAndRegisterConstantsPrefetchRequest.useQuery({apiArg:null,pkgArg:null});return{data:null==e?void 0:e.apiData,isLoading:t,isError:a,error:r}})();if(b||T)return null;const I=u||null==y?void 0:y.redirectWindowToken;return f.default.createElement(Ia,{intl:r.intl,sdk:A,loggingSink:v,redirectWindowToken:I,platform:c,origin:a,actionInfo:n,apiContext:g},o)};Oa.displayName="SharingSdkProviderInternal";const xa=new Map,Da=e=>{const t=xa.get(e);if(t)return t;const a=i.getFileTypeFromString(e.split(".").slice(-1)[0]);return xa.set(e,a),a},Pa=i.defineContext(null),Fa=e=>e?"file"===e.type?{sharedObjType:"file",fileType:Da(e.name)||"unresolved",isDir:"false"}:"file_folder"===e.type?{sharedObjType:"file_folder",fileType:"folder",isDir:"true"}:"shared_folder"===e.type?{sharedObjType:"shared_folder",fileType:"folder",isDir:"true"}:i.exhausts(e,{sharedObjType:"fallthrough",fileType:"fallthrough",isDir:"fallthrough"}):{sharedObjType:"unspecified",fileType:"unspecified",isDir:"unspecified"},Ha=e=>{if(e){if("file"===e.type){const t=Da(e.name);return{sharedObjType:"file",fileType:t,fileExtension:t,isDir:!1}}return"file_folder"===e.type?{sharedObjType:"folder",isDir:!0}:"shared_folder"===e.type?{sharedObjType:"shared_folder",isDir:!0}:i.exhausts(e[".tag"],{})}return{}},$a=i.defineContext(null),Ua=e=>{var t;return e?{actionSurface:e.actionSurface,actionElement:e.actionElement,tiburonOrigin:e.tiburonOrigin,contentAction:e.contentAction,screen:e.screen.toString(),isSm24:"sm24"===(null===(t=e.shareModalType)||void 0===t?void 0:t.toString())?"true":"false"}:{actionSurface:"unspecified",actionElement:"unspecified",tiburonOrigin:"unspecified",contentAction:"unspecified",screen:"unspecified",isSm24:"unspecified"}},Va=e=>e?{actionSurface:e.actionSurface,actionElement:e.actionElement,contentAction:e.contentAction,tiburonOrigin:e.tiburonOrigin,screen:e.screen,shareModalType:e.shareModalType}:{},Ba=i.defineContext(""),za=e=>"personal"!==e.role&&!!e.is_team_member,Ga=e=>za(e)&&!!e.is_tmr_member,ja=(e,t)=>za(e)&&e.team_id===i.getOwnerTeamId(t),Wa={".tag":"viewer"},Ka={".tag":"editor"};function qa(e){return{class:"sharing_sender",action:"select",object:"flexible_sharing_entrypoint_action",properties:e}}const Ya=i.defineContext(null),Za=e=>e?i.isNewApiMetadata(e)||"file"===e[".tag"]||"file_folder"===e[".tag"]||"shared_folder"===e[".tag"]||"link_only"===e[".tag"]||"collection"===e[".tag"]?{}:i.exhausts(e[".tag"],{}):{},Ja=e=>e?i.isNewApiMetadata(e)?{contentIdentifier:e.common_metadata.file_id}:"file"===e[".tag"]?{contentIdentifier:e.id}:"file_folder"===e[".tag"]||"shared_folder"===e[".tag"]||"link_only"===e[".tag"]||"collection"===e[".tag"]?{contentIdentifier:e.folder_id}:i.exhausts(e[".tag"],{}):{},Qa=()=>{const e=Xa();return f.useMemo((()=>(null==e?void 0:e.isLoading)?{isLoading:!0}:(null==e?void 0:e.error)?{isLoading:!1,isError:!0}:{output:e.data.apiData,isLoading:!1,isError:!1}),[e])},Xa=()=>i.sharingAccountInfoPackage.useQuery({}),er=({teamName:e,parentFolderName:t,isRestoreAccessEnabled:a,onRestoreAccessClick:n})=>{const o=r.useIntl(),s=f.useCallback((()=>{n(e)}),[e,n]),_=""!==t?o.formatMessage({id:"KG/fFv",defaultMessage:"This folder isn’t shared with everyone who has access to parent folder <b>{parent}</b>."},{parent:t,b:e=>f.createElement("b",{style:{fontWeight:"var(--type__body__standard--fontweight_strong)"}},e)}):o.formatMessage({id:"kIOCH3",defaultMessage:"This folder isn’t shared with everyone on {team_name}."},{team_name:$.em_snippet(e,i.SNIPPET_SIZES.DISPLAY_NAME)}),l=o.formatMessage({id:"96XDs/",defaultMessage:"Share with everyone"});return f.createElement(i.Banner,{withLeftIcon:f.createElement(i.UIIcon,{src:i.InfoLine})},f.createElement(i.Banner.Message,null,f.createElement(i.Text,null,_,a&&" ",a&&f.createElement(i.Button,{"aria-label":l,key:"restore access",variant:"transparent",size:"medium",onClick:s,style:{fontFamily:"var(--type__body__standard--fontfamily)",fontWeight:"var(--type__body__standard--fontweight_strong)",fontSize:"var(--type__body__standard--fontsize)",letterSpacing:0}},l))))};er.displayName="ConfidentialFolderSection";const tr=e=>e.formatMessage({id:"RYuEPZ",defaultMessage:"Some of these emails aren’t on your Dropbox team."}),ar=e=>e.formatMessage({id:"c7+ulZ",defaultMessage:"This email isn’t on your Dropbox team."}),rr=e=>e.formatMessage({id:"Vp93jb",defaultMessage:"One or more of these emails is no longer active."}),nr=e=>e.formatMessage({id:"LKdcDm",defaultMessage:"Some of these emails aren’t on your Dropbox team."}),ir=e=>e.formatMessage({id:"mvBmmQ",defaultMessage:"This email isn’t on your Dropbox team."}),or=e=>e.formatMessage({id:"0IC8VF",defaultMessage:"You don’t have permission to share with some of these people."}),sr=e=>e.formatMessage({id:"8tC+2X",defaultMessage:"Only groups can be added to team folders."}),_r=e=>e.formatMessage({id:"UrkgWp",defaultMessage:"You don’t have permission to share with some of these people due to restrictions on their end."}),lr=e=>e.formatMessage({id:"S+fqGv",defaultMessage:"One or more of the emails you entered are invalid."}),dr=e=>e.formatMessage({id:"KxgNgG",defaultMessage:"Add message (optional)"}),cr=e=>e.formatMessage({id:"30bVmM",defaultMessage:"Add a note"}),ur=e=>e.formatMessage({id:"Qd1iC2",defaultMessage:"Sharing..."}),gr=(e,t)=>t?ur(e):(e=>e.formatMessage({id:"lHCrsZ",defaultMessage:"Share"}))(e),mr=(e,t)=>"editor"===t[".tag"]?(e=>e.formatMessage({id:"J3CMt1",defaultMessage:"can edit"}))(e):(e=>e.formatMessage({id:"xOIBKS",defaultMessage:"can view"}))(e),pr=e=>e.formatMessage({id:"nf2M+i",defaultMessage:"There was a problem completing this request."}),Er=e=>e.formatMessage({id:"PbG9/M",defaultMessage:"You don’t have access to this content."}),hr=e=>e.formatMessage({id:"ktVMZy",defaultMessage:"Your team settings don’t allow sharing outside your team."}),vr=e=>e.formatMessage({id:"KWUYO4",defaultMessage:"You’ve hit the limit of invites for today. Try again later."}),Sr=e=>e.formatMessage({id:"CTRWVL",defaultMessage:"You don’t have permission to do this. Contact the owner."}),Ar=e=>e.formatMessage({id:"xoQiJt",defaultMessage:"You haven’t verified your email. Check your email and try again."}),fr=e=>e.formatMessage({id:"kJSilf",defaultMessage:"Couldn’t share, but it might work if you reload the page and try again."}),yr=e=>e.formatMessage({id:"ebZyPl",defaultMessage:"You’re sharing with too many people."}),br=e=>e.formatMessage({id:"Bcojaq",defaultMessage:"Contact support"}),Tr=(e,t)=>e.formatMessage({id:"0UrAT5",defaultMessage:"Couldn’t create shared folder. Your Dropbox account is {number, plural, one{1 shared folder} other {{number} shared folders}} over the limit."},{number:t}),Ir=e=>e.formatMessage({id:"/sRvdA",defaultMessage:"Folder updates in progress — please try again later."}),Rr=(e,t)=>t?e.formatMessage({id:"1HgFQB",defaultMessage:"Couldn’t remove members. Try again."}):e.formatMessage({id:"ypun4U",defaultMessage:"Couldn’t share folder. Try sharing again."}),wr=()=>{const e=Cr();return f.useMemo((()=>(null==e?void 0:e.isLoading)?{isLoading:!0}:(null==e?void 0:e.error)?{isLoading:!1,isError:!0,error:e.error.appError}:{output:e.data.apiData,isLoading:!1,isError:!1}),[e])},Cr=()=>i.sharingPrefsPackage.useQuery({}),Mr=/^['#&A-Za-z0-9._%+-]+@[A-Za-z0-9-][A-Za-z0-9.-]*\.[A-Za-z]{2,15}$/,Lr={$props:o.atom({oid:{".tag":"file",fileId:""},objectMetadataResult:{isLoading:!0},accountMetadataResult:{isLoading:!0},sharingPrefsResult:{isLoading:!0},inviteMessage:"",inviteTargets:[],hasUpdatedAccountMetadata:!1,onCloseClick:()=>{},onTargetsDropdownFocusChange:()=>{},onInviteMessageChange:()=>{},onInviteTargetsChange:()=>{},onShareStart:()=>{},onInbandShareSuccess:()=>{},onShareFailure:()=>{},onStartInband:()=>{},onRefreshObjectMetadata:()=>{},onRefreshModal:()=>{},shouldStyleForSM21:!1,shouldTransitionAccessoryAreaEnter:!1}),$inviteTargets:o.atom([]),$inviteMessage:o.atom(""),$inviteTargetValidations:o.atom({}),$isDataBeingUpdated:o.atom(!1),$isInviteSending:o.atom(!1),$shouldPostMessageAsComment:o.atom(!1),$changeConfidentialityData:o.atom(null),$isSuggestionsOpen:o.atom(!1),$isProgressiveButtonHovered:o.atom(!1),$progressiveButtonHoverStartTime:o.atom(0),$componentViewTime:o.atom(0),$objectIdentifier:o.atom({".tag":"file",fileId:""}),$inviteTargetsWithValidEmails:o.atom([]),$inviteTargetsWithInvalidEmails:o.atom([]),$objectIdentifierId:o.atom(""),$sharingAccessLevel:o.atom(Wa),$canInviteViewer:o.atom(!1),$canInviteEditor:o.atom(!1),$isFolder:o.atom(!1),$isConfidentialFolder:o.atom(!1),$isNewFolder:o.atom(!1)},{StoreProvider:kr,useStore:Nr}=o.defineStoreProvider((e=>{const t=o.proxy((()=>e.get().inviteMessage),(t=>e.get().onInviteMessageChange(t))),a=o.proxy((()=>e.get().inviteTargets),(t=>e.get().onInviteTargetsChange(t))),r=o.proxy((()=>a.get().filter((e=>"group"===e[".tag"]||Mr.test(e.email))))),n=o.proxy((()=>a.get().filter((e=>"group"!==e[".tag"]&&!Mr.test(e.email))))),s=o.atom({}),_=o.atom(!1),l=o.atom(!1),d=o.atom(!1),c=o.atom(null),u=o.atom(!1),g=o.atom(!1),m=o.atom(0),p=o.atom(0),E=o.atom(e.get().oid),h=o.atom(b(e.get().oid)),v=o.proxy((()=>{const t=e.get().sharingPrefsResult;return t.isLoading||t.isError?null:t.output})),S=o.proxy((()=>{const t=e.get().objectMetadataResult;return t.isLoading||t.isError?null:t.output})),A=o.proxy((()=>{const e=v.get(),t=S.get();return!(!e||!t)&&i.getCanInvite(t,Ka)})),f=o.proxy((()=>{const e=v.get(),t=S.get();return!(!e||!t)&&i.getCanInvite(t,Wa)})),y=o.proxy((()=>{const e=v.get();return e&&A.get()?(e=>{const t=e.default_sharing_access_level_setting;if(!t)return i.EDITOR;switch(t[".tag"]){case i.SharingAccessLevel.VIEW:return i.VIEWER;case i.SharingAccessLevel.UNKNOWN:case i.SharingAccessLevel.EDIT:default:return i.EDITOR}})(e):Wa})),T=o.atom(y.get()),I=o.proxy((()=>{const e=S.get();return!!e&&i.getIsFolder(e)})),R=o.proxy((()=>{const e=S.get();return!!e&&i.getIsConfidentialFolder(e)})),w=o.proxy((()=>{var t;return null!==(t=e.get().isNewFolder)&&void 0!==t&&t}));return{$props:e,$inviteMessage:t,$inviteTargets:a,$inviteTargetsWithInvalidEmails:n,$inviteTargetsWithValidEmails:r,$inviteTargetValidations:s,$isDataBeingUpdated:_,$isInviteSending:l,$shouldPostMessageAsComment:d,$changeConfidentialityData:c,$isSuggestionsOpen:u,$isProgressiveButtonHovered:g,$progressiveButtonHoverStartTime:m,$componentViewTime:p,$objectIdentifier:E,$objectIdentifierId:h,$sharingAccessLevel:T,$canInviteViewer:f,$canInviteEditor:A,$isFolder:I,$isConfidentialFolder:R,$isNewFolder:w}}),Lr),Or=e=>{const t=i.useSharingObjectMetadata(e.oid),a=Qa(),r=wr();return f.createElement(kr,{objectMetadataResult:t,accountMetadataResult:a,sharingPrefsResult:r,...e})};Or.displayName="Provider";const xr="share-modal-evolution-access-level-dropdown",Dr=`${xr}__audience-text`,Pr=`${xr}__portaled-menu`,Fr=()=>{const e=r.useIntl(),t=Nr(),a=o.useAtom(t.$sharingAccessLevel),n=o.useAtom(t.$isInviteSending),s=o.useAtom(t.$canInviteEditor),_=o.useAtom(t.$canInviteViewer),l=(s?1:0)+(_?1:0),d=(()=>{const e=Pt(),t=Nr(),a=o.useAtom(t.$sharingAccessLevel);return f.useCallback((r=>{e("SHARE_MODAL_SHARE__LINK_ACCESS_LEVEL__CHANGE",{previous:a,next:{".tag":r}}),t.$sharingAccessLevel.set({".tag":r})}),[t,e,a])})();return f.createElement(i.Box,{className:i.cx([`${xr}`,l>1?`${xr}__with-menu`:void 0]),borderRadius:"Small",style:{minWidth:"auto",display:"flex",whiteSpace:"pre-wrap",flexWrap:"wrap",alignItems:"center"},"data-testid":"access-level-dropdown"},f.createElement(i.Text,{className:Dr,"data-testid":"invite-audience",color:n?"disabled":"standard",size:"small"},(e=>e.formatMessage({id:"OGm4kF",defaultMessage:"People added"}))(e)," "),1===l?f.createElement(i.Text,{className:Dr,isBold:!0,size:"small",color:n?"disabled":"standard"},mr(e,a)):f.createElement(i.Menu.Wrapper,{onSelection:d,style:{verticalAlign:"bottom",whiteSpace:"nowrap"},className:Pr},(({getContentProps:t,getTriggerProps:r})=>f.createElement(f.Fragment,null,f.createElement(i.Button,{...r(),variant:"transparent",withDropdownIcon:!0,size:"small",style:{marginTop:"1px",position:"relative"},disabled:n},mr(e,a)),f.createElement(i.Menu.Content,{"data-sharing-sdk":"1",...t(),placement:"bottom-end"},f.createElement(i.Menu.Segment,null,_?f.createElement(i.Menu.SelectItem,{key:"view",value:"viewer",selected:"editor"!==a[".tag"]},f.createElement(i.Text,null,mr(e,Wa))):null,s?f.createElement(i.Menu.SelectItem,{key:"edit",value:"editor",selected:"editor"===a[".tag"]},f.createElement(i.Text,null,mr(e,Ka))):null))))))};Fr.displayName="AccessLevelDropdown";const Hr=e=>"dropbox_id"===e[".tag"]?`DBX_ID:${e.dropbox_id}`:"email"===e[".tag"]?`EMAIL:${e.email}`:"other"===e[".tag"]?"OTHER":i.exhausts(e,"UNKNOWN"),$r=e=>e.reduce(((e,t)=>({[Hr(t.member)]:t,...e})),{}),Ur=_a({name:"sharing.validateTargets"},(e=>t=>sa(e.sharingTargetsValidate(t)))),Vr=e=>{const t=Nr(),a=(e=>{const t=Aa(Ur),a=Pt(),r=Nr();return f.useCallback((async()=>{const n=r.$inviteTargets.get();if(0===n.length)return void r.$inviteTargetValidations.set({});const o=r.$inviteTargetsWithInvalidEmails.get().reduce(((e,t)=>({...e,[j(t)]:{member:q(t),result:{".tag":"disallowed",disallowed:{".tag":"invalid_target"}},target_invite_eligibility:{".tag":"other"}}})),{});if(r.$inviteTargetValidations.set({...r.$inviteTargetValidations.get(),...o}),0===r.$inviteTargetsWithValidEmails.get().length)return;const s=Object.values(r.$inviteTargetValidations.get()).map((e=>e?Hr(e.member):null)),_=r.$inviteTargetsWithValidEmails.get().filter((e=>{const t=Hr(q(e));return!s.includes(t)}));if(0===_.length)return;const l=i.getIsFile(e)?"file":"folder",d=r.$objectIdentifierId.get();a("SHARE_MODAL_SHARE__PREVALIDATION__API_START",null);const c=await t({access_level:r.$sharingAccessLevel.get(),content_id:d,content_type:{".tag":l},members:_.map(q)});if("ERROR"===c.status)return void a("SHARE_MODAL_SHARE__PREVALIDATION__API_ERROR",{error:c.error});if("FATAL"===c.status)return void a("SHARE_MODAL_SHARE__PREVALIDATION__API_FATAL",{error:c.error});a("SHARE_MODAL_SHARE__PREVALIDATION__API_SUCCESS",null);const u=r.$inviteTargets.get(),g=r.$sharingAccessLevel.get(),m=e,p=b(r.$objectIdentifier.get());n===u&&r.$sharingAccessLevel.get()===g&&d===p&&e===m&&r.$inviteTargetValidations.set({...r.$inviteTargetValidations.get(),...$r(c.output.results)})}),[r,t,a,e])})(e);f.useEffect((()=>{const e=[t.$inviteTargets.obs(a),t.$sharingAccessLevel.obs((()=>{a()})),t.$objectIdentifierId.obs((()=>{t.$inviteTargetValidations.set({}),a()}))];return t.$props.get().inviteTargets.length>0&&a(),()=>e.forEach((e=>e()))}),[])},Br="sharing-notification",zr=e=>{qr(),i.Snackbar.complete(e,Br)},Gr=({title:e,onUndoClick:t})=>{qr(),i.Snackbar.completeWithUndo(e,t,Br,{timeoutDelayMs:2e4})},jr=e=>{i.Snackbar.close(),i.Snackbar.fail(e,Br)},Wr=({intl:e,title:t,onHelpButtonClick:a,helpButtonText:r})=>{const n=r||Yr(e);qr(),i.Snackbar.show(f.default.createElement(i.Snackbar,{title:t,actionButtonText:n,onActionClick:a,variant:"fail",id:Br}))},Kr=e=>{qr(),i.Snackbar.sync(e,!0,Br)},qr=()=>i.Snackbar.close(Br),Yr=e=>e.formatMessage({id:"b0sjjf",defaultMessage:"Learn more"}),Zr=(e,t)=>({options:e,useAction:t}),Jr=(e,t)=>({success:!1,type:e,value:t}),Qr=(e,t)=>({success:!0,type:e,value:t}),Xr=e=>({success:!1,type:"TypeExhaustion",value:{value:e}}),en=e=>({success:!1,type:"UncaughtException",value:{error:e}}),tn=e=>{const t=e.options.name,a=e.useAction(),r=Pt();return f.useCallback((async e=>{let n;r("ACTION__START",{name:t,input:e});try{n=await a(e)}catch(e){n=en(e)}return r("ACTION__COMPLETE",{name:t,input:e,output:n}),n}),[r,a,t])},an=_a({name:"sharing.set_access_inheritance"},(e=>t=>sa(e.sharingSetAccessInheritance(t)))),rn=(e,t)=>{const a=(null==t?void 0:t.timeout)||1e4,r=(null==t?void 0:t.interval)||1e3;return new Promise((t=>{const n=setTimeout((()=>t({status:"TIMEOUT"})),a),i=async()=>{try{const a=await e();if("COMPLETE"===a.status)return clearTimeout(n),void t(a);setTimeout(i,r)}catch(e){clearTimeout(n),t({status:"ERROR",error:e})}};i()}))},nn=_a({name:"sharing.checkShareInternalJobStatus"},(e=>t=>sa(e.sharingCheckShareInternalJobStatus(t)))),on=Zr({name:"CheckSetAccessInheritanceJobStatus"},(()=>{const e=Aa(nn);return f.useCallback((async({asyncJobId:t})=>{const a=await e({async_job_id:t});return"FATAL"===a.status?Jr("NetworkFailure",{response:a}):"ERROR"===a.status?Jr("ApiError",{response:a}):"in_progress"===a.output[".tag"]?Qr("InProgress",{response:{...a,output:a.output}}):"failed"===a.output[".tag"]?Jr("Failed",{response:{...a,output:a.output}}):"complete"===a.output[".tag"]?Qr("Complete",{response:{...a,output:a.output}}):Xr(a.output)}),[e])})),sn=Zr({name:"PollCheckSetAccessInheritanceJobStatus"},(()=>{const e=tn(on);return f.useCallback((async({asyncJobId:t,timeout:a,interval:r})=>{const n=await rn((async()=>{const a=await e({asyncJobId:t});return"InProgress"===a.type?{status:"RETRY"}:{status:"COMPLETE",output:a}}),{timeout:a,interval:r});return"TIMEOUT"===n.status?Jr("Timeout",null):"ERROR"===n.status?en(n.error):n.output.success?Qr("Complete",n.output.value):n.output}),[e])})),_n=Zr({name:"SetAccessInheritance"},(()=>{const e=Aa(an),t=tn(sn);return f.useCallback((async({setAccessInheritanceArg:a,timeout:r,interval:n})=>{const i=await e(a);if("ERROR"===i.status)return Jr("ApiError",{response:i});if("FATAL"===i.status)return Jr("NetworkFailure",{response:i});if("complete"===i.output[".tag"])return Qr("Complete",{response:{...i,output:i.output}});if("async_job_id"!==i.output[".tag"])return Xr(i.output);const o=await t({asyncJobId:i.output.async_job_id,timeout:r,interval:n});return o.success?Qr("PollingComplete",o.value):"ApiError"===o.type?Jr("PollingApiError",o.value):"NetworkFailure"===o.type?Jr("PollingNetworkFailure",o.value):"Failed"===o.type?Jr("PollingFailed",o.value):"Timeout"===o.type?Jr("PollingTimeout",o.value):o}),[e,t])})),ln=_a({name:"sharing.share_folder"},(e=>t=>sa(e.sharingAlphaShareFolder(t)))),dn=Zr({name:"CheckShareFileFolderJobStatus"},(()=>{const e=Aa(nn);return f.useCallback((async({asyncJobId:t})=>{const a=await e({async_job_id:t});return"FATAL"===a.status?Jr("NetworkFailure",{response:a}):"ERROR"===a.status?Jr("ApiError",{response:a}):"in_progress"===a.output[".tag"]?Qr("InProgress",{response:{...a,output:a.output}}):"failed"===a.output[".tag"]?Jr("Failed",{response:{...a,output:a.output}}):"complete"===a.output[".tag"]?Qr("Complete",{response:{...a,output:a.output}}):Xr(a.output)}),[e])})),cn=Zr({name:"PollCheckShareFileFolderJobStatus"},(()=>{const e=tn(dn);return f.useCallback((async({asyncJobId:t,timeout:a,interval:r})=>{const n=await rn((async()=>{const a=await e({asyncJobId:t});return"InProgress"===a.type?{status:"RETRY"}:{status:"COMPLETE",output:a}}),{timeout:a,interval:r});return"TIMEOUT"===n.status?Jr("Timeout",null):"ERROR"===n.status?en(n.error):n.output.success?Qr("Complete",n.output.value):n.output}),[e])})),un=Zr({name:"ShareFileFolder"},(()=>{const e=Aa(ln),t=tn(cn);return f.useCallback((async({path:a,confidentiality:r,timeout:n,interval:i})=>{const o=await e({path:a,confidentiality:r});if("ERROR"===o.status)return Jr("ApiError",{response:o});if("FATAL"===o.status)return Jr("NetworkFailure",{response:o});if("complete"===o.output[".tag"])return Qr("Complete",{response:{...o,output:o.output}});if("async_job_id"!==o.output[".tag"])return Xr(o.output);const s=await t({asyncJobId:o.output.async_job_id,timeout:n,interval:i});return s.success?Qr("PollingComplete",s.value):"ApiError"===s.type?Jr("PollingApiError",s.value):"NetworkFailure"===s.type?Jr("PollingNetworkFailure",s.value):"Failed"===s.type?Jr("PollingFailed",s.value):"Timeout"===s.type?Jr("PollingTimeout",s.value):s}),[e,t])})),gn=_a({name:"sharing.addFileMember"},(e=>t=>sa(e.sharingAddFileMember(t)))),mn=_a({name:"sharing.addFolderMember"},(e=>t=>sa(e.sharingAddFolderMemberV2(t))));function pn(e){return{class:"sharing_sender",action:"initiate",object:"post_share_action",properties:e}}const En=Symbol("ON_SHOW_ADMIN_INVITE_AFTER_SHARING_MODAL"),hn=Symbol("ON_SHOW_MEMBER_INVITE_AFTER_SHARING_MODAL"),{useEmitter:vn,defaultEmitter:Sn}=i.defineLogger((async({event:e,getContextValue:t})=>{const a=t($a),r=t(Pa),n=t(Ya),o={...Ua(a),...Fa(r),...Za(n),isSm24:"true"};e.key!==En?e.key!==hn||i.UDCL.logEvent(pn({postShareAction:"member_invite_after_sharing_modal",numInviteEligibleUsers:e.payload.numInviteEligibleUsers}),{tags:o}):i.UDCL.logEvent(pn({postShareAction:"admin_invite_after_sharing_modal",numInviteEligibleUsers:e.payload.numInviteEligibleUsers}),{tags:o})})),An=()=>{const t=i.useGetContextValue(),a=vn();return f.useCallback((async r=>{var n,o;bn(r.objectIdentifier,r.objectMetadata),r.user&&i.markMilestoneAsCompleted(r.user,u.ActivationTileMilestoneId.SHARE_CONTENT);const{inviteEligibleNotSeenContacts:s,inviteEligibleSeenContacts:_,inviteEligibleSeenResurfaceContacts:l}=yn(r.inviteTargets,r.targetsValidateResult),d=V(s,_,l),c=null===(n=r.sharingPrefs.invite_after_sharing_modal_variant)||void 0===n?void 0:n[".tag"];if(c&&z(s,l,c)){const n=null===(o=t($a))||void 0===o?void 0:o.tiburonOrigin;if("admin_invite_expand_eligibility"===c)if(1===d.length){const e=Date.now();fn().then((t=>{a.select(En).emit({numInviteEligibleUsers:d.length}),t({eligibleUsers:d,adminModalVariant:c,modalOrigin:n,modalLoadingStartTime:e})}))}else{const e=Date.now();fn().then((t=>{a.select(En).emit({numInviteEligibleUsers:d.length}),t({eligibleUsers:d,adminModalVariant:c,modalOrigin:n,modalLoadingStartTime:e})}))}else if(B(c)){const t=Date.now(),i=r.sharingPrefs.num_available_licenses;(async function(){const{showMemberInviteAfterSharingModal:t}=await new Promise((function(t,a){e(["./c_modals_invite_after_sharing_member_invite_after_sharing_modal"],t,a)}));return t})().then((e=>{a.select(hn).emit({numInviteEligibleUsers:d.length}),e({eligibleUsers:d,memberModalVariant:c,sharingOrigin:n,modalLoadingStartTime:t,numAvailableLicenses:i})}))}}}),[t,a])};async function fn(){const{showAdminInviteAfterSharingModal:t}=await new Promise((function(t,a){e(["./c_modals_invite_after_sharing_admin_invite_after_sharing_modal"],t,a)}));return t}const yn=(e,t)=>{const a=Object.fromEntries(e.map((e=>[j(e),e]))),r=[],n=[],i=[];for(const e of t.results){const t=Hr(e.member);a.hasOwnProperty(t)&&("eligible_not_seen"===e.target_invite_eligibility[".tag"]?r.push(a[t]):"eligible_seen"===e.target_invite_eligibility[".tag"]?n.push(a[t]):"eligible_seen_resurface"===e.target_invite_eligibility[".tag"]&&i.push(a[t]))}return{inviteEligibleNotSeenContacts:r.map((e=>ot(e))),inviteEligibleSeenContacts:n.map((e=>ot(e))),inviteEligibleSeenResurfaceContacts:i.map((e=>ot(e)))}},bn=(e,t)=>{if(i.getIsFile(t)){const t=[b(e)];g.getStoreForSharedWith().dispatch(g.sharedFileDataOutOfDate(t))}else g.getStoreForSharedWith().dispatch(g.sharedFolderDataOutOfDate())},Tn=["access_denied","path","not_found","email_not_verified","settings_error","not_authorized","undefined_error","banned_member","failed_copy_to_clipboard","invalid_logged_out_cookie","internal_error","other","contacts_error","rate_limit","bad_member","access_error","cant_share_outside_team","no_permission","too_many_invitees","invalid_csrf_token","invalid","user_not_logged_in","too_many_files","total_mounts_exceeded","home_mounts_exceeded","tree_size_exceeded","invalid_shared_folder","invalid_comment","team_policy_disallows_member_policy","disallowed_shared_link_policy","insufficient_plan","invalid_email","network","team_folder","too_many_members","too_many_pending_invites","already_shared"];function In(e){return Tn.find((t=>t===(null==e?void 0:e.toLowerCase())))}const Rn=Symbol("ON_IMMEDIATE_TRANSITION"),wn=Symbol("ON_INVITE__START"),Cn=Symbol("ON_ADD_FILE_MEMBER_API_ERROR"),Mn=Symbol("ON_ADD_FILE_MEMBER_API_FATAL"),Ln=Symbol("ON_ADD_FILE_MEMBER_API_SUCCESS"),kn=Symbol("ON_SHARE_FILE_FOLDER_FAILURE"),Nn=Symbol("ON_SHARE_FILE_FOLDER_FAILURE_CONTINUE"),On=Symbol("ON_ADD_FOLDER_MEMBER_API_ERROR"),xn=Symbol("ON_ADD_FOLDER_MEMBER_API_FATAL"),Dn=Symbol("ON_ADD_FOLDER_MEMBER_API_SUCCESS"),{useEmitter:Pn,defaultEmitter:Fn}=i.defineLogger((async({event:e,getContextValue:t})=>{const a=t($a),r=t(Pa),n=t(Ya),o=i.getShareModalTypeFromString("sm24"),s={...Ua(a),...Fa(r),...Za(n)},_={...Va(a),...Ha(r),...Ja(n)};if(e.key!==wn)if(e.key!==Ln&&e.key!==Dn)if(e.key!==Mn&&e.key!==xn){if(e.key===kn){const t=In(u.inbandShareResponseToErrorEnum[e.payload.error])||"undefined_error";return i.UDCL.logEnd(u.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:e.payload.isNewFolder,shareInviteErrorReason:t,fromNotifyInherited:!1,eventState:"failed",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir,screen:_.screen}),{tags:{...s,errorReason:t},eventState:"failed",key:e.payload.actionKey}),void i.UDCL.logEvent("ops.sm24.share_file_folder_failure",{tags:{...s,errorReason:e.payload.error}})}if(e.key!==Nn){if(e.key===On){const t=In(u.inbandShareResponseToErrorEnum[e.payload.error])||"undefined_error";return i.UDCL.logEnd(u.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:e.payload.isNewFolder,shareInviteErrorReason:t,fromNotifyInherited:!1,eventState:"failed",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir,screen:_.screen}),{tags:{...s,errorReason:t},eventState:"failed",key:e.payload.actionKey}),void i.UDCL.logEvent("ops.sm24.add_folder_member_api_failure",{tags:{...s,errorReason:e.payload.error}})}if(e.key===Cn){const t=In(u.inbandShareResponseToErrorEnum[e.payload.error])||"undefined_error";return i.UDCL.logEnd(u.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:e.payload.isNewFolder,shareInviteErrorReason:t,fromNotifyInherited:!1,eventState:"failed",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir,screen:_.screen}),{tags:{...s,errorReason:t},eventState:"failed",key:e.payload.actionKey}),void i.UDCL.logEvent("ops.sm24.add_file_member_api_failure",{tags:{...s,errorReason:e.payload.error}})}if(e.key!==Rn)return i.exhausts(e,void 0);i.UDCL.logEvent(qa({..._,flexibleSharingEntryPointAction:"inband_immediate",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...s,action:"inband_immediate"}})}else i.UDCL.logEvent("ops.sm24.share_file_folder_failure",{tags:{...s,errorReason:e.payload.error}})}else i.UDCL.logEnd(u.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:e.payload.isNewFolder,shareInviteErrorReason:"network",fromNotifyInherited:!1,eventState:"failed",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir,screen:_.screen}),{tags:{...s,errorReason:"network"},eventState:"failed",key:e.payload.actionKey});else i.UDCL.logEnd(u.PAP_Send_ShareInvite({validationTraceId:void 0,numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:e.payload.isNewFolder,fromNotifyInherited:!1,sckeySha1:e.payload.sckeySha1,eventState:"success",shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir,screen:_.screen}),{tags:s,eventState:"success",key:e.payload.actionKey});else i.UDCL.logStart(u.PAP_Send_ShareInvite({numRecipients:e.payload.numRecipients,inbandAccessLevel:e.payload.accessLevel,isNewFolder:e.payload.isNewFolder,fromNotifyInherited:!1,shareModalType:o,actionElement:s.actionElement,actionSurface:s.actionSurface,isDir:"true"===s.isDir,screen:_.screen}),{tags:s,key:e.payload.actionKey})})),Hn=e=>{const t=Nr(),a=o.useAtom(t.$inviteTargets),n=o.useAtom(t.$inviteTargetValidations),s=r.useIntl(),_=Pt();return f.useMemo((()=>{let t=null;const r=Object.values(n).reduce(((e,t)=>"allowed"===t.result[".tag"]&&"outside_of_team"===t.result.allowed[".tag"]||"disallowed"===t.result[".tag"]&&"outside_of_team"===t.result.disallowed[".tag"]?e+1:e),0);for(const o of a){const a=j(o),l=n[a];if(l)if("disallowed"===l.result[".tag"]){const a=l.result.disallowed[".tag"];if("invalid_target"===a){t={level:"error",message:lr(s)};break}if("invalid_member"===a){t={level:"error",message:rr(s)};break}"outside_of_team"===a?t={level:"error",message:r>1?nr(s):ir(s)}:"no_permission"===a?t=e&&i.getIsCollection(e)&&"group"===o[".tag"]?{level:"error",message:s.formatMessage({id:"vLSoUY",defaultMessage:"Collection sharing for groups is currently not supported"})}:{level:"error",message:or(s)}:"target_is_individual"===a?t={level:"error",message:sr(s)}:"target_not_same_team_restricted"===a?t={level:"error",message:_r(s)}:(_("SHARE_MODAL_SHARE__PREVALIDATION__UNKNOWN_TAG",{value:a}),t={level:"error",message:lr(s)})}else if(!t&&"allowed"===l.result[".tag"]){const e=l.result.allowed[".tag"];if("no_warning"===e)continue;"outside_of_team"===e?t=t||{level:"warn",message:r>1?tr(s):ar(s)}:_("SHARE_MODAL_SHARE__PREVALIDATION__UNKNOWN_TAG",{value:e})}}return t}),[_,s,a,n,e])},$n=(e,t)=>{const a=Nr(),n=r.useIntl(),s=Qt(),_=Pt(),l=Aa(gn),d=Aa(mn),u=Aa(Ur),g=tn(un),m=(()=>{const e=r.useIntl();return f.useCallback((t=>"access_error"===t.error[".tag"]?(jr(Er(e)),t.error[".tag"]):"user_error"===t.error[".tag"]&&"email_unverified"===t.error.user_error[".tag"]?(jr(Ar(e)),t.error.user_error[".tag"]):"invalid_comment"===t.error[".tag"]?(jr(pr(e)),t.error[".tag"]):"rate_limit"===t.error[".tag"]?(jr(vr(e)),t.error[".tag"]):(t.error[".tag"],jr(pr(e)),t.error[".tag"])),[e])})(),p=(()=>{const e=r.useIntl(),t=Qt();return f.useCallback((a=>"NetworkFailure"!==a.type&&"PollingNetworkFailure"!==a.type||429!==a.value.response.statusCode?"ApiError"===a.type&&"email_unverified"===a.value.response.error[".tag"]?(jr(Ar(e)),a.value.response.error[".tag"]):"ApiError"===a.type&&"no_permission"===a.value.response.error[".tag"]?(jr(Sr(e)),a.value.response.error[".tag"]):"ApiError"!==a.type||"too_many_mounts"!==a.value.response.error[".tag"]||"tree_size_exceeded"!==a.value.response.error.too_many_mounts[".tag"]&&"home_mounts_exceeded"!==a.value.response.error.too_many_mounts[".tag"]&&"total_mounts_exceeded"!==a.value.response.error.too_many_mounts[".tag"]?"ApiError"===a.type&&"bad_path"===a.value.response.error[".tag"]&&"already_shared"===a.value.response.error.bad_path[".tag"]?a.value.response.error.bad_path[".tag"]:"PollingApiError"===a.type&&"internal_error"===a.value.response.error[".tag"]?(Wr({intl:e,title:fr(e),onHelpButtonClick:()=>t("/support"),helpButtonText:br(e)}),a.value.response.error[".tag"]):(jr(pr(e)),"PollingTimeout"===a.type?"network":"PollingFailed"===a.type?"failed":"ApiError"===a.type||"PollingApiError"===a.type?a.value.response.error[".tag"]:"undefined"):(Wr({intl:e,title:Tr(e,a.value.response.error.too_many_mounts.limit-a.value.response.error.too_many_mounts.current_count),onHelpButtonClick:()=>t("https://help.dropbox.com/files-folders/share/shared-folder-faq#cantcreate")}),a.value.response.error.too_many_mounts[".tag"]):(Wr({intl:e,title:Ir(e),onHelpButtonClick:()=>t("/help/9259")}),"network")),[e,t])})(),E=(()=>{const e=r.useIntl();return f.useCallback((t=>"access_error"===t.error[".tag"]?(jr(Er(e)),t.error[".tag"]):"email_unverified"===t.error[".tag"]?(jr(Ar(e)),t.error[".tag"]):"bad_member"===t.error[".tag"]?(jr((e=>e.formatMessage({id:"ccjg/d",defaultMessage:"You entered an invalid name or email address."}))(e)),t.error[".tag"]):"cant_share_outside_team"===t.error[".tag"]?(jr(hr(e)),t.error[".tag"]):"too_many_members"===t.error[".tag"]||"too_many_pending_invites"===t.error[".tag"]?(jr(yr(e)),t.error[".tag"]):"insufficient_plan"===t.error[".tag"]?(jr((e=>e.formatMessage({id:"A35Dw0",defaultMessage:"You need to upgrade your account to do this."}))(e)),t.error[".tag"]):"team_folder"===t.error[".tag"]?(jr(hr(e)),t.error[".tag"]):"no_permission"===t.error[".tag"]?(jr(Sr(e)),t.error[".tag"]):"rate_limit"===t.error[".tag"]?(jr(vr(e)),t.error[".tag"]):(jr(pr(e)),t.error[".tag"])),[e])})(),h=Pn(),{user:v}=i.useActiveUser(),S=An(),A=o.useAtom(a.$sharingAccessLevel),y=Hn(e),{getVisitorData:T}=c.useAbuseFpjsContext();return f.useCallback((async()=>{if(a.$isInviteSending.get())return;const r=a.$objectIdentifier.get(),o=a.$inviteTargets.get(),c=A[".tag"],I=a.$isNewFolder.get(),R={numRecipients:o.length,accessLevel:"viewer"===c?"view":"edit",actionKey:Math.random().toString(),isNewFolder:I};if(_("SHARE_MODAL_SHARE__INVITE__START",null),h.select(wn).emit(R),a.$props.get().onShareStart(null),a.$isInviteSending.set(!0),a.$inviteTargetsWithInvalidEmails.get().length>0)return;_("SHARE_MODAL_SHARE__INVITE__VALIDATION_API_START",null);const w=b(r),C=await u({members:a.$inviteTargetsWithValidEmails.get().map(q),content_type:{".tag":"file"===r[".tag"]?"file":"file_folder"===r[".tag"]?"folder":"shared_folder"},access_level:{".tag":c},content_id:w});if("ERROR"===C.status&&_("SHARE_MODAL_SHARE__INVITE__VALIDATION_API_ERROR",{error:C.error}),"FATAL"===C.status&&_("SHARE_MODAL_SHARE__INVITE__VALIDATION_API_FATAL",{error:C.error}),"SUCCESS"===C.status&&(_("SHARE_MODAL_SHARE__INVITE__VALIDATION_API_SUCCESS",null),a.$inviteTargetValidations.set($r(C.output.results))),y&&"error"===y.level)return _("SHARE_MODAL_SHARE__INVITE__CANCELLED",null),void a.$isInviteSending.set(!1);const M=e=>(_("SHARE_MODAL_SHARE__INVITE__NAVIGATE_ATTEMPT",null),e.preventDefault(),e.returnValue="",""),L=()=>{_("SHARE_MODAL_SHARE__INVITE__NAVIGATE_AWAY",null)};a.$props.get().onShareStart(null),window.addEventListener("beforeunload",M),window.addEventListener("unload",L);const k=()=>{a.$isInviteSending.set(!1),window.removeEventListener("beforeunload",M),window.removeEventListener("unload",L),a.$props.get().onShareFailure(null)},N=a.$props.get().inviteMessage,O=a.$shouldPostMessageAsComment.get(),x=(null==v?void 0:v.email)||"";if("file"===r[".tag"]){const e=await T("INBAND_SHARE_MODAL_FILE",x);_("SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_START",null);const t=await l({access_level:{".tag":c},file:w,members:o.map(q),custom_message:N,add_message_as_comment:O&&N.length>0,fp_sealed_result:e.sealedResult});if("ERROR"===t.status){_("SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_ERROR",{response:t});const e=m(t);return h.select(Cn).emit({...R,error:e}),void k()}if("FATAL"===t.status)return _("SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_FATAL",{response:t}),h.select(Mn).emit(R),k(),void Wr({intl:n,title:fr(n),onHelpButtonClick:()=>s("/support"),helpButtonText:br(n)});_("SHARE_MODAL_SHARE__INVITE__ADD_FILE_MEMBER_API_SUCCESS",{response:t});const a=t.output[0]&&t.output[0].sckey_sha1&&t.output[0].sckey_sha1;h.select(Ln).emit({...R,sckeySha1:a})}if("file_folder"===r[".tag"]||"shared_folder"===r[".tag"]||"collection"===r[".tag"]){let t="file_folder"===r[".tag"]?"":"collection"===r[".tag"]?r.nsId:r.sharedFolderId;if("file_folder"===r[".tag"]){_("SHARE_MODAL_SHARE__INVITE__SHARE_FILE_FOLDER__START",null);const a=await g({path:r.path,timeout:12e4,interval:1e3});if(a.success)t=a.value.response.output.shared_folder_id;else{if("ApiError"!==a.type||"bad_path"!==a.value.response.error[".tag"]||"already_shared"!==a.value.response.error.bad_path[".tag"]){k(),_("SHARE_MODAL_SHARE__INVITE__SHARE_FILE_FOLDER__FAILURE",{output:a});const e=p(a);return void h.select(kn).emit({...R,error:e})}{t=a.value.response.error.bad_path.shared_folder_id;const e=p(a);h.select(Nn).emit({...R,error:e})}}_("SHARE_MODAL_SHARE__INVITE__SHARE_FILE_FOLDER__SUCCESS",null),await i.invalidateSharingObjectMetadata(r),i.isNewApiMetadata(e)&&await i.invalidateNewApiObjectMetadata(r)}const a=await T("INBAND_SHARE_MODAL_FOLDER",x);_("SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_START",null);const s=await d({shared_folder_id:t,...{...N?{custom_message:N}:{}},members:o.map((e=>({access_level:{".tag":c},member:q(e)}))),fp_sealed_result:a.sealedResult});if("ERROR"===s.status){_("SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_ERROR",{response:s});const e=E(s);return h.select(On).emit({...R,error:e}),void k()}if("FATAL"===s.status)return _("SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_FATAL",{response:s}),h.select(xn).emit(R),k(),void jr(fr(n));_("SHARE_MODAL_SHARE__INVITE__ADD_FOLDER_MEMBER__API_SUCCESS",{response:s});const l={".tag":"shared_folder",sharedFolderId:t,fileId:r.fileId};await i.invalidateObjectMembers(l),await i.invalidateSharingObjectMetadata(l);const u=void 0;h.select(Dn).emit({...R,sckeySha1:u})}a.$isInviteSending.set(!1),window.removeEventListener("beforeunload",M),window.removeEventListener("unload",L),zr(((e,t)=>e.formatMessage({id:"lvjqTm",defaultMessage:"Shared <st>{name}</st>."},{st:e=>f.createElement("strong",{key:i.getName(t)},e),name:$.em_snippet(i.getName(t),i.SNIPPET_SIZES.FILENAME)}))(n,e)),a.$props.get().onInbandShareSuccess(null),"SUCCESS"===C.status&&S({objectMetadata:e,objectIdentifier:r,inviteTargets:o,targetsValidateResult:C.output,sharingPrefs:t,user:v})}),[a,l,u,d,g,n,_,m,p,E,h,S,s,v,y,e,t,A])},Un=e=>{const t=r.useIntl(),a=Pt(),n=Nr(),{onRefreshModal:s,onRefreshObjectMetadata:_}=o.useAtom(n.$props);return f.useCallback((async(r,n,o,l,d=!1)=>{d?await s():await _();const c=((e,t,a)=>{const r=i.getName(a),n=i.getParentFolderName(a);return t?e.formatMessage({id:"7POTZF",defaultMessage:"Members removed from <strong>{folderName}</strong>."},{folderName:$.em_snippet(r,i.SNIPPET_SIZES.FOLDER_NAME),strong:e=>f.createElement("strong",null,e)}):void 0===n||""===n?e.formatMessage({id:"nni9pE",defaultMessage:"<strong>{folderName}</strong> shared with everyone."},{folderName:$.em_snippet(r,i.SNIPPET_SIZES.FOLDER_NAME),strong:e=>f.createElement("strong",null,e)}):e.formatMessage({id:"qvP8A+",defaultMessage:"<strong>{folderName}</strong> shared with members of <strong>{parentFolderName}</strong>."},{folderName:$.em_snippet(r,i.SNIPPET_SIZES.FOLDER_NAME),parentFolderName:$.em_snippet(n,i.SNIPPET_SIZES.FOLDER_NAME),strong:e=>f.createElement("strong",null,e)})})(t,n,e);o?Gr({title:c,onUndoClick:()=>null==l?void 0:l(r)}):zr(c),a("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_CONFIDENTIALITY__FINISH",null)}),[t,a,e,s,_])},Vn=e=>{const t=r.useIntl(),a=Nr(),n=Pt(),o=tn(_n),s=tn(un),_=Un(e);return f.useCallback((async(r,l,d,c)=>{if("shared_folder"!==r[".tag"]&&"file_folder"!==r[".tag"])return;n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_CONFIDENTIALITY__START",null),Kr(((e,t,a)=>{const r=i.getName(a),n=i.getParentFolderName(a);return t?e.formatMessage({id:"5xCeTo",defaultMessage:"Removing members from <strong>{folderName}</strong>…"},{folderName:$.em_snippet(r,i.SNIPPET_SIZES.FOLDER_NAME),strong:e=>f.createElement("strong",null,e)}):""===n?e.formatMessage({id:"90I244",defaultMessage:"Sharing <strong>{folderName}</strong> with everyone…"},{folderName:$.em_snippet(r,i.SNIPPET_SIZES.FOLDER_NAME),strong:e=>f.createElement("strong",null,e)}):e.formatMessage({id:"16RnmU",defaultMessage:"Sharing <strong>{folderName}</strong> with members of <strong>{parentFolderName}</strong>…"},{folderName:$.em_snippet(r,i.SNIPPET_SIZES.FOLDER_NAME),parentFolderName:$.em_snippet(n,i.SNIPPET_SIZES.FOLDER_NAME),strong:e=>f.createElement("strong",null,e)})})(t,l,e));let u=r;if("file_folder"===u[".tag"]){n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_START",null);const o=await s({path:u.path,confidentiality:l?{".tag":"confidential"}:{".tag":"not_confidential"},timeout:12e4,interval:1e3});if(o.success)return n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_SUCCESS",null),u={".tag":"shared_folder",sharedFolderId:o.value.response.output.shared_folder_id,fileId:r.fileId},a.$objectIdentifier.set(u),i.isNewApiMetadata(e)&&await i.invalidateNewApiObjectMetadata(r),_(u,l,d,c),void i.invalidateObjectMembers(u);if("ApiError"!==o.type||"bad_path"!==o.value.response.error[".tag"]||"already_shared"!==o.value.response.error.bad_path[".tag"])return n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_FAILURE",null),void jr(Rr(t,l));n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_SUCCESS",null),u={".tag":"shared_folder",sharedFolderId:o.value.response.error.bad_path.shared_folder_id,fileId:r.fileId},a.$objectIdentifier.set(u),i.isNewApiMetadata(e)&&await i.invalidateNewApiObjectMetadata(r),n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SHARE_FILE_FOLDER__API_SUCCESS",null)}n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_ACCESS_INHERITANCE__API_START",null);if(!(await o({setAccessInheritanceArg:{access_inheritance:l?{".tag":"no_inherit"}:{".tag":"inherit"},shared_folder_id:u.sharedFolderId},timeout:12e4,interval:1e3})).success)return n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_ACCESS_INHERITANCE__API_FAILURE",null),void jr(Rr(t,l));n("SHARE_MODAL_SHARE__CHANGE_CONFIDENTIALITY__SET_ACCESS_INHERITANCE__API_SUCCESS",null),_(u,l,d,c,!0),i.invalidateObjectMembers(u)}),[t,n,e,_,o,s,a.$objectIdentifier])},Bn=(e,t,a)=>a?((e,t)=>e.formatMessage({id:"6jTcuT",defaultMessage:"Share with {teamName}"},{teamName:$.em_snippet(t,i.SNIPPET_SIZES.DISPLAY_NAME)}))(e,t):(e=>e.formatMessage({id:"P5jM9e",defaultMessage:"Share"}))(e),zn=(e,t,a,r,n)=>n?((e,t,a)=>e.formatMessage({id:"ipUgQi",defaultMessage:"Share <b>{folderName}</b> with everyone at {teamName}?"},{folderName:$.em_snippet(t,i.SNIPPET_SIZES.FOLDER_NAME),teamName:$.em_snippet(a,i.SNIPPET_SIZES.DISPLAY_NAME),b:e=>f.createElement("b",{style:{fontWeight:"var(--type__title__standard--fontweight_strong)"}},e)}))(e,a,t):((e,t,a)=>e.formatMessage({id:"znRNbl",defaultMessage:"Share <b>{folderName}</b> with everyone who can access <b>{parentFolderName}</b>?"},{folderName:$.em_snippet(t,i.SNIPPET_SIZES.FOLDER_NAME),parentFolderName:$.em_snippet(a,i.SNIPPET_SIZES.FOLDER_NAME),b:e=>f.createElement("b",{style:{fontWeight:"var(--type__title__standard--fontweight_strong)"}},e)}))(e,a,r),Gn=(e,t,a,r,n)=>n?((e,t,a)=>e.formatMessage({id:"R8xJiq",defaultMessage:"<b>{folderName}</b> won’t be shared privately any more. Everyone at {teamName} will have access to this folder."},{folderName:t,teamName:a,b:e=>f.createElement("b",{style:{fontWeight:"var(--type__body__standard--fontweight_strong)"}},e)}))(e,a,t):((e,t)=>e.formatMessage({id:"ioGEl6",defaultMessage:"Everyone who can access <b>{parentFolderName}</b> will be able to access this folder."},{parentFolderName:t,b:e=>f.createElement("b",{style:{fontWeight:"var(--type__body__standard--fontweight_strong)"}},e)}))(e,r),jn=({objectMetadata:e})=>{const t=r.useIntl(),a=Nr(),n=o.useAtom(a.$changeConfidentialityData),s=(()=>{const e=Nr();return f.useCallback((()=>{e.$changeConfidentialityData.set(null)}),[e])})(),_=(e=>{const t=Nr(),a=o.useAtom(t.$objectIdentifier),r=Vn(e);return f.useCallback((async e=>r(a,e,!0,(async t=>r(t,!e,!1)))),[a,r])})(e);if(!n)return null;const l=i.getName(e),d=i.getParentFolderName(e),c=""===d,u=Bn(t,n.teamName,c),g=zn(t,n.teamName,l,d,c),m=Gn(t,n.teamName,l,d,c);return f.createElement(f.Fragment,null,f.createElement(i.Modal$1,{open:!0,isCentered:!0,withCloseButton:"Close",onRequestClose:s},f.createElement(i.Modal$1.Header,{"data-sharing-sdk":"1",hasBottomSpacing:"title-standard"},f.createElement(i.Modal$1.Title,null,g)),f.createElement(i.Modal$1.Body,{"data-sharing-sdk":"1"},m),f.createElement(i.Modal$1.Footer,{"data-sharing-sdk":"1"},f.createElement(i.Button,{variant:"opacity",onClick:s},(e=>e.formatMessage({id:"i3tRYX",defaultMessage:"Cancel"}))(t)),f.createElement(i.Button,{variant:"primary",onClick:()=>{_(!1),s()}},u))))};jn.displayName="ChangeConfidentialityModal";const Wn=({message:e,variant:t})=>{if(!e)return null;const a="error"===t?"alert":"attention";return f.createElement(i.Banner,{type:a},f.createElement(i.Banner.Message,{className:"scl-sharing-modal-validation-warning__message"},e))};Wn.displayName="FormValidationMessage";i.injectInternalStyle("/static/metaserver/static/js/sharing/sharing-sdk/legos/inband-screen/internals/message-field.module.out-vflz4Lojh.css",(e=>"._message-field_18h2c_1{display:flex;flex-grow:1;margin-bottom:-3px;padding-top:0}._message-field_18h2c_1 textarea{background-color:var(--dig-color__background__base);border:1px solid var(--dig-color__border__subtle);flex-grow:1;height:auto}"));const Kn="_message-field_18h2c_1",qn=()=>{const e=r.useIntl(),t=Nr(),a=o.useStore(t.$inviteMessage),n=o.useStore(t.$isInviteSending),s=(()=>{const e=Pt(),t=Nr();return f.useCallback((a=>{e("SHARE_MODAL_SHARE__MESSAGE_CHANGED",null),t.$inviteMessage.set(a.target.value),t.$props.get().onInviteMessageChange(a.target.value)}),[t,e])})();return f.createElement(i.Box,{className:Kn,paddingTop:"Micro Large"},f.createElement(i.TextArea,{defaultValue:a,placeholder:dr(e),"aria-label":cr(e),onChange:s,disabled:n,"data-testid":"ib-message-field-textarea"}))};qn.displayName="MessageField";i.injectInternalStyle("/static/metaserver/static/js/sharing/sharing-sdk/legos/inband-screen/internals/share-modal-share.module.out-vflXLGzBa.css",(e=>"._action-row_1nkgf_1{display:flex;flex-direction:column;min-height:310px;row-gap:var(--dig-spacing__micro__medium);width:100%}._action-row-expand-from-accessory-area_1nkgf_12{animation:_action-row-expand-accessory-area_1nkgf_1 var(--duration__surface) var(--easing__transition) forwards;min-height:64px;overflow:hidden}._action-section_1nkgf_19{border:1px solid var(--dig-color__border__subtle);border-radius:var(--dig-radius__medium);position:relative;transition:border var(--duration__micro-fast) var(--easing__transition);z-index:1}._action-section-top_1nkgf_28{padding:var(--dig-spacing__micro__medium)}._action-section-active_1nkgf_32{border-color:var(--dig-color__secondary__base);box-shadow:none}._action-section-active_1nkgf_32,._action-section-active_1nkgf_32:hover,._action-section_1nkgf_19:focus-within{box-shadow:var(--dig-utilities__boxshadow__focus-ring);transition:box-shadow var(--duration__micro-fast) var(--easing__transition)}._accessory-section_1nkgf_44{animation:_fade-in_1nkgf_1 var(--duration__micro-fast) var(--easing__transition) forwards;display:flex;flex-direction:column;flex-grow:1;height:100%;row-gap:var(--dig-spacing__micro__medium);width:100%}._action-row-expand-from-accessory-area_1nkgf_12 ._accessory-section_1nkgf_44{animation:_fade-in_1nkgf_1 var(--duration__surface) var(--easing__transition) forwards}@media (prefers-reduced-motion:reduce){._action-row-expand-from-accessory-area_1nkgf_12,._action-row-expand-from-accessory-area_1nkgf_12 ._accessory-section_1nkgf_44{animation-timing-function:var(--easing__linear)}}@keyframes _action-row-expand-accessory-area_1nkgf_1{0%{max-height:64px;min-height:64px}to{min-height:286px;overflow:visible}}@keyframes _fade-in_1nkgf_1{0%{opacity:0}to{opacity:1}}._action-section-bottom_1nkgf_88{align-items:center;display:flex;height:32px;justify-content:space-between}._add-icon-small_1nkgf_96{height:var(--dig-spacing__dimension__24);margin-top:var(--dig-spacing__dimension__6);min-width:var(--dig-spacing__dimension__24);width:var(--dig-spacing__dimension__24)}._add-icon-small_1nkgf_96 svg{height:var(--dig-spacing__dimension__16);width:var(--dig-spacing__dimension__16)}._add-icon_1nkgf_96,._add-icon_1nkgf_96>svg{transition:min-width var(--duration__surface) var(--easing__transition),width var(--duration__surface) var(--easing__transition),background-color var(--duration__surface) var(--easing__transition),color var(--duration__surface) var(--easing__transition),height var(--duration__surface) var(--easing__transition),margin-top var(--duration__surface) var(--easing__transition)}._add-icon-shrink_1nkgf_121{animation:_shrink-icon_1nkgf_1 var(--duration__micro-fast) var(--easing__transition) forwards}._add-icon-shrink_1nkgf_121>svg{animation:_shrink-icon-svg_1nkgf_1 var(--duration__micro-fast) var(--easing__transition) forwards}@keyframes _shrink-icon_1nkgf_1{0%{height:var(--dig-spacing__dimension__36);margin-top:0;min-width:var(--dig-spacing__dimension__36);width:var(--dig-spacing__dimension__36)}to{height:var(--dig-spacing__dimension__24);margin-top:5px;min-width:var(--dig-spacing__dimension__24);width:var(--dig-spacing__dimension__24)}}@keyframes _shrink-icon-svg_1nkgf_1{0%{height:var(--dig-spacing__dimension__24);width:var(--dig-spacing__dimension__24)}to{height:var(--dig-spacing__dimension__16);width:var(--dig-spacing__dimension__16)}}._add-members-directly-action-section_1nkgf_170{border-color:var(--dig-color__border__subtle);border-radius:var(--dig-radius__small);border-style:solid;border-width:2px;position:relative;z-index:1}._add-members-directly-action-section_1nkgf_170 ._add-icon_1nkgf_96{margin-top:0}._add-members-directly-action-section-active_1nkgf_183,._add-members-directly-action-section_1nkgf_170:focus-within{border-color:var(--dig-color__utility__focus-ring)}._add-members-directly-action-section-active_1nkgf_183 ._add-icon_1nkgf_96,._add-members-directly-action-section_1nkgf_170:focus-within ._add-icon_1nkgf_96,._add-members-directly-action-section_1nkgf_170:hover ._add-icon_1nkgf_96{background:var(--dig-color__primary__base);color:var(--dig-color__background__base)}._add-members-directly-action-section-bottom_1nkgf_195{padding:var(--dig-spacing__micro__medium);padding-top:var(--dig-spacing__micro__medium)}._add-members-directly-action-section-active_1nkgf_183 ._add-icon-sending_1nkgf_200,._add-members-directly-action-section_1nkgf_170:focus-within ._add-icon-sending_1nkgf_200,._add-members-directly-action-section_1nkgf_170:hover ._add-icon-sending_1nkgf_200{background:var(--dig-color__disabled__base)}._add-members-directly-action-section_1nkgf_170 ._add-icon-sending_1nkgf_200>svg,._add-members-directly-action-section-active_1nkgf_183 ._add-icon-sending_1nkgf_200>svg,._add-members-directly-action-section_1nkgf_170:focus-within ._add-icon-sending_1nkgf_200>svg,._add-members-directly-action-section_1nkgf_170:hover ._add-icon-sending_1nkgf_200>svg{color:var(--dig-color__disabled__on-surface)}"));const Yn="_action-row_1nkgf_1",Zn="_action-row-expand-from-accessory-area_1nkgf_12",Jn="_action-section_1nkgf_19",Qn="_action-section-top_1nkgf_28",Xn="_action-section-active_1nkgf_32",ei="_accessory-section_1nkgf_44",ti="_action-section-bottom_1nkgf_88",ai="_add-icon-small_1nkgf_96",ri="_add-icon_1nkgf_96",ni="_add-icon-shrink_1nkgf_121",ii="_add-members-directly-action-section_1nkgf_170",oi="_add-members-directly-action-section-active_1nkgf_183",si="_add-icon-sending_1nkgf_200",_i=(e,t)=>{const a=e.linked_services.find((e=>e.service_type[".tag"]===t[".tag"]));return!!a&&"is_connected"===a.connection_state[".tag"]},li=(e,t,a)=>{const r=e.linked_services.find((e=>e.service_type[".tag"]===t[".tag"]));return!!r&&r.granted_permissions.some((e=>e[".tag"]===a[".tag"]))},di=_a({name:"profileServices.listLinkedServices"},(e=>()=>sa(e.profileServicesListLinkedServices()))),ci=e=>e,ui=_a({name:"sharing.targetsSearch"},(e=>async t=>{const a=await sa(e.sharingTargetsSearch(t));return"SUCCESS"===a.status?{status:na.SUCCESS,output:a.output.entries.map(ci)}:a})),gi=e=>{const t=e.toUpperCase().split(" ").filter((e=>e));return`${t.length>0?t[0][0]:""}${t.length>1?t[t.length-1][0]:""}`};function mi(e,t){if(!e)return"";const a=(e=e.toUpperCase()).trim().split(" "),r=Ei(a[0]),n=Ei(a[a.length-1]);if(a.length>=2)return pi(t)?n[0]+r[0]:r[0]+n[0];const i=Ei(e);return pi(t)&&!function(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>=128)return!1;return!0}(e)&&i.length>1?i[0]+i[1]:i[0]}function pi(e){return["zh","ja","ko"].includes(new Intl.Locale(e).language)}function Ei(e){const t=[],a=e.length;let r=0;for(;r<a;){const n=e[r];if(n>="\ud800"&&n<="\udb7f"){if(!(r<a-1))break;{const a=n+e[r+1];t.push(a),r+=2}}else t.push(n),r+=1}return t}const hi=Symbol("ON_SHOW_SUGGESTIONS"),vi=Symbol("ON_SELECT_SUGGESTION"),{useEmitter:Si,defaultEmitter:Ai}=i.defineLogger((async({event:e,getContextValue:t})=>{const a=t($a),r=t(Pa),n=t(Ya),o={...Ua(a),...Fa(r),...Za(n)};e.key!==hi?e.key!==vi||i.UDCL.logEvent("ops.sm24.select_tokenizer_suggestion",{tags:{...o,method:e.payload.method,suggestionIndex:e.payload.index.toString()}}):i.UDCL.logEvent("ops.sm24.show_tokenizer_suggestions",{tags:{...o,numSuggestions:e.payload.numSuggestions.toString()}})}));i.injectInternalStyle("/static/metaserver/static/js/sharing/sharing-sdk/legos/targets-tokenizer/internals/targets-tokenizer.module.out-vflJNzvhU.css",(e=>"._share-tokenizer_jmhe8_1{color-scheme:var(--dig-color-scheme);margin-top:var(--dig-spacing__dimension__4);max-height:80px;max-height:64px;max-width:100%;min-height:32px;min-width:auto;overflow-y:hidden;width:100%}._share-tokenizer-with-targets_jmhe8_16{overflow-y:scroll}._share-tokenizer-text-input-container_jmhe8_20{cursor:text;position:relative}._share-tokenizer-text-input-container_jmhe8_20,._share-tokenizer-text-input-container_jmhe8_20:focus-within,._share-tokenizer-text-input-container_jmhe8_20:has(input:focus){border:none;box-shadow:none;outline:none}._share-tokenizer-typeahead-container_jmhe8_33{border-radius:var(--dig-radius__small);transform:translate(-14px,20px);width:calc(100% + 28px)}._share-tokenizer-with-targets_jmhe8_16:not(._share-tokenizer_jmhe8_1) ._share-tokenizer-typeahead-container_jmhe8_33{transform:translate(-14px)}input._share-tokenizer-text-input_jmhe8_20[type=text]{font-family:var(--type__body__standard--fontfamily);font-size:var(--type__body__standard--fontsize);line-height:var(--type__body__standard--lineheight_label);min-height:var(--dig-spacing__dimension__24);min-width:2ch;width:0}._screen-reader-only_jmhe8_55{height:1px;left:-10000px;overflow:hidden;position:absolute;top:auto;width:1px}"));const fi="_share-tokenizer_jmhe8_1",yi="_share-tokenizer-with-targets_jmhe8_16",bi="_share-tokenizer-text-input-container_jmhe8_20",Ti="_share-tokenizer-typeahead-container_jmhe8_33",Ii="_share-tokenizer-text-input_jmhe8_20",Ri="_screen-reader-only_jmhe8_55",wi=/['&A-Za-z0-9\._%+-]+@[A-Za-z0-9-][A-Za-z0-9\.-]*\.[A-Za-z]{2,15}/gi,Ci=/[,|;>\s]/,Mi="Enter",Li="IMPORT_CONTACTS",ki=[Li],Ni="Google",Oi="/static/images/index/google-logo-color.svg",xi=e=>(e.match(wi)||[]).map(G),Di=e=>f.useCallback((t=>{const a=t.currentTarget.value,r=(n=a,Ci.test(n)?xi(n):[]);var n;o.batch((()=>{e.$isTypeaheadForcedOpen.set(!1),r.length>0?(e.$inviteTargets.set([...e.$inviteTargets.get(),...r]),e.$query.set("")):e.$query.set(a)}))}),[e]),Pi=e=>e.map((e=>{if("email"===e[".tag"]||"user"===e[".tag"]){const t=e.email.trim();return t.length===e.email.length?e:{...e,email:t}}return e})),Fi=e=>{const t={};return e.filter((e=>{const a=j(e);return!t[a]&&(t[a]=!0,!0)}))},Hi=e=>{const t=Aa(ui),a=Pt(),n=r.useIntl();return f.useCallback((async()=>{const r=e.$query.get(),s=await t({query:r,force_refresh:!1,limit:10});if(e.$query.get()===r){if(a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_START",null),"SUCCESS"!==s.status)return"ERROR"===s.status?a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_ERROR",{response:s}):a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_FATAL",{response:s}),_=n.formatMessage({id:"+iNJRS",defaultMessage:"There was a problem completing this request."}),qr(),i.Snackbar.generic(_,Br),void e.$searchSuggestionsRaw.set([]);var _;a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_SUCCESS",{response:s}),o.batch((()=>{e.$latestSuggestionsQuery.set(r),e.$searchSuggestionsRaw.set(s.output)}))}}),[e,t,a,n])},$i=e=>{const t=Aa(di);return f.useCallback((async()=>{if(e.$isLinkedServicesUpdating.get())return;const a=await t(null);"SUCCESS"===a.status?o.batch((()=>{e.$linkedServices.set(a.output),e.$isLinkedServicesUpdating.set(!1)})):o.batch((()=>{e.$linkedServices.set(null),e.$isLinkedServicesUpdating.set(!1)}))}),[e,t])},Ui=e=>{const t=r.useIntl(),a=Pt(),n=$i(e),o=Wt();return f.useCallback((async()=>{if(e.$isConnectingToGoogle.get()||null===o)return;e.$isConnectingToGoogle.set(!0);let r=null;const s=()=>{jr(t.formatMessage({id:"sgP44K",defaultMessage:"Failed to connect your contacts from Google"})),null!==r&&clearInterval(r),window.removeEventListener("message",d),n().then((()=>{e.$isConnectingToGoogle.set(!1)}))},_=new URLSearchParams({service:"1",is_popup:"true",action:"link_contacts",prompt_select:"true",token:o,user_id:e.$user.get().id.toString(),is_desktop:"false"}),l=window.open(`/profile_services/start_auth_flow?${_.toString()}`,"Google","width=600,height=600,resizable=1,scrollbars=1");if(null===l)return s();r=setInterval((()=>{l.closed&&s()}),1e3);const d=o=>{let _;try{_=JSON.parse(o.data)}catch(e){return}if(i.isObjectOf({type:i.isExactly("db:profile_service:auth_complete"),payload:i.isObjectOf({success:i.isBoolean})})(_)){if(_.payload.success)return c=l,a("TEAMS_WEB",{name:i.TeamsWebEventName.ImportContactsComplete,extra:{provider:"google",path:window.location.pathname}}),zr(t.formatMessage({id:"Au33+R",defaultMessage:"Successfully connected your contacts from Google"})),null!==r&&clearInterval(r),window.removeEventListener("message",d),n().then((()=>{e.$isConnectingToGoogle.set(!1)})),void(null==c||c.close());var c;s(),l.close()}};window.addEventListener("message",d)}),[e,t,a,n,o])},Vi=(e,t)=>"user"===e[".tag"]?mi(e.name,t.locale):"group"===e[".tag"]?gi(e.name):"email"===e[".tag"]?"":i.exhausts(e,""),Bi=(e,t)=>"user"===e[".tag"]?t&&t!==e.dbx_team_id?e.email:e.name:"group"===e[".tag"]?e.name:"email"===e[".tag"]?e.email:"",zi=({store:e,target:t,isDisabled:a,maxChars:n})=>{const s=r.useIntl(),_=((e,t)=>f.useCallback((()=>{const a=e.$inviteTargets.get().filter((e=>e!==t));o.batch((()=>{e.$inviteTargets.set(a),e.$query.set("")}))}),[e,t]))(e,t),l=e.$user.get().team_dbtid,d=$.em_snippet(Bi(t,l),null!=n?n:i.SNIPPET_SIZES.EMAIL_SHORT,.6),c="user"===t[".tag"]&&l&&l!==t.dbx_team_id?"":Vi(t,s),u=W(t),g=j(t),m=o.useStore(e.$inviteTargetValidation)[g],p=m&&"allowed"===m.result[".tag"]&&"no_warning"!==m.result.allowed[".tag"]&&"not_dropbox_user"!==m.result.allowed[".tag"],h=m&&"disallowed"===m.result[".tag"],v=!!c||!!u,S=v&&f.createElement(i.Avatar,{src:u||"",size:"xsmall",hasNoOutline:!0,"aria-hidden":!0},c),A=s.formatMessage({id:"cVF7dM",defaultMessage:"Sharing with {label} - press backspace or delete to remove"},{label:d});return f.createElement(E.Chip,{size:"small",onDelete:_,variant:p?"attention":h?"alert":"standard",disabled:a,"aria-label":A},v&&f.createElement(E.Chip.AvatarAccessory,null,S),f.createElement(E.Chip.Content,null,d))};zi.displayName="EmailChip";const Gi=({target:e})=>{const t=r.useIntl(),a=j(e),n=Vi(e,t),o=Bi(e),s=K(e,t),_=W(e);return f.createElement(h.Typeahead.Row,{"data-testid":"typeahead-suggestion",className:"targets-tokenizer-suggestion",key:a,value:e,withTitle:o,withSubtitle:s,withLeftAccessory:f.createElement(i.Avatar,{src:_||void 0,hasNoOutline:!0,alt:o,"aria-hidden":"true"},n)})};Gi.displayName="Suggestion";const ji=({results:e,suggestionMax:t})=>f.createElement("div",{className:Ri,"aria-live":"polite"},e.slice(0,t).map(((e,t)=>f.createElement("div",{key:t},e!==Li&&Bi(e)))));ji.displayName="ScreenReaderLiveResults";const Wi=({store:e})=>{const t=r.useIntl(),a=o.useStore(e.$isConnectingToGoogle),n=o.useStore(e.$isConnectedToGoogle),s=o.useStore(e.$isLinkedServicesUpdating);return Wt()?a?f.createElement(h.Typeahead.Row,{"data-testid":"typeahead-import-contacts",className:"typeahead-import-contacts",key:Li,withLeftAccessory:f.createElement(i.Avatar,{src:Oi}),value:Li,withTitle:Ni,withSubtitle:t.formatMessage({id:"JbMFlW",defaultMessage:"Importing contacts"})}):s?null:n?f.createElement(h.Typeahead.Row,{"data-testid":"typeahead-import-contacts",className:"typeahead-import-contacts",key:Li,withLeftAccessory:f.createElement(i.Avatar,{src:Oi}),value:Li,withTitle:Ni,withSubtitle:t.formatMessage({id:"2/+46g",defaultMessage:"Connected"})}):f.createElement(h.Typeahead.Row,{"data-testid":"typeahead-import-contacts",className:"typeahead-import-contacts",key:Li,withLeftAccessory:f.createElement(i.Avatar,{src:Oi}),value:Li,withTitle:Ni,withSubtitle:t.formatMessage({id:"CkYgqG",defaultMessage:"Sign in to import contacts"})}):null};Wi.displayName="ImportContacts";const Ki=e=>{var t;const a=(e=>o.useInitStore(e,(e=>{var t;const a=o.store(!1),r=o.store(!1),n=o.store(!1),s=o.store(null!==(t=e.get().autoFocus)&&void 0!==t&&t),_=o.store(!1),l=o.store(null),d=o.store(""),c=o.store(""),u=o.proxy((()=>e.get().isActive)),g=o.proxy((()=>e.get().user)),m=o.proxy((()=>e.get().accessLevel)),p=o.proxy((()=>e.get().isEmailSectionActive)),E=o.proxy((()=>e.get().inviteTargets),(t=>e.get().onInviteTargetsChange(Pi(Fi(t))))),h=o.proxy((()=>e.get().inviteTargetValidation)),v=o.proxy((()=>E.get().length>0)),S=o.proxy((()=>e.get().objectMetadata)),A=o.proxy((()=>i.getCanInvite(S.get(),m.get()))),f=o.proxy((()=>{const e=l.get();return e?_i(e,{".tag":"google"})&&li(e,{".tag":"google"},{".tag":"contacts"}):null})),y=o.proxy((()=>g.get().is_team)),b=o.proxy((()=>i.getIsTeamSharedFolder(S.get()))),T=o.proxy((()=>e.get().autoFocus)),I=o.proxy((()=>n.get())),R=o.store([]),w=o.proxy((e=>{const t=b.get(),a=g.get().email,r=E.get().map(j),n={},i=R.get().filter((e=>{const i=j(e);return!(n[i]||(n[i]=!0,r.includes(i)||!H(t,g.get().is_tmr_member)&&"group"!==e[".tag"]||"email"===e[".tag"]||"user"===e[".tag"]&&e.email===a))}));return null!==e&&e.length===i.length&&e.every(((e,t)=>e===i[t]),!0)?e:i})),C=o.proxy((e=>{const t=b.get(),a=d.get(),r=t||""===a,n=[...w.get().slice(0,9),...r?[]:ki];return null!==e&&e.length===n.length&&e.reduce(((e,t,a)=>e&&t===n[a]),!0)?e:n}));return{$accessLevel:m,$user:g,$canInvite:A,$inviteTargets:E,$inviteTargetValidation:h,$hasInviteTargets:v,$isConnectedToGoogle:f,$isConnectingToGoogle:a,$isFocused:r,$isLinkedServicesUpdating:n,$isTeamAccount:y,$isTeamFolder:b,$isTypeaheadForcedOpen:s,$isTypeaheadOpen:_,$isUpdatingGoogleConnectionStatus:I,$linkedServices:l,$objectMetadata:S,$query:d,$latestSuggestionsQuery:c,$searchSuggestionsRaw:R,$searchSuggestions:w,$suggestions:C,$isEmailSectionActive:p,$autoFocus:T,$isActive:u,$props:e}})))(e),n=r.useIntl(),s=f.useRef(null),_=o.useStore(a.$query),l=o.useStore(a.$inviteTargets),d=o.useStore(a.$hasInviteTargets),c=f.useRef(l.length),u=o.useStore(a.$suggestions),g=o.useStore(a.$canInvite),m=o.useStore(a.$isTypeaheadForcedOpen)&&g,p=null!==(t=o.useStore(a.$autoFocus))&&void 0!==t&&t;(e=>{const t=Hi(e);f.useEffect((()=>{const a=[e.$query.obs((e=>{t()}))];return()=>a.forEach((e=>e()))}),[e,t])})(a),(e=>{const t=Aa(ui),a=Pt();f.useEffect((()=>{(async()=>{a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_START",null);const r=await t({query:"",force_refresh:!0,limit:10});"SUCCESS"===r.status?a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_SUCCESS",{response:r}):"ERROR"===r.status?a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_ERROR",{response:r}):a("TARGETS_TOKENIZER__TARGETS_SEARCH__API_FATAL",{response:r}),"SUCCESS"===r.status&&e.$searchSuggestionsRaw.set(r.output)})()}),[])})(a),(e=>{const t=$i(e);f.useEffect((()=>{t()}),[t])})(a),(e=>{const t=Si(),a=o.useStore(e.$searchSuggestions),r=o.useStore(e.$isTypeaheadOpen);f.useEffect((()=>{if(r){const e=a.slice(0,9).length;e>0&&r&&t.select(hi).emit({numSuggestions:e})}}),[a,t,r])})(a);const E=(e=>{const t=Si(),a=Ui(e),r=o.useStore(e.$searchSuggestions);return f.useCallback(((n,i)=>{o.batch((()=>{var o,s;if(n===Li){if(e.$isTypeaheadForcedOpen.set(!0),e.$isConnectingToGoogle.get())return;if(e.$isConnectedToGoogle.get())return;return e.$query.set(""),void a()}t.select(vi).emit({index:r.findIndex((e=>e===n)),method:i.nativeEvent instanceof KeyboardEvent?"keyboard":"click"}),e.$query.set(""),e.$inviteTargets.set([...e.$inviteTargets.get(),n]),null===(s=null===(o=e.$props.get().inputRef)||void 0===o?void 0:o.current)||void 0===s||s.focus()}))}),[e,a,t,r])})(a),v=(e=>{const t=Si();return f.useCallback((a=>{const r=e.$query.get();if(a.key===Mi&&a.shiftKey)return void a.preventDefault();"Backspace"!==a.key&&"Delete"!==a.key||""===r&&e.$inviteTargets.get().length>0&&e.$inviteTargets.set(e.$inviteTargets.get().slice(0,-1));const n=r===e.$latestSuggestionsQuery.get(),i=wi.test(r);if(a.key===Mi){const a=document.getElementById("targets-tokenizer-input-search");if(a&&"scrollIntoView"in a&&a.scrollIntoView(),n&&!i&&e.$searchSuggestions.get().length>0)t.select(vi).emit({index:0,method:"keyboard"}),o.batch((()=>{e.$inviteTargets.set([...e.$inviteTargets.get(),e.$searchSuggestions.get()[0]]),e.$query.set("")}));else if(""!==r){const t=xi(r);t.length>0?o.batch((()=>{e.$inviteTargets.set([...e.$inviteTargets.get(),...t]),e.$query.set("")})):o.batch((()=>{e.$inviteTargets.set([...e.$inviteTargets.get(),G(r)]),e.$query.set("")}))}}}),[e,t])})(a),S=Di(a),{inputPlaceholder:A,truncatedInputPlaceholder:y}=(e=>{var t;const a=r.useIntl(),n=o.useStore(e.$hasInviteTargets),s=o.useStore(e.$isTeamFolder),_=o.useStore(e.$isTeamAccount),l=o.useStore(e.$user).is_tmr_member,d=null===(t=o.useStore(e.$props).shouldTruncatePlaceholder)||void 0===t||t;return f.useMemo((()=>{let e;return e=n?void 0:s&&!l?a.formatMessage({id:"VMGE6I",defaultMessage:"Group names"}):_?a.formatMessage({id:"+nKRfb",defaultMessage:"Add an email, name, or group"}):a.formatMessage({id:"bdV6O3",defaultMessage:"Add an email or name"}),{inputPlaceholder:e,truncatedInputPlaceholder:d&&e?$.em_snippet(e,i.SNIPPET_SIZES.TOKENIZER_PLACEHOLDER,1):e}}),[s,_,a,l,n,d])})(a),b=(e=>f.useCallback((({isOpen:t})=>{if(t)e.$isTypeaheadOpen.set(!0);else{const t=xi(e.$query.get());o.batch((()=>{t.length>0&&(e.$inviteTargets.set([...e.$inviteTargets.get(),...t]),e.$query.set("")),e.$isTypeaheadForcedOpen.set(!1),e.$isTypeaheadOpen.set(!1),e.$isFocused.set(!1)}))}}),[e]))(a),T=(e=>f.useCallback((()=>{var t,a;null===(a=(t=e.$props.get()).onUserInteraction)||void 0===a||a.call(t),e.$isTypeaheadForcedOpen.set(!1),e.$isFocused.set(!0)}),[e]))(a),I=(e=>f.useCallback((t=>t===Li?f.createElement(Wi,{store:e}):f.createElement(Gi,{target:t})),[e]))(a),R=f.useRef(!1),w=e.isInviteSending||!g,C=f.useCallback(((t,a)=>{var r;const n=a.includes(Li)?a.length-1:a.length,i=t&&n>0;R.current!==i&&(R.current=i,null===(r=e.onTargetsDropdownFocusChange)||void 0===r||r.call(e,i)),e.isSuggestionsOpen.set(t)}),[e.onTargetsDropdownFocusChange,e.isSuggestionsOpen]),M=f.useCallback((()=>{e.isSuggestionsOpen.get()||a.$isTypeaheadForcedOpen.set(!0)}),[a.$isTypeaheadForcedOpen,e.isSuggestionsOpen]),L=f.useCallback((()=>{var t,a;null===(a=null===(t=e.inputRef)||void 0===t?void 0:t.current)||void 0===a||a.focus()}),[e.inputRef]);return f.useEffect((()=>{g&&0===e.inviteTargets.length&&!e.isActionRowTransitionInProgress&&L()}),[g,L,e.inviteTargets,e.isActionRowTransitionInProgress]),f.useEffect((()=>{if(c.current<l.length){const e=document.getElementById("targets-tokenizer-input-search");e&&"scrollIntoView"in e&&e.scrollIntoView()}c.current=l.length}),[l.length]),f.createElement(i.DIGContext.Provider,{value:{featureLevel:"experimental"}},f.createElement(h.Typeahead.Wrapper,{className:i.cx(fi,fi,{[yi]:d}),onSelection:E,hasMaxHeight:!0,isPortaled:!1,onToggle:b},(({getTriggerProps:t,getContentProps:r})=>{const{open:o,...d}=r({}),c=(o||m)&&u.length>0;return C(c,u),f.createElement(f.Fragment,null,f.createElement(i.TextInput.Container,{className:i.cx(bi),ref:s,size:"small",onClick:L,"data-uxa-log":"sm24-tokenizer","data-uxa-interactions":"shown"},f.createElement(i.TextInput.ChipsContainer,null,l.map(((e,t)=>f.createElement(zi,{store:a,key:t,target:e,isDisabled:w}))),f.createElement(i.TextInput.Input,{...t({onChange:S,onKeyDown:v,onFocus:T}),className:Ii,ref:e.inputRef,disabled:w,value:_,"aria-label":A,placeholder:y,"data-testid":"targets-tokenizer-input",id:"targets-tokenizer-input-search",autoComplete:"off",autoFocus:p,onClick:M}))),f.createElement(h.Typeahead.Container,{...d,triggerRef:e.inbandInputAreaRef,open:c,"data-testid":"typeahead-container",className:Ti,auto:!1,placement:"bottom","aria-label":n.formatMessage({id:"6EE+ph",defaultMessage:"Suggested people list"})},f.createElement(ji,{results:u,suggestionMax:3}),f.createElement(h.Typeahead.Results,{title:n.formatMessage({id:"ZusjWv",defaultMessage:"Suggested people"}),results:u,renderRow:I,initialResults:""===_?3:10,maxResults:10})))})))};Ki.displayName="TargetsTokenizer";const qi=e=>f.useMemo((()=>{return{id:(t=e).user_id,email:t.email,is_team:za(t),is_team_admin:t.is_team_admin,account_id:t.account_id,team_dbtid:t.team_id,is_tmr_member:t.is_tmr_member};var t}),[e]),Yi=f.memo((({isActive:e,objectMetadata:t,accountMetadata:a,inbandInputAreaRef:r,inputRef:n,onFocusChange:i,isActionRowTransitionInProgress:s})=>{const _=Nr(),l=o.useStore(_.$inviteTargets),d=o.useStore(_.$inviteTargetValidations),c=o.useStore(_.$isInviteSending),u=o.useAtom(_.$sharingAccessLevel),g=qi(a),m=_.$isSuggestionsOpen,{shouldStyleForSM21:p}=o.useAtom(_.$props),E=(()=>{const e=Pt(),t=Nr();return f.useCallback((a=>{e("SHARE_MODAL_SHARE__INVITE_TARGETS__CHANGE",null),t.$props.get().onInviteTargetsChange(a)}),[t,e])})();return f.createElement(Ki,{accessLevel:u,objectMetadata:t,inviteTargets:l,onInviteTargetsChange:E,onTargetsDropdownFocusChange:i,inviteTargetValidation:d,user:g,isInviteSending:c,inbandInputAreaRef:r,inputRef:n,isActive:e,isSuggestionsOpen:m,shouldTruncatePlaceholder:p,isActionRowTransitionInProgress:s})}));Yi.displayName="TargetsTokenizer";const Zi=()=>{const e=r.useIntl();return f.default.createElement(i.Box,{style:{display:"flex",flexDirection:"column",height:"310px"}},f.default.createElement(v.ButtonWrapper,null,f.default.createElement(v.HorizontalButton,{disabled:!0},f.default.createElement(i.Skeleton.Avatar,{size:"medium",style:{marginRight:"var(--dig-spacing__dimension__12)"}}),f.default.createElement(i.Skeleton.Text,{size:"large",width:200}))),f.default.createElement(i.Box,{style:{marginTop:"var(--dig-spacing__dimension__12)"}},f.default.createElement(i.StylelessButton,{disabled:!0,className:v.baseButton,style:{height:"190px",width:"100%",padding:"var(--dig-spacing__dimension__16)"}},f.default.createElement(i.Box,{style:{display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"flex-start",rowGap:"var(--dig-spacing__dimension__16)"}},f.default.createElement(i.Skeleton.Text,{width:330,style:{margin:0}}),f.default.createElement(i.Skeleton.Text,{width:330,style:{margin:0}}),f.default.createElement(i.Skeleton.Text,{width:330,style:{margin:0}}))),f.default.createElement(i.Box,{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"var(--dig-spacing__dimension__12)"}},f.default.createElement(i.Skeleton.Text,{size:"large",width:200}),f.default.createElement(i.Button,{variant:"primary",size:"medium",fullWidth:!1,disabled:!0},gr(e,!1)))))};Zi.displayName="LoadingScreen";const Ji=({objectMetadata:e,accountMetadata:t,sharingPrefs:a})=>{var n;const s=r.useIntl(),_=Nr(),l=f.useRef(null),d=f.useRef(null),{shouldStyleForSM21:c}=o.useAtom(_.$props),u=o.useAtom(_.$isInviteSending),g=o.useAtom(_.$inviteTargets),m=o.useAtom(_.$isConfidentialFolder),p=Hn(e),E=$n(e,a),h=(()=>{const e=Nr();return f.useCallback((t=>{e.$changeConfidentialityData.set({teamName:t})}),[e.$changeConfidentialityData])})(),v=null!==(n=i.getOwnerTeamName(e))&&void 0!==n?n:"",A=o.useAtom(_.$isSuggestionsOpen),y=g.length>0,{shouldTransitionAccessoryAreaEnter:b}=o.useAtom(_.$props),[T,I]=f.useState(!1),[R,w]=f.useState(b),{onStartInband:C}=o.useAtom(_.$props),M=o.useAtom(_.$componentViewTime),L=f.useRef(!1),k=Pn();f.useEffect((()=>{if(!L.current&&M>0){L.current=!0;const e=Date.now()-M;C&&C(),k.select(Rn).emit({timeSinceView:e})}}),[M]);const N=f.useCallback((()=>{w(!1)}),[w]);return f.createElement("div",{className:i.cx(Yn,{[Zn]:b}),onAnimationEnd:N},f.createElement("div",{id:"shareme24-ib-action-container",style:{width:"100%"},"data-testid":"ib-action-area",role:"region"},f.createElement(i.Box,{className:"banner-group",marginBottom:m?"Micro Small":"0"},m?f.createElement(er,{teamName:v,parentFolderName:i.getParentFolderName(e),isRestoreAccessEnabled:i.getCanDoAction(e,i.UPDATE_CONFIDENTIALITY_TAG),onRestoreAccessClick:h}):null,f.createElement(jn,{objectMetadata:e})),f.createElement(i.Box,{flexDirection:"column",className:c?i.cx(ii,{[oi]:T||A}):i.cx(Jn,{[Xn]:T||A}),backgroundColor:"Background Base",onClick:()=>{!(null==d?void 0:d.current)||y||A||d.current.focus()}},f.createElement(i.Box,{className:Qn},f.createElement(i.Box,{ref:l,display:"flex",flexDirection:"row",style:{minHeight:"var(--dig-spacing__dimension__36)"},alignItems:"center"},f.createElement(i.Box,{className:i.cx(ri,{[ai]:c,[ni]:!c,[si]:u}),borderRadius:"Circular",display:"flex",alignItems:"center",justifyContent:"center"},f.createElement(i.UIIcon,{src:S.ShareLine,size:"medium"})),f.createElement(Yi,{isActive:T||A,objectMetadata:e,accountMetadata:t,inbandInputAreaRef:l,inputRef:d,onFocusChange:I,isActionRowTransitionInProgress:R}))))),f.createElement("div",{className:ei},p&&f.createElement(Wn,{message:p.message,variant:p.level}),f.createElement(qn,null),f.createElement(i.Box,{className:ti},f.createElement(Fr,null),u?(()=>{const e=ur(s);return f.createElement(i.Box,{display:"flex"},f.createElement(i.Box,{marginRight:"Micro XSmall"},f.createElement(i.Spinner,{size:"xsmall","aria-valuetext":null==e?void 0:e.toString(),monochromatic:!0,withTrack:!0})),f.createElement(i.Text,null,e))})():f.createElement(i.Button,{disabled:u||null!=p&&"error"===p.level||!y,style:{flexShrink:0,alignSelf:"center"},onClick:E,variant:"primary",size:"medium",fullWidth:!1,"data-uxa-log":"sharing-modal-footer-button-send-email","data-testid":"ib-share-send-email-button"},gr(s,u)))))};Ji.displayName="InbandShare";const Qi=()=>{const e=Nr(),t=o.useAtom(e.$props),{accountMetadataResult:a,objectMetadataResult:r,sharingPrefsResult:n}=t,i=r.isLoading,s=!r.isLoading&&!r.isError,_=a.isLoading,l=!a.isLoading&&!a.isError,d=n.isLoading,c=!n.isLoading&&!n.isError,u=s&&l&&c;return i||_||d?f.createElement(Zi,null):u?f.createElement(eo,{objectMetadata:r.output,accountMetadata:a.output,sharingPrefs:n.output}):null};Qi.displayName="InbandWithStore";const Xi=e=>f.createElement(Or,{...e},f.createElement(Qi,null));Xi.displayName="Inband";const eo=({objectMetadata:e,accountMetadata:t,sharingPrefs:a})=>{const r=Nr(),n=o.useAtom(r.$inviteTargets),i=o.useAtom(r.$sharingAccessLevel);return Vr(e),f.useEffect((()=>{r.$componentViewTime.set(Date.now())}),[r]),f.createElement(c.AbuseFpjsProvider,{loadingComponent:f.createElement(Zi,null)},f.createElement(Ft,{sharingInviteTargets:n,sharingAccessLevel:i},f.createElement(Ji,{objectMetadata:e,accountMetadata:t,sharingPrefs:a})))};eo.displayName="InbandInner";i.injectInternalStyle("/static/metaserver/static/js/sharing/sharing-sdk/common/components/layout.module.out-vfly-Wi30.css",(e=>"._overlay_yiz3b_1{background:var(--dig-color__background__subtle);border:.5px solid var(--dig-color__border__subtle);border-radius:var(--dig-radius__xlarge)}._click-outside_yiz3b_7{background-color:var(--dig-color__utility__overlay)}._outer-wrapper_yiz3b_11{background:var(--dig-color__background__subtle);border-radius:var(--dig-radius__xlarge)}._modal-inner-wrapper_yiz3b_16{padding:var(--dig-spacing__micro__medium)}._modal-inner-wrapper-main-exit_yiz3b_20{animation:_shrink-main-overlay_yiz3b_1 var(--duration__surface) var(--easing__transition) forwards;visibility:hidden}._inner-wrapper_yiz3b_25{padding:var(--dig-spacing__micro__small)}._button-row_yiz3b_29{display:flex;gap:var(--dig-spacing__micro__medium);padding:var(--dig-spacing__dimension__6)}._button-row-bmus-qr_yiz3b_35._button-row_yiz3b_29{gap:var(--dig-spacing__micro__small)}._button-row-bmus-qr_yiz3b_35._button-row_yiz3b_29 button{min-width:32px}._button-row-button-wrapper_yiz3b_44{max-width:50%;width:50%}._utility-button-row_yiz3b_49{align-items:center;justify-content:flex-end}._footerFileOrFolderInfoContainer_yiz3b_54{padding:12px}._footerFileOrFolderInfoContainer_yiz3b_54,._redesignedFooterFileOrFolderInfoContainer_yiz3b_63{align-items:flex-start;display:flex;flex:1 0 0;flex-direction:column;justify-content:center}._redesignedFooterFileOrFolderInfoContainer_yiz3b_63{padding-left:var(--dig-spacing__micro__medium)}._footerFilerOrFolderInfo_yiz3b_72{line-height:18px;max-width:272px;width:100%}._footerFilerOrFolderInfoBmusQrCode_yiz3b_78{max-width:calc(224px - var(--dig-spacing__micro__medium))}._header-section_yiz3b_83{align-items:center;display:flex;margin-bottom:-6px;padding:18px 12px 0 18px}._header-section-text-container_yiz3b_90{line-height:18px;max-width:272px;width:100%}._header-section-back-button_yiz3b_96{margin-right:16px}._header-section-primary-text_yiz3b_100{font-family:var(--dig-type__family__title)}._header-section-button-container_yiz3b_104{align-items:center;display:flex;margin-left:auto}._header-section-right-container_yiz3b_112{display:flex;margin-left:auto}._overlay-main-exit_yiz3b_118 ._outer-wrapper_yiz3b_11{animation:_shrink-main-overlay_yiz3b_1 var(--duration__surface) var(--easing__transition) forwards;visibility:hidden}._inband-screen-expand_yiz3b_124{animation:_expand-outer-wrapper-inband_yiz3b_1 var(--duration__micro-fast) var(--easing__transition)}._qr-screen-expand_yiz3b_129{animation:_expand-qr-screen_yiz3b_1 var(--duration__surface) var(--easing__transition) 0s forwards,_fade-in_yiz3b_1 var(--duration__surface) var(--easing__enter) var(--duration__surface) forwards;opacity:0}._handle_yiz3b_138{background-color:var(--dig-color__secondary__surface--state-2);border-radius:8px;height:6px;left:0;margin:8px auto 12px;right:0;width:100px}._header-container_yiz3b_151{align-items:flex-start;display:flex;height:38px;justify-content:flex-end;width:100%}._rounded-corner_yiz3b_159{border-top-left-radius:16px;border-top-right-radius:16px}._drawer-body_yiz3b_168,._drawer-header_yiz3b_164{background-color:inherit}._drawer-body_yiz3b_168{margin-bottom:14px}._drawer-outer-wrapper_yiz3b_173{--utility-icon-button-height:48px;background:var(--dig-color__background__subtle);border-radius:inherit;height:100%}@keyframes _expand-outer-wrapper-inband_yiz3b_1{0%{max-height:250px}to{max-height:320px}}@keyframes _shrink-main-overlay_yiz3b_1{0%{max-height:274px}to{max-height:72px}}@keyframes _expand-qr-screen_yiz3b_1{0%{max-height:70px}to{max-height:475px}}@keyframes _fade-in_yiz3b_1{0%{opacity:0}to{opacity:1}}"));t.AccessLevelWeight={viewer_no_comment:-10,viewer:1,editor:2,owner:3},t.Context=Ya,t.Context$1=Ba,t.Context$2=$a,t.Context$3=Pa,t.DEFAULT={".tag":"default"},t.EDITOR=Ka,t.EDITOR$1=ye,t.Emstring=$,t.Inband=Xi,t.LoadingScreen=Zi,t.MetadataProvider=Ft,t.NO_ONE=ve,t.PAP_Select_FlexibleSharingEntrypointAction=qa,t.PUBLIC=Ae,t.SharingSdkProvider=e=>f.default.createElement(i.SafeQueryClientProviderWrapper,null,f.default.createElement(Oa,{...e})),t.SharingSettingsUtil=e=>({getLinkPolicy:e=>({link_password:M(e.link_permissions)?void 0:"",expires:e.expires,allow_download:e.link_permissions.allow_download,audience:k(e.link_permissions),require_password:e.link_permissions.require_password}),getModifiedSettings:(t,a,r)=>{if(a===r)return;const n={},i=null!=t.expires&&null==a.expires;if(a.audience!==r.audience&&(n.audience=a.audience),a.allow_download!==r.allow_download&&(n.allow_download=a.allow_download),a.expires&&t.link_permissions.can_set_expiry&&(n.expires=a.expires.toISOString().split(".")[0]+"Z"),a.require_password!==r.require_password&&(n.require_password=a.require_password),"password"===a.audience||a.require_password)if(a.link_password)n.require_password=!0,n.link_password=a.link_password;else if(""===a.link_password)return{error:e.formatMessage({id:"wFrAfD",defaultMessage:"Password can’t be empty"})};return Object.keys(n).length<=0&&!i?void 0:{url:t.url,settings:n,remove_expiration:i}}}),t.TEAM=Se,t.VIEWER=Wa,t.VIEWER$1=fe,t.action=_n,t.action$1=un,t.buttonRow="_button-row_yiz3b_29",t.buttonRowButtonWrapper="_button-row-button-wrapper_yiz3b_44",t.canCreateLink=function(e,t,a,r,n,i,o,s,_,l,d,c){switch(e){case"editor":return a?i&&H(r,c)&&!n:H(r,c)&&_;case"viewer":return!("writer"===l&&!d)&&(t?s:H(r,c)&&s||o);default:return!1}},t.canCreateLinksForFolder=H,t.canModifyExpire=function(e){const t=e.link_permissions;return Boolean(t.can_set_expiry)},t.canModifyPassword=function(e){return Boolean(e&&e.can_set_password)||L(e)},t.canToggleExpire=function(e){const t=e.link_permissions;return Boolean(null!=e.expires?t.can_remove_expiry:t.can_set_expiry)},t.canTogglePassword=function(e){return Boolean(e&&e.require_password?e.can_remove_password:e.can_set_password)||L(e)},t.classes={overlay:"_overlay_yiz3b_1",clickOutside:"_click-outside_yiz3b_7",outerWrapper:"_outer-wrapper_yiz3b_11",modalInnerWrapper:"_modal-inner-wrapper_yiz3b_16",modalInnerWrapperMainExit:"_modal-inner-wrapper-main-exit_yiz3b_20",shrinkMainOverlay:"_shrink-main-overlay_yiz3b_1",innerWrapper:"_inner-wrapper_yiz3b_25",buttonRow:"_button-row_yiz3b_29",buttonRowBmusQr:"_button-row-bmus-qr_yiz3b_35",buttonRowButtonWrapper:"_button-row-button-wrapper_yiz3b_44",utilityButtonRow:"_utility-button-row_yiz3b_49",footerFileOrFolderInfoContainer:"_footerFileOrFolderInfoContainer_yiz3b_54",redesignedFooterFileOrFolderInfoContainer:"_redesignedFooterFileOrFolderInfoContainer_yiz3b_63",footerFilerOrFolderInfo:"_footerFilerOrFolderInfo_yiz3b_72",footerFilerOrFolderInfoBmusQrCode:"_footerFilerOrFolderInfoBmusQrCode_yiz3b_78",headerSection:"_header-section_yiz3b_83",headerSectionTextContainer:"_header-section-text-container_yiz3b_90",headerSectionBackButton:"_header-section-back-button_yiz3b_96",headerSectionPrimaryText:"_header-section-primary-text_yiz3b_100",headerSectionButtonContainer:"_header-section-button-container_yiz3b_104",headerSectionRightContainer:"_header-section-right-container_yiz3b_112",overlayMainExit:"_overlay-main-exit_yiz3b_118",inbandScreenExpand:"_inband-screen-expand_yiz3b_124",expandOuterWrapperInband:"_expand-outer-wrapper-inband_yiz3b_1",qrScreenExpand:"_qr-screen-expand_yiz3b_129",expandQrScreen:"_expand-qr-screen_yiz3b_1",fadeIn:"_fade-in_yiz3b_1",handle:"_handle_yiz3b_138",headerContainer:"_header-container_yiz3b_151",roundedCorner:"_rounded-corner_yiz3b_159",drawerBody:"_drawer-body_yiz3b_168",drawerHeader:"_drawer-header_yiz3b_164",drawerOuterWrapper:"_drawer-outer-wrapper_yiz3b_173"},t.clickOutside="_click-outside_yiz3b_7",t.complete=zr,t.completeWithUndo=Gr,t.convertContactToInviteTarget=e=>e.type===i.ContactTypes.EMAIL?e.name&&e.name.length?{".tag":"user",dbx_team_id:e.dbx_team_id||"",...void 0!==e.photo_url?{photo_url:e.photo_url}:{},name:e.name,sort_key:e.name,dbx_account_id:e.dbx_account_id||"",email:e.email||""}:G(e.email||""):e.type===i.ContactTypes.NEW_STYLE_GROUP?{".tag":"group",dbx_team_id:e.dbx_team_id||"",members:e.members||"",name:e.name,sort_key:e.name,group_id:e.group_id||"",group_size:e.group_size||0}:e.type===i.ContactTypes.DBX_ID?{".tag":"user",dbx_team_id:e.dbx_team_id||"",...void 0!==e.photo_url?{photo_url:e.photo_url}:{},name:e.name,sort_key:e.name,dbx_account_id:e.dbx_account_id||"",email:e.email||""}:G(""),t.convertContentInfoToObjectIdentifier=e=>{var t,a,r,n;return e.isSharedFolder()?{".tag":"shared_folder",sharedFolderId:String(e.sharedFolderId()),fileId:null!==(t=e.fileId())&&void 0!==t?t:""}:e.isFileFolder()?{".tag":"file_folder",name:e.name(),path:null!==(a=e.displayPath())&&void 0!==a?a:"",fileId:null!==(r=e.fileId())&&void 0!==r?r:""}:{".tag":"file",fileId:null!==(n=e.fileId())&&void 0!==n?n:""}},t.convertInviteTargetToContact=ot,t.convertLinkAccessLevelToSdkLinkAccessLevel=lt,t.convertLinksMetadataToSdkLinksMetadata=e=>{if(void 0===e)throw new Error("Adapt error");const t=[];for(const s of e)t.push((r=void 0,n=void 0,o=void 0,{".tag":(a=s).file_type,url:a.url,id:a.id,name:a.name,expires:i.convertExpirationDateToString(a.expires),path_lower:a.path_lower,link_permissions:(n=a.link_permissions,{resolved_visibility:n.resolved_visibility?(o=n.resolved_visibility,"public"===o?Y:"team_only"===o?Z:"password"===o?J:"team_and_password"===o?Q:"shared_folder_only"===o?X:"no_one"===o?ee:"only_you"===o?te:i.exhausts(o,ae)):void 0,requested_visibility:n.requested_visibility?dt(n.requested_visibility):void 0,can_revoke:n.can_revoke,visibility_policies:[],can_set_expiry:n.can_set_expiry,can_remove_expiry:n.can_remove_expiry,allow_download:n.allow_download,can_allow_download:n.can_allow_download,can_disallow_download:n.can_disallow_download,restricting_shared_folder_path:n.restricting_shared_folder_path,allow_comments:n.allow_comments,team_restricts_comments:n.team_restricts_comments,effective_audience:n.effective_audience?ct(n.effective_audience):void 0,audience_options:It(n.audience_options),link_access_level:lt(n.link_access_level),can_set_password:n.can_set_password,can_remove_password:n.can_remove_password,require_password:n.require_password,can_use_extended_sharing_controls:n.can_use_extended_sharing_controls,days_to_expire_policy:Rt(n.days_to_expire_policy),change_shared_link_expiration_policy:wt(n.change_shared_link_expiration_policy),enforce_shared_link_password_policy:Ct(n.enforce_shared_link_password_policy)}),team_member_info:a.team_member_info?(r=a.team_member_info,{team_info:Mt(r.team_info),display_name:r.display_name,member_id:r.member_id}):void 0,content_owner_team_info:a.content_owner_team_info?Mt(a.content_owner_team_info):void 0,preview_type:a.preview_type}));var a,r,n,o;return{links:t,has_more:!1}},t.convertSharingInfoToSdkAccountMetadata=e=>{const t=e.user();return{user_id:t.id,email:t.email,account_id:t.account_id,root_info:{".tag":"user",root_namespace_id:"ns_id",home_namespace_id:"ns_id"},is_paid:!!t.paid,role:t.role,is_family_user:!0===e.isFamilyUser(),is_team_member:!!t.is_team,team_policies:pt(e.teamPolicy()),team_id:t.team_dbtid,is_team_admin:t.is_team_admin,team_name:t.team_name,can_use_extended_sharing_controls:!0===e.canUseExtendedSharingControls(),is_tmr_member:t.is_tmr_member,is_paired:!0===e.isPaired()}},t.convertSharingInfoToSdkInviteTargetValidation=(e,t)=>{const a=t.recipientAccess(),r=t.recipientValidation()[a]||{},n=e.map(ot).map((e=>e.getKey())),i=e.map(j),o=i.reduce(((e,t,a)=>({[t]:r[n[a]],...e})),{});return i.reduce(((e,t)=>{const a=o[t];if(!a)return e;const r={member:{".tag":"other"},result:st(a),target_invite_eligibility:{".tag":"other"}};return{...e,[t]:r}}),{})},t.convertSharingInfoToSdkObjectMetadata=e=>mt(e.metadata(),!0===e.contentInfo().isFolderInsideTeamFolderTree(),!0===e.contentInfo().isTeamSharedFolder()),t.convertSharingInfoToSdkSharingPrefs=e=>{const t=e.sharingPrefs();if(void 0===t)throw new Error("Adapt error");return{invite_after_sharing_modal_variant:Lt(t.invite_after_sharing_modal_variant),has_seen_esign_post_sharing:t.has_seen_esign_post_sharing,is_in_esign_post_sharing_exclusion_period:t.is_in_esign_post_sharing_exclusion_period,bsx_organize_around_people:t.bsx_organize_around_people,is_showing_file_upload_toolkit_campaign:t.is_showing_file_upload_toolkit_campaign,default_sharing_access_level_setting:t.default_sharing_access_level_setting,default_sharing_link_audience_setting:t.default_sharing_link_audience_setting,last_seen_team_policy_audience:t.last_seen_team_policy_audience,capture_sdk_integration_voice_overs_variant:t.capture_sdk_integration_voice_overs_variant,core_act_docsend_advanced_sharing:t.core_act_docsend_advanced_sharing,create_view_file_link_enabled:t.create_view_file_link_enabled,create_view_folder_link_enabled:t.create_view_folder_link_enabled,num_available_licenses:t.num_available_licenses}},t.convertSharingInfoToSdkUser=e=>{const t=e.user();return{id:t.id,email:t.email,is_team:!!t.is_team,is_team_admin:t.is_team_admin,account_id:t.account_id,team_dbtid:t.team_dbtid,is_tmr_member:t.is_tmr_member}},t.create=Zr,t.createFromEmail=G,t.createSdkObjectMetadata=mt,t.daysAfterToday=e=>{const t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),((e,t,a,r,n,i)=>(null==t&&(t=0),null==a&&(a=0),null==r&&(r=0),null==n&&(n=0),null==i&&(i=0),e.setFullYear(e.getFullYear()+t),e.setMonth(e.getMonth()+a),e.setDate(e.getDate()+r),e.setHours(e.getHours()+n),e.setMinutes(e.getMinutes()+i),e))(t,0,0,e)},t.daysExpirationPolicyToNumber=N,t.define=_a,t.drawerBody="_drawer-body_yiz3b_168",t.drawerHeader="_drawer-header_yiz3b_164",t.drawerOuterWrapper="_drawer-outer-wrapper_yiz3b_173",t.fail=jr,t.failure=Jr,t.failureExhaustsAllTypes=Xr,t.failureUncaughtException=en,t.formatSubTitle=K,t.formatUrl=qt,t.getAreMemberSelectorsEqual=(e,t)=>!(!e||!t)&&("dropbox_id"===e[".tag"]&&"dropbox_id"===t[".tag"]?e.dropbox_id===t.dropbox_id:"email"===e[".tag"]&&"email"===t[".tag"]?e.email===t.email:"other"===e[".tag"]&&"other"===t[".tag"]),t.getAudienceForLink=k,t.getAvatarUrl=W,t.getContentIdOrPathFromObjectIdentifier=b,t.getDoesServiceHavePermissionGranted=li,t.getGroupInitials=gi,t.getInviteAfterSharingUsers=V,t.getIsServiceConnected=_i,t.getIsTeam=za,t.getIsTeamAdmin=e=>za(e)&&!!e.is_team_admin,t.getLinkControlPolicyWarningText=function(e,t,a,r){let n="";if(F(e,a)){const e=P(a),t=D(a);n=r.formatMessage({id:"GoACO+",defaultMessage:"Your admin requires {requirements, select, 0 {an expiration and a password} 1 {a password} 2 {an expiration} other{}} for links shared outside the team. To change the link setting, delete the link and create it again."},{requirements:e&&t?0:t?1:2})}else t.display_expiration_warning?n=r.formatMessage({id:"ySRXj8",defaultMessage:"Your admin {show_password_text, select, true {requires a password and } other {}}has set an expiration for all links shared outside the team. This link will expire in {days_to_expire, plural, =365 {1 year} one {# day} other {# days}}.{expiration_enforced, select, true { You can change or remove this expiration.} other {}}"},{days_to_expire:N[a.days_to_expire_policy],expiration_enforced:"allowed"===a.change_shared_link_expiration_policy,show_password_text:!!t.display_password_warning}):t.display_password_warning&&(n=r.formatMessage({id:"lcVbzE",defaultMessage:"Your admin requires to set a password for links shared outside the team."}));return n},t.getProperties=Va,t.getProperties$1=Ha,t.getProperties$2=Ja,t.getTags=Ua,t.getTags$1=Fa,t.getTags$2=Za,t.getUniqueId=Hr,t.getUniqueId$1=j,t.getUserDefaultCopyLinkAccessLevel=e=>{const t=e.default_sharing_access_level_setting;if(!t)return i.EDITOR;switch(t[".tag"]){case i.SharingAccessLevel.UNKNOWN:case i.SharingAccessLevel.EDIT:return ye;case i.SharingAccessLevel.VIEW:return fe;default:return ye}},t.getUserDefaultCopyLinkAudienceLevel=e=>{const t=e.default_sharing_link_audience_setting;if(!t)return Ae;switch(t[".tag"]){case i.SharingLinkAudience.NO_ONE:return ve;case i.SharingLinkAudience.TEAM:return Se;case i.SharingLinkAudience.UNKNOWN:case i.SharingLinkAudience.PUBLIC:default:return Ae}},t.getUserInitials=mi,t.handle="_handle_yiz3b_138",t.handler=sa,t.hasLinkPassword=M,t.headerSection="_header-section_yiz3b_83",t.inProgress=Kr,t.isExpirationPolicyEnforcedByAdmin=P,t.isExpirationPolicySetByAdmin=x,t.isExternalAudience=O,t.isMemberInviteModal=B,t.isPasswordPolicyEnforcedByAdmin=D,t.isReadOnlyPolicy=F,t.isTmrMember=Ga,t.isUserOnSameTeamAsObject=ja,t.isUserOnSameTeamAsTmrTeamFolder=(e,t)=>Ga(e)&&ja(e,t)&&i.getIsTeamSharedFolder(t),t.listLinkedServices=di,t.modalInnerWrapper="_modal-inner-wrapper_yiz3b_16",t.modalInnerWrapperMainExit="_modal-inner-wrapper-main-exit_yiz3b_20",t.outerWrapper="_outer-wrapper_yiz3b_11",t.overlay="_overlay_yiz3b_1",t.overlayMainExit="_overlay-main-exit_yiz3b_118",t.poll=rn,t.roundedCorner="_rounded-corner_yiz3b_159",t.shouldShowModalVariant=z,t.success=Qr,t.targetsSearch=ui,t.useAction=tn,t.useEndpoint=Aa,t.useLogger=Pt,t.useOpenUrl=Qt,t.usePlatform=Gt,t.useRedirectWindowToken=Wt,t.useSharingAccountInfo=Qa,t.useSharingPrefs=wr,t.useShowGenericRequestFailureMessage=()=>{const e=r.useIntl(),t=(()=>{const e=r.useIntl(),t=ta();return f.useCallback((a=>t((t=>f.createElement(i.Snackbar$1,{...t},f.createElement(i.Snackbar$1.Message,null,a),f.createElement(i.Snackbar$1.Actions,null,f.createElement(i.Button,{variant:"transparent",inverse:!0},Xt(e))))))),[e,t])})();return f.useCallback((()=>t(e.formatMessage({id:"+iNJRS",defaultMessage:"There was a problem completing this request."}))),[e,t])},t.useSnackbar=()=>{const e=r.useIntl(),a=ta(),n=Qt(),o=Gt()===t.Platforms.DESKTOP,s=o?{style:{position:"absolute",bottom:-13,left:0,right:0,borderRadius:0,minHeight:"unset"}}:{};return{showCompleted:t=>a((a=>f.createElement(i.Snackbar$1,{...a,...s,timeout:o?0:void 0,className:"sharingSdkSnackbar"},f.createElement(i.UIIcon,{src:i.CheckmarkLine}),f.createElement(i.Snackbar$1.Message,null,t.message),t.actionMessage&&t.actionOnClick&&f.createElement(i.Snackbar$1.Actions,null,f.createElement(i.Button,{variant:"transparent",onClick:t.actionOnClick},t.actionMessage)),f.createElement(i.Snackbar$1.Actions,null,f.createElement(i.Button,{variant:"transparent",onClick:a.onRequestClose},Xt(e)))))),showInProgress:e=>a((t=>f.createElement(i.Snackbar$1,{...t,...s,timeout:0,className:"sharingSdkSnackbar"},f.createElement(i.Spinner,{size:"small"}),f.createElement(i.Snackbar$1.Message,null,e.message)))),showFailure:t=>a((a=>{const r=qt(t.helpUrl||""),_=f.useCallback((()=>{n(r)}),[r]);return f.createElement(i.Snackbar$1,{...a,...s,timeout:o?0:void 0,className:"sharingSdkSnackbar"},f.createElement(i.UIIcon,{src:i.FailLine}),f.createElement(i.Snackbar$1.Message,null,t.message),f.createElement(i.Snackbar$1.Actions,null,t.helpMessage&&t.helpUrl?f.createElement(i.Button,{variant:"transparent",onClick:_},t.helpMessage):null,f.createElement(i.Button,{variant:"transparent",onClick:a.onRequestClose},Xt(e))))}))}}}));
//# sourceMappingURL=c_common_components_layout.js-vflLFup-h.map

//# debugId=5985efbb-2e3e-314e-9ca5-c8b7cc0dbe5c