!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="1da867ba-3d1a-3169-a160-49367d08a98a")}catch(e){}}();
define(["exports","./c_spectrum_util_raf_throttle","react","./c_core_i18n","./c_spectrum_modal_utility_modal","./e_file_viewer_static_scl_page_file","./c_core_notify","./c_init_data_debug_panel","./c_api_v2_client_base","./c_spectrum_button","./c_ui_image","./c_cloud_docs_open_with_utils","./c_lodash-es_lodash","./c_dig-icons_assets_ui-icon_line_shuffle","./c_api_v2_routes_password_confirmation_provider"],(function(e,t,n,i,a,o,s,r,l,c,d,p,u,_,m){"use strict";function f(e){return e&&e.__esModule?e:{default:e}}var h,g,y=f(n),x="https://"+t.computeDomains(null!==(h=window.__DEV_SERVER_HOSTNAME__)&&void 0!==h?h:"")[0].WEB_STATIC_CLOUDFLARE_CDN_HOST+"/static/metaserver/static/images/generic_app_icon-vflIPYT1H.png",A="https://"+t.computeDomains(null!==(g=window.__DEV_SERVER_HOSTNAME__)&&void 0!==g?g:"")[0].WEB_STATIC_CLOUDFLARE_CDN_HOST+"/static/metaserver/static/js/extensions/dbx_cloud_doc_loading-vfl9ZK2NS.gif";const E=o.requireCssWithComponent((e=>y.default.createElement("div",{className:"app-actions-status-page"},y.default.createElement(d.Image,{className:"app-actions-status-image",src:A}),y.default.createElement("div",{className:"app-actions-status-detail"},e.fileName))),["/static/metaserver/static/css/app_actions/status_page-vflxeNuOK.css","/static/metaserver/static/css/components/loading_indicator-vflIkyDZA.css"]);class w extends y.default.Component{constructor(e){super(e),this.clickAuthorize=()=>{this.currentSession.event("auth_accept",{action_id:this.props.actionId}),this.props.doAuth()},this.learnMoreOnClick=()=>{this.currentSession.event("learn_more",{action_id:this.props.actionId}),this.props.onLearnMore&&this.props.onLearnMore()},this.telemetryClient=o.createTelemetryClient({component:"auth_v2"})}componentDidMount(){this.currentSession.event("auth_start",{action_id:this.props.actionId})}renderText(){const e=0!==this.props.fileId.length?i.defineMessage({id:"VDSuu6",defaultMessage:"<b>{app_name}</b> needs access to this file"}):i.defineMessage({id:"mZo8K4",defaultMessage:"<b>{app_name}</b> needs access to files you select"}),t=0!==this.props.fileId.length?i.defineMessage({id:"hE6l1Q",defaultMessage:"Changes to this file using {app_name} will save back to Dropbox. This app will have access to the username, email address, and country for your account."}):i.defineMessage({id:"HsAedA",defaultMessage:"Changes to selected files using {app_name} will save back to Dropbox. This app will have access to the username, email address, and country for your account."});return y.default.createElement("div",null,y.default.createElement("div",{className:"auth-text-header-v2"},i.intl.formatMessage(e,{app_name:this.props.appName,b:e=>y.default.createElement("b",null,e)})),y.default.createElement("div",{className:"auth-text-v2"},i.intl.formatMessage(t,{app_name:this.props.appName}),y.default.createElement("a",{className:"learn-more-link",href:"/help/security/third-party-apps",target:"_blank",rel:"noopener noreferrer",onClick:this.learnMoreOnClick},i.intl.formatMessage({id:"gk12sS",defaultMessage:"Learn more"}))))}renderButtons(){return y.default.createElement("div",null,y.default.createElement(c.Button,{variant:"primary",className:"auth-button-v2",onClick:this.clickAuthorize},i.intl.formatMessage({id:"LGeX5c",defaultMessage:"Allow"})))}renderAuthorization(){const{appName:e,iconUrl:t}=this.props;return y.default.createElement("div",{id:"auth",className:"auth-connect-frame-v2"},y.default.createElement("div",null,y.default.createElement("img",{className:"app-icon-v2",src:t,alt:e})),y.default.createElement("div",null,this.renderText()),y.default.createElement("div",{id:"buttons"},this.renderButtons()))}render(){const{fileName:e}=this.props;return this.currentSession=this.telemetryClient.session({ext:o.getPiiSafeExtension("."+o.file_extension(e))}),this.props.showLoadingUI?y.default.createElement(E,{fileName:e}):this.renderAuthorization()}}w.displayName="AuthBodyV2Component";const I=o.requireCssWithComponent(w,["/static/metaserver/static/css/spectrum/index.web-vfl6Hbk66.css","/static/metaserver/static/css/foundation-vflH6wwwv.css","/static/metaserver/static/css/app_actions/index-vflR8Wunv.css"]),b=function(e){return y.default.createElement("span",{className:"uxa-modal uxa-modal-tracking-span",id:e.id,style:{display:"none"}})},v=e=>y.default.createElement(o.Modal,{className:"extensions-auth-modal-v2",ariaLabel:"Access Modal",displayCloseButton:!0,clickOutToClose:!1,style:"clean",onDismiss:e.doCancel},y.default.createElement(b,{id:"EXTENSIONS_AUTH_MODAL_V2"}),y.default.createElement(I,{...e}));function O(e){return"gdoc"===e?o.GoogleFileTypes.GOOGLE_DSS_DOC:"gsheet"===e?o.GoogleFileTypes.GOOGLE_DSS_SHEET:"gslides"===e?o.GoogleFileTypes.GOOGLE_DSS_SLIDES:"word"===e?o.MicrosoftEditors.WORD:"excel"===e?o.MicrosoftEditors.EXCEL:"powerpoint"===e?o.MicrosoftEditors.POWERPOINT:"preview"}function M(e){return["fp_action_id:word_online","fp_action_id:excel_online","fp_action_id:powerpoint_online"].indexOf(e.id)>=0}function N(e){var t,n,i;const a=null!==(t=null==e?void 0:e.path)&&void 0!==t?t:"/aa/loading",s=null!==(n=null==e?void 0:e.routeParams)&&void 0!==n?n:{},r=null!==(i=null==e?void 0:e.base)&&void 0!==i?i:window.location.origin;return new o.AjaxURL(o.replacePattern(a,s),r)}async function D(e,n,i){const a=new l.FetchAsyncTransport,o=new r.URI({scheme:"https",authority:t.getDomains().WEBSERVER,path:"/2/app_actions/"+n}),s={};s["X-Dropbox-Path-Root"]=e.root_ns_id.toString(),s["X-Dropbox-Uid"]=e.id.toString();const c=r.readCsrfToken();if(!c)throw new Error("No CSRF cookie");return s["X-CSRF-Token"]=c,a.executeRpc(o,s,JSON.stringify(i),"application/json")}async function S(e,t,n){const i=await D(e,t,n),a={request_id:i.headers["x-dropbox-request-id"],redirect_url:i.result.redirect_url};return"link_state"in i.result&&(a.link_state=i.result.link_state),a}function T(e,t){if(1!==e.length)throw new Error(`Expected single file: ${t}`);return e[0]}async function C(e,t,n,i,a,s){if("redirect"===n.handler[".tag"]){const i=n.handler.window_params;let a;if("popup"===i[".tag"]){const{width:e,height:t}=i;a=`width=${e},height=${t}`}if("sfa_unlinked"===n.link_state[".tag"]&&!n.id.startsWith("fp_action_id:")){const i=T(t,"first party actions do not support multiple files yet."),s=o.filename(i.ns_path);!function(e,t,n,i,a,s){o.Modal.showInstance(y.default.createElement(v,{actionId:e,appName:t,iconUrl:n,fileId:i,fileName:a,doAuth:s,doCancel:o.Modal.close}))}(n.id,n.description,n.icon.url,i.file_id,s,(()=>{o.Modal.close(),async function(e,t,n,i,a){const s=await async function(e,t,n,i,a){const o=()=>S(e,"authorize",{action_id:t,file_id:i});return await k(e,t,n,i,o,a)}(e,t,n,i,a);s&&s.link_state&&o.updateLinkStateForAction(t,s.link_state)}(e,n.id,n.description,i.file_id,a)}))}else{const i=t.map((e=>e.file_id));!async function(e,t,n,i,a){await k(e,t,n,i[0],(()=>S(e,"redirect",{action_id:t,file_ids:i})),a)}(e,n.id,n.description,i,a)}}else if("cloud_editor"===n.handler[".tag"]){const i=T(t,"cloud docs actions do not support multiple files yet."),o=a?p.getActionSourceFromSurface(a.surface):void 0,s=O(n.handler.editor_name);p.openWithCloudEditor(p.fileToOpenWithParams(i),e,s,!1,o)}else{if("profile_service"!==n.handler[".tag"])throw new Error(`Unexpected handler "${n.handler[".tag"]}"`);if(s){const i=T(t,"profile service actions do not support multiple files yet.");s(e,i,n)}}}async function k(e,t,n,a,r,l){const c=`action_redirect_${Math.random().toString(16).substring(2)}`,d=window.open("",c,l);d&&(d.document.open("text/html","replace"),d.document.write(`<html><head><title>${u.escape(n)}</title></head></html>`),d.document.close());let p=!1;const _=new Promise((i=>{o.SilentBackgroundRequest({url:N(),subject_user:e.id,data:{file_id:a,action_id:t},success:e=>{!p&&d?(d.document.open("text/html","replace"),d.document.write(e),d.document.close(),d.document.title=n,i()):i()},error:()=>{i()}})}));const[,m]=await Promise.all([_,async function(){try{return await r()}catch(e){return void(p=!0)}}()]),f=m&&m.redirect_url||"/aa/error";if(d)d.location.replace(f);else{const e=window.open(f,"_blank",l),t=window.location.href.startsWith("https://www.dropbox.com/desktop_preview");if(!e&&!t){const e=n;s.Notify.error(i.intl.formatMessage({id:"TFhSer",defaultMessage:"Failed to open {app_name}"},{app_name:e}))}}return m}var B;!function(e){e[e.UNVERIFIED=0]="UNVERIFIED",e[e.IN_DEVELOPMENT=1]="IN_DEVELOPMENT",e[e.ENABLED=2]="ENABLED",e[e.DISABLED=3]="DISABLED"}(B||(B={}));o.injectInternalStyle("/static/metaserver/static/js/extensions/extensions_mini_directory_modal.module.out-vflZYkv8L.css",(e=>"._extensions-mini-directory-modal_tgmgc_1{display:flex;flex-direction:column;left:auto;margin:100px auto;max-height:604px;position:static;top:auto;transform:none;width:500px}._extensions-mini-directory-modal-overlay_tgmgc_15{z-index:501}._extensions-mini-directory-modal_tgmgc_1>.mc-modal-body{height:100%}._body-wrapper_tgmgc_24{display:flex;flex-direction:column;height:100%;overflow:hidden}._header-border_tgmgc_31{border-bottom:1px solid var(--color__standard__border)}._title_tgmgc_35{padding-left:24px;padding-right:24px;padding-top:24px}._search-bar_tgmgc_41{margin:16px 24px 8px}._empty-search-app-center_tgmgc_45{align-items:center;display:flex;flex-direction:column;margin-top:172px}._directory-entry-point_tgmgc_52{border-top:1px solid var(--color__standard__border);box-sizing:border-box;flex-grow:0;flex-shrink:0;height:80px;padding-bottom:30px;padding-left:20px;padding-top:28px}._directory-entry-point-text-border_tgmgc_63{border-bottom:1px solid var(--color__standard__border)}._extensions-container_tgmgc_67{display:flex;flex-direction:column;flex-grow:1;overflow-y:auto}._extension-section_tgmgc_74{border:none;box-sizing:border-box;display:flex;flex-direction:row;flex-shrink:0;height:96px;margin:0 24px}._extension-section_tgmgc_74:not(:last-of-type){border-bottom:1px solid var(--color__standard__border)}._extensions-icon_tgmgc_88{flex-shrink:0;height:48px;margin-bottom:24px;margin-right:16px;margin-top:20px;object-fit:contain;width:48px}._extensions-description-link_tgmgc_98{display:block}._extensions-description_tgmgc_98{display:flex;flex-direction:column;flex-grow:1;margin:16px 0 14px;width:100%}._extensions-short-description_tgmgc_110{-webkit-box-orient:vertical;-webkit-line-clamp:2;display:-webkit-box;max-height:40px;overflow:hidden}._redirect-button-wrapper_tgmgc_118{flex-shrink:0;margin-bottom:40px;margin-left:16px;margin-top:20px}._redirect-button_tgmgc_118{height:32px;min-width:100px}._body-loading_tgmgc_130{align-items:center;display:flex;height:100%;justify-content:center}"));const L="_extensions-mini-directory-modal_tgmgc_1",U="_extensions-mini-directory-modal-overlay_tgmgc_15",F="_body-wrapper_tgmgc_24",H="_header-border_tgmgc_31",P="_title_tgmgc_35",R="_search-bar_tgmgc_41",W="_empty-search-app-center_tgmgc_45",V="_directory-entry-point_tgmgc_52",$="_directory-entry-point-text-border_tgmgc_63",G="_extensions-container_tgmgc_67",z="_extension-section_tgmgc_74",q="_extensions-icon_tgmgc_88",j="_extensions-description-link_tgmgc_98",K="_extensions-description_tgmgc_98",Q="_extensions-short-description_tgmgc_110",X="_redirect-button-wrapper_tgmgc_118",J="_redirect-button_tgmgc_118",Y="_body-loading_tgmgc_130",Z=e=>"api_app"===e[".tag"]?`${e[".tag"]}/${e.api_app}`:"first_party_app"===e[".tag"]?`${e[".tag"]}/${e.first_party_app}`:`${e[".tag"]}`;function ee(){return y.default.createElement("div",{className:V},y.default.createElement(o.Link,{href:"/apps",hasNoUnderline:!0,variant:"monochromatic",className:$},y.default.createElement(o.Text,{isBold:!0},i.intl.formatMessage({id:"LbLi52",defaultMessage:"View all apps"}))))}class te extends y.default.Component{constructor(e){super(e),this.hasUsedSearchBar=!1,this.onScroll=u.throttle((e=>{e>0&&!this.state.showTopBorder&&this.setState({showTopBorder:!0}),0===e&&this.state.showTopBorder&&this.setState({showTopBorder:!1})}),20),this.createClickHandler=e=>()=>{o.Modal.close();const{user:t,file:n,featureFlags:i,currentSession:a,telemetryContext:s,onProfileServiceAuth:r}=this.props;if(C(t,[n],e,0,s,r),"redirect"===e.handler[".tag"])o.logEvent$1(a,"select_action",o.getAppActionExtras(e));else if("cloud_editor"===e.handler[".tag"]){const t=M(e)?o.OpenButtonAction.OPEN_WITH:o.OpenButtonAction.OPEN_WITH_CLOUD_DOC;o.logEvent$1(this.props.currentSession,"select_legacy_action",{type:t})}},this.handleQueryChange=e=>{const t=e.currentTarget.value;this.setState({searchKey:t}),this.hasUsedSearchBar||(o.logEvent$1(this.props.currentSession,"start_searching",{}),this.hasUsedSearchBar=!0)},this.filterActions=()=>{const{appActions:e,categoryIdToInfos:t}=this.props,n=this.state.searchKey.trim().toLowerCase(),i=e.map((e=>e.category)).map((e=>t[e])).filter((e=>-1!==e.display_name.toLowerCase().indexOf(n))).map((e=>e.id));return e.filter((e=>{const t=this.getAppDirectoryPageInfo(e);return((e,t)=>t||e.app_directory_id&&"first_party_app"===e.app_directory_id[".tag"]||e.developer_state===B.IN_DEVELOPMENT)(e,t)&&(-1!==e.description.toLowerCase().indexOf(n)||(e=>!(!e||!e.short_description)&&-1!==e.short_description.toLowerCase().indexOf(n))(t)||i.includes(e.category))}))},this.clearSearch=()=>{this.setState({searchKey:""})},this.renderExtensionItem=e=>{const t=e.icon,n=t.is_static?x:t.url,a=o.isLinked(e),s=a?"primary":"opacity",r=a?o.isShareAction(e)?i.intl.formatMessage({id:"NoV3Co",defaultMessage:"Share"}):i.intl.formatMessage({id:"CNPdm5",defaultMessage:"Open"}):i.intl.formatMessage({id:"vV9l+M",defaultMessage:"Connect"});return y.default.createElement("div",{"data-testid":`extension-section-${e.id}`,className:z,key:e.description},y.default.createElement("img",{src:n,className:q,alt:""}),this.renderActionInfo(e),y.default.createElement("div",{className:X},y.default.createElement(o.Button,{variant:s,onClick:this.createClickHandler(e),className:J,"data-testid":"extensions-mini-directory-modal-redirect_button"},r)))},this.getAppDirectoryPageInfo=e=>{const t=e.app_directory_id&&Z(e.app_directory_id);return t?this.state.appDirectoryPageInfo.get(t):void 0},this.renderActionInfo=e=>{const t=this.getAppDirectoryPageInfo(e),n=t&&t.short_description,i=t&&t.page_url,a=y.default.createElement(y.default.Fragment,null,y.default.createElement(o.Text,{tagName:"div",isBold:!0},e.description),y.default.createElement(o.Text,{color:"faint",className:Q,size:"small"},n));return i?y.default.createElement("div",{className:K},y.default.createElement(o.Link,{href:i,target:"_blank",rel:"noreferrer",variant:"monochromatic",hasNoUnderline:!0,className:j},a)):y.default.createElement("div",{className:K},a)},this.renderEmptySearch=()=>{const e=this.state.searchKey,t=e?`/apps/search?query=${e}`:"/apps",n=e?i.intl.formatMessage({id:"4fGTX4",defaultMessage:"Search “{search_key}” in App Center"},{search_key:e}):i.intl.formatMessage({id:"C5jY7c",defaultMessage:"Search in App Center"});return y.default.createElement("div",{className:W},y.default.createElement(o.Text,null,i.intl.formatMessage({id:"niuDq6",defaultMessage:"Looking for something?"})),y.default.createElement(o.Link,{href:t,variant:"monochromatic"},y.default.createElement(o.Text,null,n)))},this.state={searchKey:"",appDirectoryPageInfo:new Map,loading:!0}}componentDidMount(){const e=this.props.appActions.map((e=>e.app_directory_id)).filter((e=>void 0!==e));this.fetchAppDirectoryPageInfoMap(e).then((e=>this.setState({appDirectoryPageInfo:e,loading:!1})))}async fetchAppDirectoryPageInfoMap(e){const t=await async function(e,t){const n=(i=new o.DefaultUserApiV2Client(t),i.ns("app_directory")).rpc("list_page_info",{app_identifiers:e},{});var i;return(await n).page_infos}(e,this.props.user);return t.reduce((function(e,t){for(const n of t.app_identifiers)e.set(Z(n),t);return e}),new Map)}render(){const{onRequestClose:e,modalTitle:t}=this.props,n=this.filterActions().sort(o.actionCompareFn);return y.default.createElement(a.Modal,{ariaLabel:i.intl.formatMessage({id:"wjwJvt",defaultMessage:"App actions"}),className:L,overlayClassName:U,bodyId:"extensions-mini-directory-modal",displayCloseButton:!0,open:!0,overlayFixed:!1,onRequestClose:()=>e()},this.state.loading?y.default.createElement("div",{className:Y}," ",y.default.createElement(o.Spinner,{"aria-valuetext":"Loading Apps"})," "):y.default.createElement("div",{className:F},y.default.createElement("div",{className:o.cx({[H]:this.state.showTopBorder})},y.default.createElement("div",{className:P},y.default.createElement(o.Title,null,t)),y.default.createElement("div",{className:R},y.default.createElement(o.TextInput,{"aria-label":"Search Apps",withLeftAccessory:y.default.createElement(o.UIIcon,{src:o.SearchLine}),withRightAccessory:this.state.searchKey&&y.default.createElement(o.IconButton,{size:"small",variant:"transparent",onClick:this.clearSearch},y.default.createElement(o.UIIcon,{src:_.FailFill})),placeholder:i.intl.formatMessage({id:"+enW1p",defaultMessage:"Search by action or app name"}),value:this.state.searchKey,onChange:this.handleQueryChange}))),y.default.createElement("div",{className:G,onScroll:({currentTarget:{scrollTop:e}})=>this.onScroll(e)},n.length>0?n.map((e=>this.renderExtensionItem(e))):this.renderEmptySearch()),y.default.createElement(ee,null)),y.default.createElement(b,{id:"extensions-mini-directory-modal"}))}}te.displayName="ExtensionsMiniDirectoryModalComponent";const ne=o.requireCssWithComponent(te,[]),ie=u.once((()=>{o.ReactModal.setAppElement(document.body)}));const ae={canOpenWith:function(e,t){const n=p.OpenWith.getWopiOpenWithButtonInfo(e);return null!==n&&e.bytes<=n.sizeLimitBytes}};function oe(e){const{file:t,...n}=e;return o.isBrowseFile(t)?function({file:e,isUnityDisabled:t,isOpenWithDisabled:n,unityInfo:a,extraOptions:s,user:l,isCloudBasedDoc:c,actionSource:d,isInActionBar:u,previewActionHandler:_,openDesktopActionHandler:f,openInNewTabActionHandler:h,goToFolderActionHandler:g,replayActionHandler:y,quickViewActionHandler:x,installDropboxAppActionHandler:A,manageAsAdminActionHandler:E}){const w=[];if(A){const e=m.mac?i.intl.formatMessage({id:"L6ZGiG",defaultMessage:"Open in Finder"}):i.intl.formatMessage({id:"lPzARj",defaultMessage:"Open in Explorer"});w.push({handler:A,spriteName:null,text:i.intl.formatMessage({id:"UoJNNe",defaultMessage:"Install Dropbox app"}),type:o.OpenButtonAction.INSTALL_DROPBOX_APP,userAction:o.OpenInUserAction.InstallDropboxApp,withLabel:e})}if(y){const e=i.intl.formatMessage({id:"dHOQap",defaultMessage:"Dropbox Replay"});w.push({handler:y,spriteName:null,text:e,type:o.OpenButtonAction.OPEN_IN_REPLAY,userAction:o.OpenInUserAction.OpenInReplay})}_&&w.push({handler:_,spriteName:null,text:i.intl.formatMessage({id:"wHolW4",defaultMessage:"Preview (Dropbox)"}),type:o.OpenButtonAction.PREVIEW_FILE,userAction:o.OpenInUserAction.PreviewFile});x&&w.push({handler:x,spriteName:null,text:i.intl.formatMessage({id:"LKZvpb",defaultMessage:"Quick view"}),type:o.OpenButtonAction.QUICK_VIEW,userAction:o.OpenInUserAction.QuickView});E&&w.push({handler:E,spriteName:null,text:i.intl.formatMessage(o.MANAGE_AS_ADMIN_ACTION_STRING),type:o.OpenButtonAction.MANAGE_AS_ADMIN,userAction:o.OpenInUserAction.ManageAsAdmin});if(f){const e=m.mac?i.intl.formatMessage({id:"3KanyU",defaultMessage:"Finder"}):i.intl.formatMessage({id:"kJ3mnY",defaultMessage:"File Explorer"});w.push({handler:f,spriteName:null,text:e,type:o.OpenButtonAction.OPEN_IN_DESKTOP,userAction:o.OpenInUserAction.OpenInDesktop})}h&&w.push({handler:h,spriteName:null,text:i.intl.formatMessage({id:"HE6Ges",defaultMessage:"Open in new tab"}),type:o.OpenButtonAction.OPEN_IN_NEW_TAB,userAction:o.OpenInUserAction.OpenInNewTab});g&&w.push({handler:g,spriteName:null,text:i.intl.formatMessage({id:"mppZEu",defaultMessage:"Go to folder"}),type:o.OpenButtonAction.GO_TO_FOLDER,userAction:o.OpenInUserAction.GoToFolder});if(!a)return w;!c&&function({isUnityDisabled:e,unityInfo:t}){return null!=t&&!e&&o.UnityHelpers.isUnityFileSupported(t)}({isUnityDisabled:t,unityInfo:a})&&w.push({handler:de({file:e,user:l,isFolder:!1}),spriteName:"ow_desktop",text:le(a,u),type:o.OpenButtonAction.UNITY_FILE,userAction:o.OpenInUserAction.OpenInUnity});const I=re({file:e,isOpenWithDisabled:n,user:l}),b={wopi:I},v=p.getOpenWithCloudEditorInfo(e,l,b,d);for(const t of v){const n=se(e,l,d,t);n&&w.push(n)}!u&&function({isUnityDisabled:e,unityInfo:t}){return null!=t&&!e&&o.UnityHelpers.isUnityFolderSupported(t)}({isUnityDisabled:t,unityInfo:a})&&w.push({handler:de({file:e,user:l,isFolder:!0}),spriteName:"ow_folder",text:ce(a),type:o.OpenButtonAction.UNITY_FOLDER,userAction:o.OpenInUserAction.OpenInUnityFolder});s&&s.forEach((e=>{e&&w.push(e)}));u||w.length||c||w.push({handler:()=>function(e){const t=r.URI.parse(e.href);t.updateQuery({dl:"1"}),o.get({url:t.toString()})}(e),spriteName:null,text:i.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),type:o.OpenButtonAction.DOWNLOAD,userAction:o.OpenInUserAction.Download});return w}({file:t,...n}):o.isSharedFile(t)?function(e){const{file:t,user:n,isOpenWithDisabled:i}=e,a=[],o={wopi:re({file:t,isOpenWithDisabled:i,user:n})},s=e.actionSource,r=p.getOpenWithCloudEditorInfo(t,n,o,s);for(const e of r){const i=se(t,n,s,e);i&&a.push(i)}return a}({file:t,...n}):[]}function se(e,t,n,i){let a;return i.provider!==p.OpenWithCloudDocProvider.OfficeOnline?null:(a={type:o.OpenButtonAction.OPEN_WITH,userAction:o.OpenInUserAction.OpenInOfficeOnline},{handler:()=>i.handler(e,t,n),spriteName:i.spriteName||null,iconUrl:i.iconUrl,text:i.text,...a})}function re({file:e,isOpenWithDisabled:t,user:n}){return!t&&ae.canOpenWith(e,n)}function le(e,t){const n=(e?e.open_application_name:void 0)||i.intl.formatMessage({id:"Uyxn/h",defaultMessage:"Desktop"});return t?n:i.intl.formatMessage({id:"KtD8FA",defaultMessage:"Open in {app_name}"},{app_name:n})}function ce(e){const t=(null!==e?e.file_browser_display_name:void 0)||i.intl.formatMessage({id:"Bbnzjx",defaultMessage:"File Browser"});return i.intl.formatMessage({id:"suwlZc",defaultMessage:"Show in {file_browser}"},{file_browser:t})}function de({file:e,isFolder:t,user:n}){return()=>{o.UnityHelpers.openFile(e.ns_id,e.ns_path,n.id,t)}}const pe=Object.freeze({local_path:null,resolved_local_path:null,is_locally_available:!1,can_open_directly:!1,open_application_identifier:null,open_application_name:null,path_is_dir:!1,is_infinite_placeholder:!1,error_message:null});e.authorizeNoRedirect=async function(e,t){try{const n=await D(e,"authorize_no_redirect",{action_id:t});return n&&n.result&&n.result.link_state}catch{return null}},e.cloudEditorNameToParams=O,e.computeSplitShareMenuReferrer=(e,t,n,i)=>{let a=`${t}`;return n&&(a=`${n}`,i&&(a=`${n}_${i}`,i===o.ActionSurfaceLogValue.RIGHT_SIDEBAR&&1===e.length?a=`${n}_${i}_single_file`:i===o.ActionSurfaceLogValue.RIGHT_SIDEBAR&&e.length>1&&(a=`${n}_${i}_multi_file`))),a},e.genericAppIcon=x,e.getCategoryIdToInfos=function(e){const t={};return e.forEach((e=>{t[e.id]=e})),t},e.getOpenOptionsForFile=function(e){const t=p.getActionSourceFromSurface(e.surface);let{isCloudEditorDisabled:n}=e,i=n;return n||(n=!!e.cloudDocsInfo&&!e.cloudDocsInfo.gSuiteEnabled,i=!!e.isOpenWithDisabled),oe({file:e.file,isOpenWithDisabled:!!i,unityInfo:e.unityInfo||pe,extraOptions:e.extraOptions,user:e.user,isCloudBasedDoc:p.isCloudBasedDoc(e.file),actionSource:t,isCloudEditorDisabled:n,isInActionBar:e.isInActionBar,previewActionHandler:e.previewActionHandler,openDesktopActionHandler:e.openDesktopActionHandler,goToFolderActionHandler:e.goToFolderActionHandler,replayActionHandler:e.replayActionHandler,openInNewTabActionHandler:e.openInNewTabActionHandler,quickViewActionHandler:e.quickViewActionHandler,installDropboxAppActionHandler:e.installDropboxAppActionHandler,manageAsAdminActionHandler:e.manageAsAdminActionHandler})},e.isWopiAction=M,e.redirectToActionOrShowAuth=C,e.showExtensionsMiniDirectoryModal=(e,t,n,i,a,s,r,l,c)=>{ie(),o.Modal.showInstance(y.default.createElement(ne,{modalTitle:e,user:t,file:n,onRequestClose:o.Modal.close,appActions:i,categoryIdToInfos:a,featureFlags:s,telemetryContext:r,currentSession:l,onProfileServiceAuth:c}))},e.toActionBarValue=e=>({nodeType:"dropdown",actionType:3,menuItem:e})}));
//# sourceMappingURL=c_extensions_open_button_utils.js-vfltdcYzy.map

//# debugId=1da867ba-3d1a-3169-a160-49367d08a98a