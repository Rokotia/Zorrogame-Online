!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="2071ec1a-d9c6-3809-83c5-4e9520a5efb1")}catch(e){}}();
define(["exports","react","./e_file_viewer_static_scl_page_file","./c_api_v2_routes_password_confirmation_provider","./c_ui_share-blocking-wrapper_share_blocking_wrapper","./c_core_i18n","./e_data_modules_stormcrow","./c_common_components_layout","./c_stacks_lib_api","./c_utils_dsx_dsx-react","./c_dig-icons_assets_ui-icon_line_team","./e_core_exception","./c_common_components_buttons","./c_spectrum_util_raf_throttle","./c_dig-icons_assets_ui-icon_line_settings","./c_dig-icons_assets_ui-icon_line_share","./c_dig-icons_assets_ui-icon_line_upsell","./c_dig-icons_assets_ui-icon_line_lock","./c_dig-icons_assets_ui-icon_line_undo","./c_watermarking_utils_getImageDefaultSizes","./c_dig-illustrations_spot_bowl-empty","./c_dig-content-icons_icons_folder-shared-default-small"],(function(e,t,a,n,r,s,o,i,l,c,d,u,m,g,_,p,f,E,b,h,M,S){"use strict";function v(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var y=v(t),A=function(e,t,a){if(a||2===arguments.length)for(var n,r=0,s=t.length;r<s;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))},C=[0],I=new Map;function T(e,n){var r=void 0===n?{}:n,s=r.threshold,o=void 0===s?C:s,i=r.root,l=r.rootMargin,c=void 0===l?"0px":l,d=a.useSafeState(),u=d[0],m=d[1];return t.useEffect((function(){var t=e&&"current"in e?e.current:e;if(t){var a=!0,n=function(e){var t,a=null!==(t=e.root)&&void 0!==t?t:document,n=I.get(a);n||(n=new Map,I.set(a,n));var r=JSON.stringify([e.rootMargin,e.threshold]),s=n.get(r);if(!s){var o=new Map,i=new IntersectionObserver((function(e){return e.forEach((function(e){var t;return null===(t=o.get(e.target))||void 0===t?void 0:t.forEach((function(t){return setTimeout((function(){return t(e)}),0)}))}))}),e);s={observer:i,observe:function(e,t){var a=o.get(e);a||(a=new Set,o.set(e,a),i.observe(e)),a.add(t)},unobserve:function(e,t){var s=o.get(e);s&&(s.delete(t),s.size||(o.delete(e),i.unobserve(e),o.size||(i.disconnect(),n.delete(r),n.size||I.delete(a))))}},n.set(r,s)}return s}({root:i&&"current"in i?i.current:i,rootMargin:c,threshold:o}),r=function(e){a&&m(e)};return n.observe(t,r),function(){a=!1,n.unobserve(t,r)}}}),A([e,i,c],o,!0)),u}const L=e=>e.formatMessage({id:"R8tdDL",defaultMessage:"Can edit"}),R=e=>e.formatMessage({id:"2kS9ex",defaultMessage:"Can view"}),N=e=>e.formatMessage({id:"pI4aSB",defaultMessage:"View-only"}),k=e=>e.formatMessage({id:"UznKXK",defaultMessage:"People can edit, delete, comment, and add the files to their Dropbox"}),w=e=>e.formatMessage({id:"ScDA/0",defaultMessage:"People can edit, delete, comment, and add the file to their Dropbox"}),x=e=>e.formatMessage({id:"WlnggN",defaultMessage:"People can edit, delete, and add items to this collection"}),D=e=>e.formatMessage({id:"jSEExB",defaultMessage:"People can view, download, and comment"}),P=e=>e.formatMessage({id:"svq/mv",defaultMessage:"People can view and download items in this collection"}),$=e=>e.formatMessage({id:"5AmS1v",defaultMessage:"People can only view and download the file"}),O=e=>e.formatMessage({id:"b0sjjf",defaultMessage:"Learn more"}),F=e=>e.formatMessage({id:"O1FxvA",defaultMessage:"This folder can only be shared as a link."}),B=e=>e.formatMessage({id:"QpEuIr",defaultMessage:"You can view this folder, but you’ll need to ask the folder owner to give you permission to share it."}),j=e=>e.formatMessage({id:"/8sefF",defaultMessage:"You can view this folder, but only the folder owner can share it."});function U(e){return{class:"sharing_sender",action:"hover",object:"flexible_sharing_entrypoint_action",properties:e}}function V(e){return{class:"sharing_sender",action:"log",object:"flexible_sharing_entrypoint_action_dwell_time",properties:e}}const H=Symbol("ON_CLICK_PROGRESSIVE"),q=Symbol("ON_MOUSE_ENTER_PROGRESSIVE"),W=Symbol("ON_MOUSE_LEAVE_PROGRESSIVE"),{useEmitter:z,defaultEmitter:G}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(i.Context$2),r=t(i.Context$3),s=t(i.Context),o={...i.getTags(n),...i.getTags$1(r),...i.getTags$2(s)},l={...i.getProperties(n),...i.getProperties$1(r),...i.getProperties$2(s)};if(e.key===H)return a.UDCL.logEvent(i.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"inband_progressive",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...o,action:"inband_progressive"}}),void a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"inband_progressive",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...o,action:"inband_progressive"}});if(e.key!==q){if(e.key!==W)return a.exhausts(e,void 0);a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"inband_progressive",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...o,action:"inband_progressive"}})}else a.UDCL.logEvent(U({...l,flexibleSharingEntryPointAction:"inband_progressive"}),{tags:{...o,action:"inband_progressive"}})})),Z=({accountMetadata:e})=>{const t=s.useIntl(),n=i.useOpenUrl(),r=i.getIsTeamAdmin(e),o=r?(e=>e.formatMessage({id:"QV0fMP",defaultMessage:"To share this folder, manage access in the admin console."}))(t):(e=>e.formatMessage({id:"E/G/gP",defaultMessage:"Only admin and group managers can share this content.{br}Reach out and ask them to share it."},{br:y.createElement("br",null)}))(t),l=r?(e=>e.formatMessage({id:"S839MU",defaultMessage:"Go to admin console"}))(t):(e=>e.formatMessage({id:"0KHhX0",defaultMessage:"Find admin"}))(t);return y.createElement("div",{style:{textAlign:"center"}},y.createElement(a.Text,{size:"medium","data-testid":"tmr-team-folder-subtitle"},o),y.createElement("div",null,y.createElement(a.Button,{variant:"borderless",size:"small",style:{marginTop:"32px"},onClick:()=>{n(r?"/team/admin/content/home":"/team?_tk=left_nav_team")}},l)))};Z.displayName="TmrTeamFolder";const Q=e=>{var t;const{objectMetadata:n,accountMetadata:r,onInbandButtonClicked:o,componentViewTime:l}=e,c=a.isNewApiMetadata(n),[d,u]=y.useState(!1),[g,_]=y.useState(!1),[f,E]=y.useState(0),b=y.useRef(null),h=z(),M=a.getCanInvite(n,i.VIEWER),S=a.getCanInvite(n,i.EDITOR)||M,v=a.getIsLinkOnlyMode(n),A=a.getIsNSLinkOnlyMode(n),C=a.getIsFolder(n),I=i.isUserOnSameTeamAsObject(r,n),T=i.isUserOnSameTeamAsTmrTeamFolder(r,n),L=!!a.getOwnerTeam(n),R=null!==(t=a.getOwnerTeamName(n))&&void 0!==t?t:"",N=a.getIsTeamSharedFolder(n),k="https://help.dropbox.com/files-folders/share/shared-folder-faq#cantcreate",w=i.useOpenUrl(),x=y.useCallback((e=>{w(e)}),[w]),D=()=>{switch(a.getInviteDeniedReason(n)){case"mount_exceeded":return y.createElement(a.Text,null,((e,t)=>{if(!t.metadata_response||!a.getIsFolder(t))return;const n=t.metadata_response;if(n.invite_viewer_folder_perm.invite_viewer_folder_denied_reason&&"mount_exceeded"===n.invite_viewer_folder_perm.invite_viewer_folder_denied_reason[".tag"]){const t=n.invite_viewer_folder_perm.invite_viewer_folder_denied_reason,a=t.limit,r=t.new_count-a;return e.formatMessage({id:"f3Mx9B",defaultMessage:"This folder can only be shared as a link because your Dropbox folder is {number, plural, one{1 shared folder} other {{number} shared folders}} over limit."},{number:r})}})(s.intl,n),y.createElement(a.Link,{style:{marginLeft:3},hasNoUnderline:!0,onClick:()=>x(k),href:"",isBold:!0},O(s.intl)));case"contains_app_folder":case"inside_app_folder":case"is_app_folder":case"is_family_folder":return y.createElement(a.Text,null,F(s.intl));default:return y.createElement(a.Text,null,I?B(s.intl):j(s.intl))}},P=y.useCallback((()=>{const e=g?Date.now()-f:void 0,t=Date.now()-l;h.select(H).emit({dwellTime:e,timeSinceView:t}),o()}),[l,h,g,o,f]),$=y.useCallback((()=>{E(Date.now()),_(!0),h.select(q).emit(null),u(!0)}),[h]),U=y.useCallback((()=>{const e=g?Date.now()-f:void 0;_(!1),h.select(W).emit({dwellTime:e}),u(!1)}),[h,g,f]),V=c?!S:v||!S;return y.createElement(y.Fragment,null,y.createElement(m.ButtonWrapper,{ref:b,onMouseEnter:$,onMouseLeave:U,"data-uxa-log":"sm24-inband-button."+(V?"disabled":"loaded"),"data-uxa-interactions":"shown click"},y.createElement(m.HorizontalButton,{onClick:P,disabled:V,"data-testid":"inband-sharing-entry-button"},y.createElement(m.ButtonIconContainer,null,y.createElement(a.UIIcon,{src:p.ShareLine,size:"medium"})),y.createElement(m.ButtonInnerColumn,null,y.createElement(m.ButtonTitle,{content:(G=s.intl,G.formatMessage({id:"SC4EWs",defaultMessage:"Add people"}))})))),(()=>{let e=null;return c?T&&!S?e=y.createElement(Z,{accountMetadata:r}):S||(e=D()):v?e=(()=>{switch(v?A?"isNSLinkOnlyMode":"isFamily":"isLimitedPermissions"){case"isNSLinkOnlyMode":return y.createElement(a.Text,null,((e,t)=>{if(t.tooManyMountsError&&("total_mounts_exceeded"===t.tooManyMountsError[".tag"]||"home_mounts_exceeded"===t.tooManyMountsError[".tag"]||"tree_size_exceeded"===t.tooManyMountsError[".tag"])){const a=t.tooManyMountsError.limits_info;if(a){const t=a.limit,n=a.new_count-t;return e.formatMessage({id:"f3Mx9B",defaultMessage:"This folder can only be shared as a link because your Dropbox folder is {number, plural, one{1 shared folder} other {{number} shared folders}} over limit."},{number:n})}}})(s.intl,n),y.createElement(a.Link,{style:{marginLeft:3},hasNoUnderline:!0,onClick:()=>x(k),href:"",isBold:!0},O(s.intl)));case"isLimitedPermissions":return L&&!I?N?y.createElement(a.Text,null,(e=s.intl,void 0!==(t=R)?e.formatMessage({id:"ToMYBy",defaultMessage:"This folder can only be managed by the {ownerTeamName} team."},{ownerTeamName:t}):e.formatMessage({id:"ReqZ5Y",defaultMessage:"This folder can only be managed by the owner team."}))):C?y.createElement(a.Text,null,(e=>e.formatMessage({id:"5iJXBE",defaultMessage:"You don’t have permission to manage membership of this folder"}))(s.intl)):y.createElement(a.Text,null,(e=>e.formatMessage({id:"WVaUHn",defaultMessage:"You don’t have permission to manage membership of this file"}))(s.intl)):y.createElement(a.Text,null,(e=>e.formatMessage({id:"TnTBTY",defaultMessage:"This can only be shared with the link."}))(s.intl));case"isFamily":return y.createElement(a.Text,null,F(s.intl))}var e,t})():T&&!S?e=y.createElement(Z,{accountMetadata:r}):S||(e=y.createElement(a.Text,null,I?B(s.intl):j(s.intl))),e?y.createElement(a.Tooltip.Control,{open:d,placement:"top",auto:!0,triggerRef:b,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1)},e):null})());var G};Q.displayName="InbandEntryButtonInner";const Y=e=>{const{oid:t,onInbandButtonClicked:n,componentViewTime:r}=e,s=a.useSharingObjectMetadata(t),o=i.useSharingAccountInfo(),l=s.isLoading,c=!s.isLoading&&s.isError,d=l||c?void 0:s.output,u=o.isLoading,g=!o.isLoading&&o.isError,_=u||g?void 0:o.output;return l||u?y.createElement(m.ButtonWrapper,{"data-uxa-log":"sm24-inband-button.loading","data-uxa-interactions":"shown click"},y.createElement(m.HorizontalButton,{disabled:!0},y.createElement(a.Skeleton.Avatar,{size:"medium",style:{marginRight:"var(--dig-spacing__dimension__12)"}}),y.createElement(a.Skeleton.Text,{size:"large",width:200}))):d&&_?y.createElement(Q,{accountMetadata:_,objectMetadata:d,onInbandButtonClicked:n,componentViewTime:r}):null};Y.displayName="InbandEntryButton";const K=({objectMetadata:e,accountMetadata:t,canInvite:n,handleButtonClick:r,componentViewTime:o})=>{const[l,c]=y.useState(!1),[d,u]=y.useState(0),[g,_]=y.useState(!1),f=y.useRef(null),E=z(),b=i.isUserOnSameTeamAsTmrTeamFolder(t,e),h=y.useCallback((()=>{const e=l?Date.now()-d:void 0,t=Date.now()-o;E.select(H).emit({dwellTime:e,timeSinceView:t}),r()}),[o,E,r,l,d]),M=y.useCallback((()=>{u(Date.now()),c(!0),E.select(q).emit(null),_(!0)}),[E]),S=y.useCallback((()=>{const e=l?Date.now()-d:void 0;c(!1),E.select(W).emit({dwellTime:e}),_(!1)}),[E,l,d]),v=i.getIsTeam(t);return y.createElement(y.Fragment,null,y.createElement(m.ButtonWrapper,{ref:f,onMouseEnter:M,onMouseLeave:S},y.createElement(m.HorizontalFlatButton,{onClick:h,disabled:!n,"data-testid":"inband-sharing-entry-button",autoFocus:!0},y.createElement(m.ButtonIconContainer,null,y.createElement(a.UIIcon,{src:p.ShareLine,size:"small"})),y.createElement(m.ButtonInnerColumn,null,y.createElement(a.Text,{color:"subtle",style:{marginLeft:-3,marginTop:4}},y.createElement(a.Truncate,{lines:2},v?s.intl.formatMessage({id:"I1N8uC",defaultMessage:"Add an email, name, or group"}):(e=>e.formatMessage({id:"RynZbM",defaultMessage:"Add an email or name"}))(s.intl)))))),(()=>{let r=null;if(b&&!n)r=y.createElement(Z,{accountMetadata:t});else if(!n){const n=i.isUserOnSameTeamAsObject(t,e);r=y.createElement(a.Text,null,n?B(s.intl):j(s.intl))}return r?y.createElement(a.Tooltip.Control,{open:g,placement:"top",auto:!0,triggerRef:f,onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1)},r):null})())};K.displayName="Inner";const J=({oid:e,onTokenizerButtonClick:t,componentViewTime:n})=>{const r=a.useSharingObjectMetadata(e),s=i.useSharingAccountInfo(),o=r.isLoading,l=!r.isLoading&&r.isError,c=o||l?void 0:r.output,d=s.isLoading,u=!s.isLoading&&s.isError,g=d||u?void 0:s.output,_=o||d,p=!_&&c&&g;if(_)return y.createElement(m.ButtonWrapper,null,y.createElement(m.HorizontalButton,{disabled:!0},y.createElement(a.Skeleton.Avatar,{size:"medium",style:{marginRight:"var(--dig-spacing__dimension__12)"}}),y.createElement(a.Skeleton.Text,{size:"large",width:200})));if(p){const e=a.getCanInvite(c,i.VIEWER)||a.getCanInvite(c,i.EDITOR);return y.createElement(K,{accountMetadata:g,objectMetadata:c,canInvite:e,handleButtonClick:t,componentViewTime:n})}return null};J.displayName="TokenizerButton";const X=s.defineMessage({id:"UaJBfk",defaultMessage:"QR code for sharing"}),ee=s.defineMessage({id:"ZFsp0l",defaultMessage:"Download"}),te=s.defineMessage({id:"E89n5D",defaultMessage:"Download QR code"}),ae=s.defineMessage({id:"EQKjGC",defaultMessage:"Anyone with the code can view."}),ne=s.defineMessage({id:"J8vTeR",defaultMessage:"Team members with the code can view."}),re=s.defineMessage({id:"5TDAHV",defaultMessage:"Manage access"}),se=s.defineMessage({id:"tllLrY",defaultMessage:"Only people invited can view."}),oe=s.defineMessage({id:"bWq9cz",defaultMessage:"Couldn’t create QR code. You don’t have permission to create a QR code to this content."}),ie=s.defineMessage({id:"tpMKHD",defaultMessage:"We can’t find this file anymore. Try checking activity or folder history to see what happened."}),le=s.defineMessage({id:"zGqflr",defaultMessage:"You can’t share until you verify your email address."}),ce=s.defineMessage({id:"zM/n79",defaultMessage:"Couldn’t create QR code. Please try again later."}),de=s.defineMessage({id:"s2Zxdl",defaultMessage:"Couldn’t create QR code."});var ue;!function(e){e.PATH_FORBIDDEN="path_forbidden",e.PATH_NOT_FOUND="path_not_found",e.EMAIL_NOT_VERIFIED="email_not_verified",e.SERVICE_UNAVAILABLE="service_unavailable",e.UNKNOWN="unknown"}(ue||(ue={}));const me=e=>`data:image/png;base64,${e}`;a.injectInternalStyle("/static/metaserver/static/js/sharing/features/sharing_qr_code/get_qr_code_modal.module.out-vflNN1fVL.css",(e=>"._get-qr-code-modal_dbu8m_1>div{background-color:var(--dig-color__background__subtle);border:1px solid var(--dig-color__border__subtle)}._get-qr-code-modal-image_dbu8m_6{display:flex;width:100%}._get-qr-code-modal-spinner_dbu8m_11{align-items:center;aspect-ratio:1/1;display:flex;justify-content:center;width:100%}._get-qr-code-modal-body_dbu8m_19{padding-bottom:var(--spacing__unit--3);padding-top:calc(var(--spacing__unit--1)*6)}._get-qr-code-modal-filename_dbu8m_25{white-space:nowrap}@media (min-width:601px){._get-qr-code-modal-body_dbu8m_19{padding-top:var(--spacing__unit--3)}._get-qr-code-modal_dbu8m_1 button.dig-Modal-close-btn{display:none}}"));const ge=({base64QrCode:e})=>y.default.createElement("img",{"data-testid":"qr-code-modal-image",className:"_get-qr-code-modal-image_dbu8m_6",src:me(e),alt:s.intl.formatMessage(X)});ge.displayName="GetQrCodeModalImage";const _e=()=>y.default.createElement("div",{className:"_get-qr-code-modal-spinner_dbu8m_11"},y.default.createElement(a.Spinner,{size:"medium"}));const pe=a.createApiv2Query({nsClient:function(e){return e.ns("sharing_qr_code")},rpc:"get_qr_code"}),fe=()=>{var e;const t="dark"===(null===(e=a.useTheme())||void 0===e?void 0:e.mode);return y.default.createElement(y.default.Fragment,null,y.default.createElement(a.Box,{padding:"Micro XLarge",marginTop:"Micro Small",borderWidth:"1",borderColor:"Border Subtle",borderStyle:"Solid",backgroundColor:t?"Secondary Surface - State 1":"Background Base",borderRadius:"XLarge"},y.default.createElement(_e,null)),y.default.createElement(a.Box,{marginTop:"Micro Large"},y.default.createElement(a.Button,{size:"large",variant:"primary",fullWidth:!0,"data-uxa-log":"download_qr_code_modal_button","aria-label":s.intl.formatMessage(te),disabled:!0,autoFocus:!0},s.intl.formatMessage(ee)),y.default.createElement(a.Box,{marginTop:"Micro Large"},y.default.createElement(a.Skeleton.Text,null)," ",y.default.createElement(a.Skeleton.Text,null))))};fe.displayName="GetQrCodeLoading";const Ee=({file:e,user:t,onSettingsClick:r,qrCodeResponse:o})=>{var i,l;const c=a.getFilename$1(e),d=null!==(i=o.qrcode)&&void 0!==i?i:"",u=o.effective_audience,m=y.default.useCallback(((r,s)=>{const o=a.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS,i=n.get_browser_info();a.ShareTibEventLogger.log(t.id,r,o,{file_id:e.file_id,fq_path:e.fq_path,is_folder:e.is_dir,browser:i.browser,browser_version:i.version,...s})}),[t.id,e]);y.default.useEffect((()=>{const e=o.link_url;if(e){const t=a.parseLink(e),n=t.doesContainShmodelLink?a.ShareTibEventLogger.get_shmodel_extra_for_logging(void 0,a.getCleanedSharingUrl(t)):a.ShareTibEventLogger.get_scl_extra_for_logging(void 0,a.getCleanedSharingUrl(t)),r={sender_trackey:t.searchParams.get("st"),...n};m(a.TiburonEventName.CreateQrCode,r)}}),[m,o.link_url]);const g="dark"===(null===(l=a.useTheme())||void 0===l?void 0:l.mode),_=(e=>{switch(e){case"public":return ae;case"team":return ne;case"no_one":return se;default:return""}})(u);return y.default.createElement(y.default.Fragment,null,y.default.createElement(a.Box,{padding:"Micro XLarge",marginTop:"Micro Small",borderWidth:"1",borderColor:"Border Subtle",borderStyle:"Solid",backgroundColor:g?"Secondary Surface - State 1":"Background Base",borderRadius:"XLarge"},y.default.createElement(ge,{base64QrCode:d})),y.default.createElement(a.Box,{marginTop:"Micro Large"},y.default.createElement(a.Button,{size:"large",variant:"primary",onClick:e=>{e.preventDefault(),((e,t)=>{const a=document.createElement("a");a.href=me(e),a.download=`${t}_QR.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a)})(d,c)},fullWidth:!0,"data-uxa-log":"download_qr_code_modal_button","aria-label":s.intl.formatMessage(te),autoFocus:!0},s.intl.formatMessage(ee)),y.default.createElement(a.Box,{marginTop:"Micro Large"},_?y.default.createElement(a.Text,null,s.intl.formatMessage(_)):null,r?y.default.createElement(y.default.Fragment,null," ",y.default.createElement(a.Link,{hasNoUnderline:!0,href:"#",onClick:e=>{e.preventDefault(),r()},"data-uxa-log":"settings_qr_code_modal_button"},s.intl.formatMessage(re))):null)))};Ee.displayName="GetQrCodeLoaded";const be=e=>{const t=e.user,n=e.onGetQrCodeError,r=(e=>{const t=pe.useQuery({apiArg:{read_path:e}},{staleTime:0});return y.useMemo((()=>t?t.isLoading?{isLoading:!0}:t.isError?{isLoading:!1,isError:!0,error:t.error.appError}:{output:t.data.apiData,isLoading:!1,isError:!1}:{isLoading:!0}),[t])})(e.file.file_id||e.file.fq_path),o=y.default.useRef(!1);return y.default.useEffect((()=>{var e;if(!1===o.current&&!r.isLoading&&(void 0===t||r.isError||void 0===r.output||void 0===r.output.qrcode||""===r.output.qrcode)){o.current=!0;const t=r.isError?null===(e=r.error)||void 0===e?void 0:e[".tag"]:void 0;a.Snackbar.warn(s.intl.formatMessage((e=>{switch(e){case ue.PATH_FORBIDDEN:return oe;case ue.PATH_NOT_FOUND:return ie;case ue.EMAIL_NOT_VERIFIED:return le;case ue.SERVICE_UNAVAILABLE:return ce;default:return de}})(t))),null==n||n()}}),[n,t,r]),r.isLoading?y.default.createElement(fe,null):void 0===t||r.isError||void 0===r.output||void 0===r.output.qrcode||""===r.output.qrcode?null:y.default.createElement(Ee,{...e,user:t,qrCodeResponse:r.output})};be.displayName="GetQrCodeInner";const he=e=>{const{user:t,isLoading:n}=a.useActiveUser();return n?y.default.createElement(fe,null):y.default.createElement(be,{...e,user:t})};he.displayName="GetQrCode";var Me;!function(e){e.MAIN="main",e.QRCODE="qrcode",e.INBAND="inband",e.MANAGE_ACCESS="manage_access",e.COPY_LINK="copy_link"}(Me||(Me={}));const Se=e=>{const t=y.useRef(null),[n,r]=y.useState(-1);y.useEffect((()=>{e.isOpen&&t.current&&"inband"!==e.currentScreen&&t.current.focus()}),[e.isOpen,e.currentScreen]);const s=e.onEscape,o=y.useCallback((e=>{var a,o,i,l;if(!t.current)return;if("Shift"===e.key)return;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key)&&(e.preventDefault(),e.nativeEvent.stopImmediatePropagation()),"Escape"===e.key)return s(e),e.preventDefault(),void e.nativeEvent.stopImmediatePropagation();if("Tab"===e.key){if(e.preventDefault(),(null===(a=document.activeElement)||void 0===a?void 0:a.classList.contains("targets-tokenizer-suggestion"))||(null===(o=document.activeElement)||void 0===o?void 0:o.classList.contains("typeahead-import-contacts")))return void(null===(i=document.getElementById("targets-tokenizer-input-search"))||void 0===i||i.focus());if((null===(l=document.activeElement)||void 0===l?void 0:l.matches("#targets-tokenizer-input-search"))&&null==t.current.querySelector("textarea"))return;const s=t.current.querySelectorAll('button:not([disabled]), [href]:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"]):not([disabled])');let c,d=n;for(let e=0;e<s.length;e++){if(s[e]===document.activeElement){d=e;break}}return c=e.shiftKey?(d-1+s.length)%s.length:(d+1)%s.length,s[c].focus(),void r(c)}}),[s,n,r]),l="anchored_v1"===e.displayMode?e.onAnchorInvalid:void 0,c=T("anchored_v1"===e.displayMode?t:null,{threshold:[.99]});y.useLayoutEffect((()=>{c&&!c.isIntersecting&&l&&l()}),[c,null==c?void 0:c.isIntersecting,l]);const d="anchored_v1"===e.displayMode?e.anchorRef:null;if(y.useEffect((()=>{if("anchored_v1"!==e.displayMode||!l||null===d)return;const t=d.current;if(!t||"object"!=typeof t||!("nodeType"in t))return;const a=new MutationObserver((e=>{var a,n;for(const r of e)if("childList"===r.type)for(const e of Array.from(r.removedNodes))if(e===t||(null===(n=(a=e).contains)||void 0===n?void 0:n.call(a,t)))return void l()}));return a.observe(document.body,{childList:!0,subtree:!0}),()=>{a.disconnect()}}),[e.displayMode,l,d]),"centered_v1"===e.displayMode)return y.createElement(a.Modal$1,{open:e.isOpen,width:380,onRequestClose:e.onClickOutside,ref:t,isCentered:!0},y.createElement("div",{"data-test-id":"shareme24-modal","data-uxa-log":"sm24-modal","data-uxa-interactions":"shown",className:a.cx(i.outerWrapper)},null!==e.header&&y.createElement(a.Modal$1.Header,{className:i.headerSection},e.header),y.createElement(a.Modal$1.Body,{className:a.cx(i.modalInnerWrapper,{[i.modalInnerWrapperMainExit]:e.isExitingMainToQr}),onAnimationEnd:e.onOverlayOrModalAnimationEnd},e.children)));if("drawer"===e.displayMode){const t="main"===e.currentScreen,n=t?"auto":"100%";return y.createElement(a.Drawer.ModalDrawer,{onRequestClose:e.onClickOutside,"aria-label":"sm24-drawer",isOpen:e.isOpen,alignment:"bottom",height:n,className:t?i.roundedCorner:void 0,shouldAnimate:!0},y.createElement("div",{className:a.cx(i.drawerOuterWrapper)},y.createElement(a.Drawer.Container,null,t?y.createElement("div",{className:i.handle}):void 0,y.createElement(a.Drawer.Header,{className:i.drawerHeader},y.createElement(a.Drawer.Layout,null,y.createElement(a.Drawer.LayoutItem,{width:"fill"},y.createElement(a.Drawer.Layout,null,e.header)))),y.createElement(a.Drawer.Body,{className:a.cx(i.modalInnerWrapper,i.drawerBody,{[i.modalInnerWrapperMainExit]:e.isExitingMainToQr}),onAnimationEnd:e.onOverlayOrModalAnimationEnd},e.children))))}return y.createElement(a.ClickOutside,{className:i.clickOutside,isActive:e.isOpen,onClickOutside:e.onClickOutside,shouldClickOutsideWhenDefaultPrevented:!1,"data-uxa-log":"sm24-clickaway","data-uxa-interactions":"click"},y.createElement(a.Overlay,{className:a.cx(i.overlay,{[i.overlayMainExit]:e.isExitingMainToQr}),offsetDistance:e.offsetDistance,anchorRef:e.anchorRef,placement:e.placement,auto:!0,onAnimationEnd:e.onOverlayOrModalAnimationEnd,elementResize:!0},y.createElement("div",{"data-test-id":"shareme24-modal",className:a.cx(i.outerWrapper),style:{width:380},onKeyDown:o,ref:t,"data-uxa-log":"sm24-modal","data-uxa-interactions":"shown",tabIndex:0},null!==e.header&&y.createElement(a.Modal$1.Header,{className:i.headerSection},e.header),y.createElement(a.Modal$1.Body,{className:a.cx(i.modalInnerWrapper,{[i.modalInnerWrapperMainExit]:e.isExitingMainToQr}),onAnimationEnd:e.onOverlayOrModalAnimationEnd},e.children))))};Se.displayName="Wrapper";const ve=({styleName:e,...t})=>y.createElement("div",{className:`${i.buttonRow} ${e}`,"aria-hidden":t.hidden,...t},t.children);ve.displayName="ButtonRow";const ye=({styleName:e,...t})=>y.createElement("div",{className:`${i.buttonRowButtonWrapper} ${e}`,"aria-hidden":t.hidden,...t},t.children);ye.displayName="ButtonRowButtonWrapper";const Ae="SHARING_BANNED_MODAL",Ce=e=>{const[n,r]=t.useState(!0),o=s.intl.formatMessage({id:"sHjsEB",defaultMessage:"Couldn’t complete share"}),i=s.intl.formatMessage({id:"3Ob1gB",defaultMessage:"We’ve interrupted your sharing activity. For details or to contact support, read our <link>help center article.</link>"},{link:e=>y.default.createElement(a.Button,{variant:"transparent",href:a.ABUSE_HELP_ARTICLE_LINK,target:"_blank",hasNoUnderline:!0},e)});return y.default.createElement(a.Modal$1,{open:n,isCentered:!0,withCloseButton:"Close",onRequestClose:()=>r(!1),onAfterClose:e.onAfterClose,"aria-labelledby":"sharing-banned-modal-title"},y.default.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},y.default.createElement(a.Modal$1.Title,{id:"sharing-banned-modal-title"},o)),y.default.createElement(a.Modal$1.Body,null,i),y.default.createElement(a.Modal$1.Footer,null))};Ce.displayName="SharingBannedModal";const Ie=e=>{const t=function(e){const{isNonUserRelativeContext:t}=a.useSharingApiContext(),n=i.getContentIdOrPathFromObjectIdentifier(e);return a.seenStateInfoPackage.useQuery({apiArg:{file_infos:[{file_identifier:n}],limit:150}},{staleTime:3e5,enabled:"file"===e[".tag"]&&!t})}(e),{isNonUserRelativeContext:n}=a.useSharingApiContext();return y.useMemo((()=>!t||"file"!==e[".tag"]||n?{isLoading:!1,isError:!1,output:{seen_state_info:{seen_states:[]},file_info:{}}}:t.isLoading||!t.data?{isLoading:!0}:t.error?{isLoading:!1,isError:!0,error:t.error.appError}:t.data.apiData&&0!==t.data.apiData.length?{output:t.data.apiData[0],isLoading:!1,isError:!1}:{isLoading:!1,isError:!1,output:{seen_state_info:{seen_states:[]},file_info:{}}}),[t,e,n])};const Te=(e,t)=>{const n=[],r=t&&null!==a.getEditLinkMetadata(t),s=t&&null!==a.getViewLinkMetadata(t);if(!e)return n;for(const t of e.seen_state_info.seen_states)if(!Le.isAnonymousSeenState(t)){const e=t.seen_state_user.sharing_access_type;if(e)switch(e[".tag"]){case"link_only":n.push(t);break;case"view_link_access":s&&n.push(t);break;case"edit_link_access":r&&n.push(t)}}return n};var Le;!function(e){function t(e){return e.startsWith("dbafvid:")}e.isAnonymousUserId=t,e.isAnonymousSeenState=e=>t(e.seen_state_user.user_id)}(Le||(Le={}));const Re=e=>{const t=Ne(e);return y.useMemo((()=>{if(!t||t.isLoading)return{isLoading:!0};if(t.isError)return{isError:!0,isLoading:!1,error:t.error.appError};{const e={};return Object.values(t.data.apiData).forEach((t=>{e[t.account_id]=t})),{isError:!1,isLoading:!1,output:e}}}),[t])},Ne=e=>a.getAccountBatchPackage.useQuery({apiArg:{account_ids:e}},{enabled:e.length>0,staleTime:3e5,keepPreviousData:!0}),ke=e=>{const t=we(e),{isNonUserRelativeContext:n}=a.useSharingApiContext();return y.default.useMemo((()=>n?{isLoading:!1,isError:!1,output:{links:[],has_more:!1}}:!t||t.isLoading?{isLoading:!0}:t.isError?{isError:!0,isLoading:!1,error:t.error.appError}:{isError:!1,isLoading:!1,output:t.data.apiData}),[t,n])},we=e=>{const{isNonUserRelativeContext:t}=a.useSharingApiContext(),n=i.getContentIdOrPathFromObjectIdentifier(e);return a.sharingListSharedLinksPackage.useQuery({apiArg:{path:n,direct_only:!0}},{staleTime:3e5,enabled:!t})};const xe={$props:c.atom({onClick:()=>{},onView:()=>{},oid:{".tag":"file",fileId:""},disableRightChevron:!1,objectMetadataResult:{isLoading:!0},objectMembersResult:{isLoading:!0,isFirstPageLoaded:!1},listSharedLinksResult:{isLoading:!0},seenStateInfoResult:{isLoading:!0},accountDataBatchResult:{isLoading:!0},intl:s.createIntl({locale:"en"})})},{StoreProvider:De,useStore:Pe}=c.defineStoreProvider((e=>({$props:e})),xe),$e=e=>{const t=s.useIntl(),{user:n}=a.useActiveUser(),r=a.useSharingObjectMetadata(e.oid),o=a.useObjectMembers(e.oid),i=ke(e.oid),l=Ie(e.oid),c=((e,t)=>{const a=[];return e.isFirstPageLoaded&&e.isFirstPageOnly?(e.firstPage.users.map((e=>a.push(e.user.account_id))),0===e.firstPage.users.length&&t&&a.push(t.account_id),a):[]})(o,n),d=Re(c);return y.createElement(De,{intl:t,objectMetadataResult:r,objectMembersResult:o,listSharedLinksResult:i,seenStateInfoResult:l,accountDataBatchResult:d,...e})};a.injectInternalStyle("/static/metaserver/static/js/sharing/sharing-sdk/legos/content-member-facepile-button/internals/button.module.out-vflo0kUrj.css",(e=>"._base-button_pkzqg_1{background:var(--dig-color__background__base);border:1px solid var(--dig-color__border__subtle);border-radius:var(--dig-radius__large);cursor:pointer;width:100%;word-break:break-word}._base-button_pkzqg_1:focus-visible{box-shadow:var(--dig-utilities__boxshadow__focus-ring)!important}._base-button_pkzqg_1:hover:not(:disabled){background:var(--dig-color__secondary__surface)}._base-button_pkzqg_1:active:not(:disabled){background:var(--dig-color__secondary__surface--state-1)}._content-member-facepile-button_pkzqg_22{background-color:var(--dig-color__opacity__surface--state-1);border:0;border-radius:17px;color:var(--dig-color__text__subtle);height:34px;margin-right:8px}._content-member-facepile-button-facepile_pkzqg_31{padding-left:12px}._content-member-facepile-button-facepile-other-item_pkzqg_35>*>div{background:var(--dig-color__secondary__surface--state-1)}._content-member-facepile-button-icon-container_pkzqg_40{align-items:center;display:flex;height:100%;justify-content:center}"));const Oe="_base-button_pkzqg_1",Fe="_content-member-facepile-button_pkzqg_22",Be="_content-member-facepile-button-facepile_pkzqg_31",je="_content-member-facepile-button-facepile-other-item_pkzqg_35",Ue="_content-member-facepile-button-icon-container_pkzqg_40",Ve=(e,t)=>y.default.createElement(a.Facepile.Item,{key:e,alt:t.name.display_name,cursor:"pointer","aria-label":t.name.display_name,src:t.profile_photo_url,"data-testid":"content-member-avatar"},qe(t.name.display_name)),He=(e,t)=>y.default.createElement(a.Facepile.Item,{key:e,cursor:"pointer","aria-label":t.user.display_name+" "+t.user.email,"data-testid":"content-member-avatar"},qe(t.user.display_name));function qe(e){return function(e){if(null==e||!(e.length>0))return"";const t=e.split(" ");let a=t.map((e=>e.charAt(0).toLowerCase()));a.length>2&&(a=a.splice(0,2));return a.join("")}(e).toUpperCase()}const We=({disableRightChevron:e})=>y.default.createElement("div",{className:Be,style:{paddingLeft:e?"12px":"8px",paddingRight:e?"6px":"0px"}},y.default.createElement(a.Facepile,{size:"xsmall",isInteractive:!1,interactivity:"Avatar"},new Array(3).fill(0).map(((e,t)=>(e=>y.default.createElement(a.Facepile.Item,{key:e,"data-testid":"skeleton-avatar"},y.default.createElement(a.Skeleton.Avatar,{size:"xsmall"})))(t))))),ze=e=>{const{accountData:t,objectMembers:n,disableRightChevron:r}=e,{user:s}=a.useActiveUser();let o=0,i=[];const{groups:l,users:c,invitees:u}=n,m=s?t[s.account_id]:void 0;var g;return m?i.push(Ve(o++,m)):s&&i.push(He(o++,(e=>({user:{account_id:e.account_id,email:e.email,display_name:e.display_name,same_team:!0,disabled:!1}}))(s))),l.forEach((e=>{i.push(((e,t)=>"team"===t.group.group_type[".tag"]?y.default.createElement(a.Facepile.Item,{key:e,cursor:"pointer",alt:t.group.group_name,"aria-label":t.group.group_name,"data-testid":"content-member-avatar"},y.default.createElement(a.UIIcon,{src:d.TeamLine,role:"presentation"})):y.default.createElement(a.Facepile.Item,{key:e,cursor:"pointer",alt:t.group.group_name,"aria-label":t.group.group_name,"data-testid":"content-member-avatar"},qe(t.group.group_name)))(o++,e))})),c.forEach((e=>{if(s&&e.user.account_id===s.account_id)return;const a=t[e.user.account_id];if(a){const e=Ve(o++,a);i.push(e)}else{const t=He(o++,e);i.push(t)}})),u.forEach((e=>{const t=((e,t)=>{var n,r;const s="email"===t.invitee[".tag"]?t.invitee.email:null===(n=t.user)||void 0===n?void 0:n.display_name;return y.default.createElement(a.Facepile.Item,{key:e,cursor:"pointer","aria-label":s,alt:null===(r=t.user)||void 0===r?void 0:r.display_name,"data-testid":"content-member-avatar"},qe(s))})(o++,e);i.push(t)})),i.length>3&&(i=i.slice(0,2),i.push((g=o++,y.default.createElement(a.Facepile.Item,{className:je,key:g,cursor:"pointer",colorPalette:{background:"#00000000",foreground:"var(--dig-color__text__base)"},"data-testid":"content-member-avatar"},y.default.createElement(a.UIIcon,{src:a.PersonMultipleLine,role:"presentation"}))))),y.default.createElement("div",{className:Be,style:{paddingRight:r?"6px":"0px"}},y.default.createElement(a.Facepile,{size:"xsmall",isInteractive:!1,interactivity:"Avatar"},i))};ze.displayName="ContentMemberFacepileButtonFacepile";const Ge=({children:e,accountData:t,objectMembers:n,objectMetadata:r})=>{const o=s.useIntl(),{user:i}=a.useActiveUser(),l=y.default.useMemo((()=>{if(a.getIsNonSharedFolder(r)&&a.getParentFolderName(r))return((e,t)=>e.formatMessage({id:"9P0o7J",defaultMessage:"All users with access to <b>{parentFolderName}</b> have access"},{parentFolderName:t,b:e=>y.default.createElement("b",null,e)}))(o,a.getParentFolderName(r));let e=!1,s=[];const{groups:l,users:c,invitees:d}=n;return c.forEach((e=>{if(!i||e.user.account_id!==i.account_id)if(Object.keys(t).length>0){const a=t[e.user.account_id];a&&s.push(a.name.display_name)}else s.push(e.user.display_name.split(" ")[0])})),l.forEach((e=>{s.push(e.group.group_name)})),d.forEach((t=>{var a,n;"email"===t.invitee[".tag"]?s.push(null!==(n=null===(a=t.user)||void 0===a?void 0:a.display_name)&&void 0!==n?n:t.invitee.email):e=!0})),s.length>3&&(e=!0,s=s.slice(0,3)),0===s.length?e?(e=>e.formatMessage({id:"EHtbiI",defaultMessage:"Others have access"}))(o):(e=>e.formatMessage({id:"oW+UlP",defaultMessage:"Only you have access"}))(o):e?((e,t)=>1===t.length?e.formatMessage({id:"kK5uwj",defaultMessage:"{member} and others have access"},{member:t[0]}):e.formatMessage({id:"jf6sct",defaultMessage:"{listOfMembers}, and others have access"},{listOfMembers:t.join(", ")}))(o,s):((e,t)=>1===t.length?e.formatMessage({id:"eRyaP6",defaultMessage:"{memberName} has access"},{memberName:t[0]}):2===t.length?e.formatMessage({id:"xi7j54",defaultMessage:"{firstMember} and {secondMember} have access"},{firstMember:t[0],secondMember:t[1]}):e.formatMessage({id:"seGTYd",defaultMessage:"{allButLastMember}, and {lastMember} have access"},{allButLastMember:t.slice(0,-1).join(", "),lastMember:t[t.length-1]}))(o,s)}),[r,n,o,i,t]);return y.default.createElement(a.Tooltip,{title:l,placement:"bottom",maxWidth:160},y.default.createElement("div",null,e))};Ge.displayName="ContentMemberFacepileButtonTooltip";const Ze=[{action:{".tag":"make_editor"},allow:!1},{action:{".tag":"make_owner"},allow:!1},{action:{".tag":"make_viewer"},allow:!1},{action:{".tag":"make_viewer_no_comment"},allow:!1},{action:{".tag":"remove"},allow:!1}],Qe=()=>{const e=Pe(),{disableRightChevron:t}=c.useAtom(e.$props);return y.default.createElement(a.StylelessButton,{"data-testid":"content-member-facepile-button",className:a.cx(Oe,Fe)},y.default.createElement(We,{disableRightChevron:t}),!0!==t&&y.default.createElement(a.Box,{className:Ue},y.default.createElement(a.UIIcon,{size:"small",src:a.ChevronRightLine})))},Ye=()=>{const e=Pe(),t=c.useAtom(e.$props),{objectMetadataResult:a,objectMembersResult:n,listSharedLinksResult:r,seenStateInfoResult:s,accountDataBatchResult:o,onView:i}=t,l=y.default.useRef(!1),d=a.isLoading,u=!a.isLoading&&!a.isError,m=n.isLoading,g=n.isFirstPageLoaded&&n.isFirstPageOnly,_=!r.isLoading&&!r.isError,p=_?r.output:void 0,f=r.isLoading,E=s.isLoading||s.isError?void 0:s.output,b=Te(E,p),h=(M=b)?M.map((e=>{const{seen_state_user:{user_id:t,display_name:a,email:n,sharing_access_type:r,same_team:s},when_last_seen:o}=e;let i={".tag":"viewer"};return r&&"edit_link_access"===r[".tag"]&&(i={".tag":"editor"}),{access_type:i,user:{account_id:t,display_name:a,email:n||"",same_team:s,disabled:!1},is_inherited:!1,permissions:Ze,time_last_seen:o?new Date(1e3*o).toString():void 0}})):[];var M;const S=(e=>{if(!e)return{};const t={};return e.forEach((e=>{const{seen_state_user:{user_id:a,display_name:n,email:r,photo_circle_url:s,same_team:o}}=e,i={account_id:a,name:{given_name:"",surname:"",familiar_name:"",display_name:n,abbreviated_name:""},email:r||"",email_verified:!0,profile_photo_url:s,is_teammate:o,disabled:!1};t[a]=i})),t})(b),v=!o.isLoading&&!o.isError,A=g&&u&&_,C=m||d||f;if(y.default.useEffect((()=>{!l.current&&A&&(l.current=!0,i())}),[A,i]),A){const e={...n.firstPage};e.users=[...e.users,...h];const t=v?{...o.output,...S}:S;return y.default.createElement(Ke,{objectMetadata:a.output,objectMembers:e,accountData:t})}return C?y.default.createElement(Qe,null):null};Ye.displayName="ContentMemberFacepileButtonWithStore";const Ke=({objectMembers:e,accountData:t,objectMetadata:n})=>{const r=Pe(),{onClick:o,disableRightChevron:i}=c.useAtom(r.$props);return y.default.createElement(Ge,{objectMembers:e,accountData:t,objectMetadata:n},y.default.createElement(a.StylelessButton,{disabled:i,className:a.cx(Oe,Fe),onClick:o,"data-uxa-log":"content_member_facepile_button","data-testid":"content-member-facepile-button","aria-label":s.intl.formatMessage({id:"B+lBmk",defaultMessage:"Manage access"})},y.default.createElement(ze,{objectMembers:e,accountData:t,disableRightChevron:i}),!0!==i&&y.default.createElement(a.Box,{className:Ue},y.default.createElement(a.UIIcon,{size:"small",src:a.ChevronRightLine}))))};Ke.displayName="ContentMemberFacepileButtonInner";const Je=e=>y.default.createElement(s.Provider,{value:s.intl},y.default.createElement($e,{...e},y.default.createElement(Ye,null)));var Xe;Je.displayName="ContentMemberFacepileButton",function(e){e.SUCCESS="SUCCESS",e.ERROR="ERROR",e.FATAL="FATAL"}(Xe||(Xe={}));const et=async(e,t)=>{"file_folder"===t[".tag"]&&a.prefetchFolderSharingObjectMetadata(t.path),a.prefetchListObjectMembersData(t),async function(e){const t=i.getContentIdOrPathFromObjectIdentifier(e);a.sharingListSharedLinksPackage.prefetchQuery(o.queryClient,{apiArg:{path:t,direct_only:!0}})}(t),"file"===t[".tag"]&&a.prefetchSeenStateInfoData(t.fileId);const n=await a.fetchObjectMembers(t,!0);if(n){const{groups:t,users:r,invitees:s}={...n};0===r.length&&0===t.length&&0===s.length&&e&&(n.users=[at(e)]);const i=n.users.map((e=>e.user.account_id)),l=await async function(e){if(0===e.length)return{status:Xe.SUCCESS,output:[]};const t=await a.getSharingApiv2ResponseWithErrors(a.getAccountBatchPackage.fetchQuery(o.queryClient,{apiArg:{account_ids:e}},{staleTime:3e5}));return"SUCCESS"===t.status?{status:Xe.SUCCESS,output:{...t.output}}:"ERROR"===t.status?t:{status:Xe.FATAL,error:{".tag":"api_error"}}}(i);if("SUCCESS"===l.status){const t=Object.values(l.output),a=t.find((t=>t.account_id===(null==e?void 0:e.account_id)));(null==a?void 0:a.profile_photo_url)&&tt(a.profile_photo_url),t.slice(0,2).forEach((e=>{e.profile_photo_url&&tt(e.profile_photo_url)}))}}},tt=e=>{(new Image).src=e},at=e=>({user:{account_id:e.account_id,email:e.email,display_name:e.display_name,same_team:!0,disabled:!1}}),nt=Symbol("ON_INITIAL_LOAD_START"),rt=Symbol("ON_INITIAL_LOAD_FAILURE"),st=Symbol("ON_INITIAL_LOAD_CANCEL"),ot=Symbol("ON_INITIAL_LOAD_SUCCESS"),it=Symbol("ON_FOLDER_ALREADY_SHARED"),lt=Symbol("ON_TEST_INITIAL_LOAD_START"),ct=Symbol("ON_TEST_INITIAL_LOAD_SUCCESS"),dt=Symbol("ON_TEST_INITIAL_LOAD_CANCEL"),ut=Symbol("ON_TEST_INITIAL_LOAD_FAILURE"),mt=Symbol("ON_TEST_REFRESH_LOAD_START"),gt=Symbol("ON_TEST_REFRESH_LOAD_SUCCESS"),_t=Symbol("ON_TEST_REFRESH_LOAD_CANCEL"),pt=Symbol("ON_TEST_REFRESH_LOAD_FAILURE"),ft=Symbol("ON_DOUBLE_READ_DIFF"),{useEmitter:Et,defaultEmitter:bt}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(i.Context$2),r=t(i.Context$3),s=t(i.Context),o=t(i.Context$1),l={...i.getTags(n),...i.getTags$1(r),...i.getTags$2(s)},c={...i.getProperties(n),...i.getProperties$1(r),...i.getProperties$2(s)};if(e.key!==nt){if(e.key===rt){let t="none";if("response"in e.payload.error)try{const a=e.payload.error.response.error;".tag"in a&&(t=a[".tag"]||"none")}catch(e){t="loggingFailure"}const n={...l,errorType:e.payload.error.type,errorTag:t,objMetadataNewApiVariant:e.payload.objMetadataNewApiVariant};return a.UDCL.logEnd(a.PAP_Load_ShareModal({eventState:"failed",...c}),{key:o,tags:n}),void a.UDCL.logEnd("ops.sm24.initial_data_load",{eventState:"failed",key:o,tags:n})}if(e.key===st){const t={...l,objMetadataNewApiVariant:e.payload.objMetadataNewApiVariant};return a.UDCL.logEnd(a.PAP_Load_ShareModal({eventState:"canceled",...c}),{eventState:"canceled",key:o,tags:t}),void a.UDCL.logEnd("ops.sm24.initial_data_load",{eventState:"canceled",key:o,tags:t})}if(e.key===ot){const t={...l,objMetadataNewApiVariant:e.payload.objMetadataNewApiVariant};return a.UDCL.logEnd(a.PAP_Load_ShareModal({eventState:"success",...c}),{key:o,tags:t}),void a.UDCL.logEnd("ops.sm24.initial_data_load",{eventState:"success",key:o,tags:t})}if(e.key!==it)if(e.key!==lt)if(e.key!==ct)if(e.key!==dt)if(e.key!==ut)if(e.key!==mt)if(e.key!==gt)if(e.key!==_t)if(e.key!==pt){if(e.key===ft){const t=e.payload.diffs.reduce(((e,t)=>({...e,[`diff_${t.field}`]:"true"})),{});a.UDCL.logEvent("ops.sm24.double_read_diff",{tags:t,detail:{fileId:e.payload.fileId,diffs:e.payload.diffs}})}}else{let t="none";if("response"in e.payload.error)try{const a=e.payload.error.response;".tag"in a&&(t=a[".tag"]||"none")}catch(e){t="loggingFailure"}a.UDCL.logEnd("ops.sm24.test_refresh_data_load",{eventState:"failed",key:o,tags:{...l,errorType:e.payload.error.type,errorTag:t}})}else a.UDCL.logEnd("ops.sm24.test_refresh_data_load",{eventState:"canceled",key:o,tags:l});else a.UDCL.logEnd("ops.sm24.test_refresh_data_load",{eventState:"success",key:o,tags:l});else a.UDCL.logStart("ops.sm24.test_refresh_data_load",{key:o,tags:l});else{let t="none";if("response"in e.payload.error)try{const a=e.payload.error.response;".tag"in a&&(t=a[".tag"]||"none")}catch(e){t="loggingFailure"}a.UDCL.logEnd("ops.sm24.test_initial_data_load",{eventState:"failed",key:o,tags:{...l,errorType:e.payload.error.type,errorTag:t}})}else a.UDCL.logEnd("ops.sm24.test_initial_data_load",{eventState:"canceled",key:o,tags:l});else a.UDCL.logEnd("ops.sm24.test_initial_data_load",{eventState:"success",key:o,tags:l});else a.UDCL.logStart("ops.sm24.test_initial_data_load",{key:o,tags:l});else a.UDCL.logEvent("ops.sm24.already_shared",{tags:l})}else{const t={...l,objMetadataNewApiVariant:e.payload.objMetadataNewApiVariant};a.UDCL.logStart("ops.sm24.initial_data_load",{key:o,tags:t})}})),ht=e=>{const t=Et(),{isNonUserRelativeContext:n}=a.useSharingApiContext();return y.useCallback((async()=>{const r=e.$nonce.get(),s=e.$options.get(),i=e.$state.get();let l=s.objectIdentifier;"loaded"===i.status&&(l=i.objectIdentifier);const c=s.objMetadataNewApiVariant,d="V1"===c&&l.fileId,m=!d,g="ON"===c&&l.fileId;t.select(nt).emit({objMetadataNewApiVariant:c});const _=a=>{e.$state.set({status:"error",errorType:"INITIAL_LOAD_ERROR",loadError:a}),t.select(rt).emit({error:a,objMetadataNewApiVariant:c})},p=await a.getSharingApiv2ResponseWithErrors(a.sharingPrefsPackage.fetchQuery(o.queryClient,{})),f=await a.getSharingApiv2ResponseWithErrors(a.sharingAccountInfoPackage.fetchQuery(o.queryClient,{},{staleTime:18e5}));let E,b,h,M;if(d?b=await a.getSharingApiv2ResponseWithErrors(a.sharingObjectMetadataPackage.fetchQuery(o.queryClient,{apiArg:{file_id:l.fileId},pkgArg:{isNonUserRelativeContext:n}},{staleTime:3e5})):E=await o.queryClient.fetchQuery(["object-metadata",s.objectIdentifier],(()=>a.getSharingObjectMetadata(l,n))),g&&(t.select(lt).emit(null),h=await a.getSharingApiv2ResponseWithErrors(a.sharingObjectMetadataPackage.fetchQuery(o.queryClient,{apiArg:{file_id:l.fileId},pkgArg:{isNonUserRelativeContext:n}},{staleTime:3e5})),"SUCCESS"===h.status?t.select(ct).emit(null):"ERROR"===h.status?t.select(ut).emit({error:{type:"METADATA_ERROR_V2",response:h.error}}):t.select(ut).emit({error:{type:"METADATA_FATAL_V2",response:{status:a.Status$1.FATAL,error:h}}})),r!==e.$nonce.get())return t.select(st).emit({objMetadataNewApiVariant:c}),void(g&&t.select(dt).emit(null));if(m){if(!E)return void _({type:"OTHER"});if("SUCCESS"!==E.status)return void("ERROR"===E.status?(u.reportStack("SM24 initial data loader error",{severity:u.SEVERITY.NONCRITICAL,tags:["sm24_initial_data_loader_error_V1"],exc_extra:{file_id:l.fileId,error:E},silent:!1}),_({type:"METADATA_ERROR",response:E})):(u.reportStack("SM24 initial data loader error",{severity:u.SEVERITY.NONCRITICAL,tags:["sm24_initial_data_loader_fatal_V1"],exc_extra:{file_id:l.fileId,error:E},silent:!1}),_({type:"METADATA_FATAL",response:E})));M=E.output}else{if(!b)return void _({type:"OTHER"});if("SUCCESS"!==b.status)return void("ERROR"===b.status?(u.reportStack("SM24 initial data loader error",{severity:u.SEVERITY.NONCRITICAL,tags:["sm24_initial_data_loader_error_V2"],exc_extra:{file_id:l.fileId,error:b},silent:!1}),_({type:"METADATA_ERROR_V2",response:b})):(u.reportStack("SM24 initial data loader error",{severity:u.SEVERITY.NONCRITICAL,tags:["sm24_initial_data_loader_fatal_V2"],exc_extra:{file_id:l.fileId,error:b},silent:!1}),_({type:"METADATA_FATAL_V2",response:b})));M=b.output}if(g&&"SUCCESS"===(null==h?void 0:h.status)){const e=a.normalizeNewApiMetadata(h.output),n=a.normalizeOldApiMetadata(M),{redactedDiffs:r,originalDiffs:s}=a.diffNormalizedMetadata(n,e);if(r.length>0){const e=h.output.common_metadata.file_id;if(t.select(ft).emit({fileId:e,diffs:r}),s.length>0){const t=["sm24_metadata_diff",...s.map((e=>e.field)).map((e=>`diff_field_${e}`))];u.reportStack("SM24 metadata diff found",{severity:u.SEVERITY.NONCRITICAL,tags:t,exc_extra:{file_id:e,original_diffs:s},silent:!0})}}}if("SUCCESS"!==f.status||"SUCCESS"!==p.status)return void("SUCCESS"!==p.status?"ERROR"===p.status?_({type:"SHARING_PREFS_ERROR",response:p}):_({type:"SHARING_PREFS_FATAL",response:p}):"SUCCESS"!==f.status?_({type:"SHARING_ACCOUNT_INFO_ERROR"}):_({type:"OTHER"}));let S=l;"file_folder"===l[".tag"]&&a.getIsSharedFolder(M)&&(S={".tag":"shared_folder",sharedFolderId:a.getSharedFolderId(M),fileId:l.fileId}),e.$state.set({status:"loaded",objectIdentifier:S,memberActionsInProgress:{},memberAccountIdsAlreadyFetched:{},accountMetadata:f.output,memberAccounts:{},objectMetadata:M,sharingPrefs:p.output}),t.select(ot).emit({objMetadataNewApiVariant:c})}),[e,t])},Mt=e=>{const t=(e=>y.useCallback((t=>{(e.$options.get().onRefreshError||(()=>{}))(t)}),[e]))(e),{isNonUserRelativeContext:n}=a.useSharingApiContext(),r=Et();return y.useCallback((async()=>{const s=e.$state.get();if("loaded"!==s.status)return;const i=e.$nonce.get(),l=e.$state.get(),c=e.$options.get().objMetadataNewApiVariant,d="V1"===c&&s.objectIdentifier.fileId,u=!d,m="ON"===c&&s.objectIdentifier.fileId;let g,_,p,f;if(d?_=await a.getSharingApiv2ResponseWithErrors(a.sharingObjectMetadataPackage.fetchQuery(o.queryClient,{apiArg:{file_id:s.objectIdentifier.fileId},pkgArg:{isNonUserRelativeContext:n}},{staleTime:3e5})):g=await a.getSharingObjectMetadata(s.objectIdentifier,n),m&&(r.select(mt).emit(null),p=await a.getSharingApiv2ResponseWithErrors(a.sharingObjectMetadataPackage.fetchQuery(o.queryClient,{apiArg:{file_id:s.objectIdentifier.fileId},pkgArg:{isNonUserRelativeContext:n}},{staleTime:3e5})),"SUCCESS"===p.status?r.select(gt).emit(null):"ERROR"===p.status?r.select(pt).emit({error:{type:"METADATA_ERROR_V2",response:p.error}}):r.select(pt).emit({error:{type:"METADATA_FATAL_V2",response:{status:a.Status$1.FATAL,error:p}}})),e.$nonce.get()!==i||"loaded"!==l.status)return null;if(u){if(!g)return void t({type:"OTHER"});if("ERROR"===g.status)return t({type:"METADATA_ERROR",response:g}),void e.$state.set({status:"error",errorType:"REFRESH_LOAD_ERROR",loadError:{type:"METADATA_ERROR",response:g}});if("FATAL"===g.status)return t({type:"FATAL",response:g}),void e.$state.set({status:"error",errorType:"REFRESH_LOAD_ERROR",loadError:{type:"FATAL",response:g}});f=g.output}else{if(!_)return void t({type:"OTHER"});if("ERROR"===_.status)return t({type:"METADATA_ERROR_V2",response:_}),void e.$state.set({status:"error",errorType:"REFRESH_LOAD_ERROR",loadError:{type:"METADATA_ERROR_V2",response:_}});if("FATAL"===_.status)return t({type:"FATAL",response:_}),void e.$state.set({status:"error",errorType:"REFRESH_LOAD_ERROR",loadError:{type:"FATAL",response:_}});f=_.output}let E=l.objectIdentifier;return"file_folder"===l.objectIdentifier[".tag"]&&a.getIsSharedFolder(f)&&(E={".tag":"shared_folder",sharedFolderId:a.getSharedFolderId(f),fileId:l.objectIdentifier.fileId}),e.$state.set({...l,objectMetadata:f,objectIdentifier:E}),null}),[e,t,r])},St=e=>{const t=ht(e),{variant:n,isLoading:r}=a.useExperimentVariant("sm24_obj_metadata_new_api"),s=!r,[o,l]=y.useState(null);y.useEffect((()=>{const r=null===(d=e.$options.get()).sessionId?null:"file"===d.objectIdentifier[".tag"]?`file:${d.sessionId}:${i.getContentIdOrPathFromObjectIdentifier(d.objectIdentifier)}`:"file_folder"===d.objectIdentifier[".tag"]?`folder:${d.sessionId}:${i.getContentIdOrPathFromObjectIdentifier(d.objectIdentifier)}`:`shared_folder:${d.sessionId}:${i.getContentIdOrPathFromObjectIdentifier(d.objectIdentifier)}`;var d;if(null===r)return null!==o&&l(null),void("unloaded"!==e.$state.get().status&&c.batch((()=>{e.$nonce.set(e.$nonce.get()+1),e.$state.set({status:"unloaded"})})));s&&(r===o&&"unloaded"!==e.$state.get().status||(c.batch((()=>{e.$nonce.set(e.$nonce.get()+1),e.$state.set({status:"loading"})})),l(r),e.$options.set({...e.$options.get(),objMetadataNewApiVariant:n}),a.logExposure({feature:"sm24_obj_metadata_new_api",variant:n}),t()))}))},vt=e=>{const t=Mt(e),a=ht(e),n=(e=>y.useCallback((t=>{const a=e.$state.get();"loaded"===a.status&&e.$state.set({...a,objectIdentifier:t})}),[e]))(e),r=c.useStore(e.$state);return y.useMemo((()=>({...r,refreshObjectMetadata:t,refreshModal:a,onObjectIdentifierChanged:n})),[r,t,a,n])},yt=e=>{const t=(e=>c.useInitStore(e,(()=>({$nonce:c.store(0),$options:c.store(e),$state:c.store({status:"unloaded"})}))))(e);return St(t),(e=>{const t=e.$state.get(),{user:n,isLoading:r}=a.useActiveUser(),s="loaded"===t.status&&!a.getIsLinkOnlyMode(t.objectMetadata)&&(a.getCanInvite(t.objectMetadata,i.VIEWER)||a.getCanInvite(t.objectMetadata,i.EDITOR)),o=e.$options.get().objectIdentifier;y.useEffect((()=>{s&&!r&&n&&et(n,o)}),[s,r,n,o])})(t),(e=>{y.useEffect((()=>()=>{c.batch((()=>{e.$nonce.set(e.$nonce.get()+1),e.$state.set({status:"unloaded"})}))}),[])})(t),vt(t)},At=({children:e,...t})=>{const a=yt(t);return y.createElement(o.QueryClientProvider,{client:o.queryClient},y.createElement(y.Fragment,null,e(a)))};At.displayName="ShareModalDataLoader";const Ct=y.createContext({status:"unloaded"}),It=({children:e,...t})=>y.createElement(At,{...t},(t=>y.createElement(Ct.Provider,{value:t},e)));It.displayName="Provider";const Tt=()=>y.useContext(Ct),Lt=Symbol("ON_CLICK_PROGRESSIVE"),Rt=Symbol("ON_MOUSE_ENTER_PROGRESSIVE"),Nt=Symbol("ON_MOUSE_LEAVE_PROGRESSIVE"),{useEmitter:kt,defaultEmitter:wt}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(i.Context$2),r=t(i.Context$3),s=t(i.Context),o={...i.getTags(n),...i.getTags$1(r),...i.getTags$2(s)},l={...i.getProperties(n),...i.getProperties$1(r),...i.getProperties$2(s)};if(e.key===Lt)return a.UDCL.logEvent(i.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...o,action:"copy_link"}}),void a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...o,action:"copy_link"}});if(e.key!==Rt){if(e.key!==Nt)return a.exhausts(e,void 0);a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...o,action:"copy_link"}})}else a.UDCL.logEvent(U({...l,flexibleSharingEntryPointAction:"copy_link"}),{tags:{...o,action:"copy_link"}})})),xt=e=>{const{objectMetadata:t,accountMetadata:n,onCopyLinkButtonClicked:r,componentViewTime:o}=e,l=a.isNewApiMetadata(t),[c,d]=y.useState(!1),[u,g]=y.useState(!1),[_,p]=y.useState(0),f=y.useRef(null),E=kt(),b=i.isTmrMember(n),h=a.getCanCreateLink(t,a.VIEWER,b),M=a.getCanCreateLink(t,a.EDITOR,b)||h,S=y.useCallback((()=>{const e=u?Date.now()-_:void 0,t=Date.now()-o;E.select(Lt).emit({dwellTime:e,timeSinceView:t}),r()}),[o,E,u,r,_]),v=y.useCallback((()=>{p(Date.now()),g(!0),E.select(Rt).emit(null),d(!0)}),[E]),A=y.useCallback((()=>{const e=u?Date.now()-_:void 0;g(!1),E.select(Nt).emit({dwellTime:e}),d(!1)}),[E,u,_]),C=y.useMemo((()=>!!l&&!M),[l,M]);return y.createElement(y.Fragment,null,y.createElement(m.ButtonWrapper,{ref:f,onMouseEnter:v,onMouseLeave:A,"data-uxa-log":"sharing-lego-copy_link-button.loaded","data-uxa-interactions":"shown click"},y.createElement(m.VerticalButton,{onClick:S,disabled:C,"data-testid":"copy-link-entry-button"},y.createElement(m.ButtonIconContainer,null,y.createElement(a.UIIcon,{src:a.LinkLine,size:"medium","data-testid":"copy-link-entry-button-icon"})),y.createElement(m.Spacer,null),y.createElement(m.ButtonInnerColumn,null,y.createElement(m.ButtonTitle,{content:(I=s.intl,I.formatMessage({id:"1xxmJZ",defaultMessage:"Copy link"}))})))),(()=>{let e=null;return l&&!M&&(e=y.createElement(a.Text,null,s.intl.formatMessage({id:"wVml0u",defaultMessage:"You don’t have permission to copy this link."}))),e?y.createElement(a.Tooltip.Control,{open:c,placement:"top",auto:!0,triggerRef:f,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1)},e):null})());var I};xt.displayName="CopyLinkEntryButtonInner";const Dt=e=>{const{objectIdentifier:t,onCopyLinkButtonClicked:n,componentViewTime:r}=e,s=a.useSharingObjectMetadata(t),o=i.useSharingAccountInfo(),l=s.isLoading,c=!s.isLoading&&s.isError,d=l||c?void 0:s.output,u=o.isLoading,g=!o.isLoading&&o.isError,_=u||g?void 0:o.output;return l||u?y.createElement(m.ButtonWrapper,{"data-uxa-log":"sharing-lego-copy-link-button.loading","data-uxa-interactions":"shown click"},y.createElement(m.VerticalButton,{disabled:!0},y.createElement(m.ButtonIconContainer,null,y.createElement(a.UIIcon,{src:a.LinkLine,size:"medium"})),y.createElement(m.Spacer,null),y.createElement(m.ButtonInnerColumn,null,y.createElement(a.Skeleton.Text,{size:"small",style:{marginTop:22}})))):d&&_?y.createElement(xt,{accountMetadata:_,objectMetadata:d,onCopyLinkButtonClicked:n,componentViewTime:r}):null};Dt.displayName="CopyLinkEntryButton";const Pt=Symbol("ON_CLICK"),$t=Symbol("ON_MOUSE_ENTER"),Ot=Symbol("ON_MOUSE_LEAVE"),{useEmitter:Ft,defaultEmitter:Bt}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(i.Context$2),r=t(i.Context$3),s=t(i.Context),o={...i.getTags(n),...i.getTags$1(r),...i.getTags$2(s)},l={...i.getProperties(n),...i.getProperties$1(r),...i.getProperties$2(s)};if(e.key===Pt)return a.UDCL.logEvent(i.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...o,action:"copy_link"}}),void a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...o,action:"copy_link"}});e.key!==$t?e.key!==Ot||a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"copy_link",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...o,action:"copy_link"}}):a.UDCL.logEvent(U({...l,flexibleSharingEntryPointAction:"copy_link"}),{tags:{...o,action:"copy_link"}})})),jt=({store:e,objectMetadata:t})=>{const n=!!t&&a.isNewApiMetadata(t),[r,o]=y.useState(!1),i=y.useRef(null),l=Ft(),c=!!t&&a.getCanCreateLink(t,a.VIEWER,!1),d=!!t&&a.getCanCreateLink(t,a.EDITOR,!1),u=c||d,g=y.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,a=Date.now()-e.$componentViewTime.get();l.select(Pt).emit({dwellTime:t,timeSinceView:a}),e.$isHovered.set(!1),e.$props.get().onClickCopyLinkButton()}),[l,e]),_=y.useCallback((()=>{l.select($t).emit(null),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now()),o(!0)}),[l,e]),p=y.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;l.select(Ot).emit({dwellTime:t}),e.$isHovered.set(!1),e.$hoverStartTime.set(0),o(!1)}),[l,e]);y.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]);const f=!!n&&!u;return y.createElement(y.Fragment,null,y.createElement(m.ButtonWrapper,{ref:i,onMouseEnter:_,onMouseLeave:p,"data-uxa-log":"sm24-copy_link-button.loaded","data-uxa-interactions":"shown click"},y.createElement(m.VerticalButton,{onClick:g,disabled:f,"data-testid":"copy-link-button"},y.createElement(m.ButtonIconContainer,null,y.createElement(a.UIIcon,{src:a.LinkLine,size:"medium","data-testid":"copy-link-icon"})),y.createElement(m.Spacer,null),y.createElement(m.ButtonInnerColumn,null,y.createElement(m.ButtonTitle,{content:(E=s.intl,E.formatMessage({id:"1xxmJZ",defaultMessage:"Copy link"}))})))),(()=>{let e=null;return n&&!u&&(e=y.createElement(a.Text,null,s.intl.formatMessage({id:"wVml0u",defaultMessage:"You don’t have permission to copy this link."}))),e?y.createElement(a.Tooltip.Control,{open:r,placement:"top",auto:!0,triggerRef:i,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1)},e):null})());var E};jt.displayName="LoadedButton";const Ut=()=>y.createElement(m.ButtonWrapper,{"data-uxa-log":"sm24-copy-link-button.loading","data-uxa-interactions":"shown click"},y.createElement(m.VerticalButton,{disabled:!0},y.createElement(m.ButtonIconContainer,null,y.createElement(a.UIIcon,{src:a.LinkLine,size:"medium"})),y.createElement(m.Spacer,null),y.createElement(m.ButtonInnerColumn,null,y.createElement(a.Skeleton.Text,{size:"small",style:{marginTop:22}}))));Ut.displayName="LoadingButton";const Vt=({store:e})=>{const{variant:t,isLoading:n}=a.useExperimentVariant("sm24_obj_metadata_new_api"),r=Tt();return n||"V1"===t&&"loading"===r.status?y.createElement(Ut,null):"V1"===t&&"error"===r.status?null:"V1"===t&&"loaded"===r.status?y.createElement(jt,{store:e,objectMetadata:r.objectMetadata}):y.createElement(jt,{store:e})};Vt.displayName="Inner";const Ht=e=>{const t=(e=>c.useInitStore(e,(e=>({$props:e,$isHovered:c.store(!1),$hoverStartTime:c.store(0),$componentViewTime:c.store(0)}))))(e);return y.createElement(Vt,{store:t})};var qt;Ht.displayName="CopyLinkButton",function(e){e.MAIN="main",e.QRCODE="qrcode",e.INBAND="inband",e.MANAGE_ACCESS="manage_access",e.COPY_LINK="copy_link"}(qt||(qt={}));const Wt=({store:e})=>{const{objectIdentifier:t}=c.useStore(e.$props),n=c.useStore(e.$componentViewTime),{variant:r,isLoading:s}=a.useExperimentVariant("sm24_progressive_oob_m1"),o=y.useCallback((()=>{c.batch((()=>{e.$props.get().copyLinkHandler(),e.$props.get().onActionClicked(!0)}))}),[e]),i=y.useCallback((()=>{c.batch((()=>{e.$currentScreen.set(qt.COPY_LINK)}))}),[e]);return y.useMemo((()=>(a.logExposure({feature:"sm24_progressive_oob_m1",variant:r}),!s&&"V1"===r)),[r,s])?y.createElement(Dt,{onCopyLinkButtonClicked:i,objectIdentifier:t,componentViewTime:n}):y.createElement(Ht,{onClickCopyLinkButton:o,objectIdentifier:t})};Wt.displayName="CopyLinkButton";a.injectInternalStyle("/static/metaserver/static/js/sharing/features/shareme24/stacks/button.module.out-vflEzXR9Y.css",(e=>"._image-container_eq6ie_1{border:1px solid var(--dig-color__border__subtle);border-radius:4px;bottom:-4px;box-shadow:var(--dig-utilities__boxshadow__raised);position:absolute;right:-41.617px}._image-container_eq6ie_1>img{aspect-ratio:144.62/107;height:107px;width:144.617px}._learn-more-link_eq6ie_16{color:var(--dig-color__text__base)}"));const zt=e=>e.formatMessage({id:"UHUZRk",defaultMessage:"Add branding and access AI chat."}),Gt=e=>e.formatMessage({id:"EioSQ8",defaultMessage:"Learn more"}),Zt=e=>e.formatMessage({id:"fTDVXg",defaultMessage:"Stacks illustration"});var Qt,Yt="https://"+g.computeDomains(null!==(Qt=window.__DEV_SERVER_HOSTNAME__)&&void 0!==Qt?Qt:"")[0].WEB_STATIC_CLOUDFLARE_CDN_HOST+"/static/metaserver/static/js/sharing/features/shareme24/stacks/stacks_on_share_modal-vflyZVUj5.png";const Kt="stack-button",Jt=({store:e})=>{const{onClickStackButton:t}=e.$props.get(),n=y.useCallback((()=>{t()}),[t]);return y.createElement(y.Fragment,null,y.createElement(m.ButtonWrapper,{"data-uxa-log":"sm24-stack-button.loaded","data-uxa-interactions":"shown click"},y.createElement(m.VerticalButton,{"data-testid":Kt,customStyles:{height:"102px",position:"relative",overflow:"hidden"},onClick:n},y.createElement(m.ButtonIconContainer,null,y.createElement(a.UIIcon,{src:_.CreateStackFill,size:"medium"})),y.createElement(m.Spacer,null),y.createElement(m.ButtonInnerColumn,null,y.createElement(m.ButtonTitle,{content:(r=s.intl,r.formatMessage({id:"ESWJWi",defaultMessage:"Curate with stacks"}))}),y.createElement(m.ButtonSubtitle,{content:zt(s.intl)}),y.createElement(m.ButtonLink,{className:"_learn-more-link_eq6ie_16",content:Gt(s.intl),href:"https://dash.dropbox.com/features/stacks"})),y.createElement(a.Box,{className:"_image-container_eq6ie_1"},y.createElement("img",{src:Yt,alt:Zt(s.intl)})))));var r};Jt.displayName="StackButton";const Xt=({store:e})=>{const{isFolderFileCountOverLimit:t}=c.useStore(e.$props),[n,r]=y.useState(!1),o=y.useRef(null),i=y.useCallback((()=>{r(!0)}),[]),l=y.useCallback((()=>{r(!1)}),[]);return y.createElement(y.Fragment,null,y.createElement(m.ButtonWrapper,{ref:o,onMouseEnter:i,onMouseLeave:l,"data-uxa-log":"sm24-stack-button.disabled","data-uxa-interactions":"shown click"},y.createElement(m.HorizontalButton,{disabled:!0,"data-testid":Kt},y.createElement(m.ButtonIconContainer,null,y.createElement(a.UIIcon,{src:_.CreateStackFill,size:"medium"})),y.createElement(m.ButtonInnerColumn,null,y.createElement(m.ButtonTitle,{content:(d=s.intl,d.formatMessage({id:"ayyCIh",defaultMessage:"Add to stack"}))})))),t&&y.createElement(a.Tooltip.Control,{open:n,placement:"left",auto:!0,triggerRef:o,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1)},y.createElement(a.Text,null,(e=>e.formatMessage({id:"HVfk/B",defaultMessage:"Can’t add more than 200 files to a stack at a time"}))(s.intl))));var d};Xt.displayName="StackButtonDisabled";const ea=()=>y.createElement(m.ButtonWrapper,{"data-uxa-log":"sm24-stack-button.loading","data-uxa-interactions":"shown click"},y.createElement(m.HorizontalButton,{disabled:!0},y.createElement(a.Skeleton.Avatar,{size:"medium",style:{marginRight:"var(--dig-spacing__dimension__12)"}}),y.createElement(a.Skeleton.Text,{size:"large",width:200})));ea.displayName="LoadingButton";const ta=({store:e})=>{const{isFolderFileCountOverLimit:t,contents:a}=c.useStore(e.$props);return null===t?y.createElement(ea,null):null===a?y.createElement(Xt,{store:e}):y.createElement(Jt,{store:e})};ta.displayName="Inner";const aa=e=>{const t=(e=>{const t=Tt(),a=c.useInitStore(t,(e=>e));return c.useInitStore(e,(e=>({$props:e,$data:a})))})(e);return y.createElement(ta,{store:t})};aa.displayName="StacksButton";const na=({store:e})=>{const t=y.useCallback((()=>{e.$props.get().createStackHandler(),e.$props.get().onActionClicked()}),[e]),a=c.useStore(e.$isFolderFileCountOverLimit),n=c.useStore(e.$contents);return y.createElement(aa,{onClickStackButton:t,isFolderFileCountOverLimit:a,contents:n})};na.displayName="DashStacksButton";const ra=({store:e})=>{const{objectIdentifier:t}=c.useStore(e.$props),a=c.useStore(e.$componentViewTime),n=y.useCallback((()=>{c.batch((()=>{e.$isEnteringInband.set(!0),e.$currentScreen.set(qt.INBAND),e.$isInbandStarted.set(!0)}))}),[e]);return y.createElement(Y,{oid:t,onInbandButtonClicked:n,componentViewTime:a})};ra.displayName="InbandInviteButton";const sa=e=>e.formatMessage({id:"O6jjXZ",defaultMessage:"Create a view-only QR code"}),oa=Symbol("ON_CLICK"),ia=Symbol("ON_MOUSE_ENTER"),la=Symbol("ON_MOUSE_LEAVE"),{useEmitter:ca,defaultEmitter:da}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(i.Context$2),r=t(i.Context$3),s=t(i.Context),o={...i.getTags(n),...i.getTags$1(r),...i.getTags$2(s)},l={...i.getProperties(n),...i.getProperties$1(r),...i.getProperties$2(s)};if(e.key===oa)return a.UDCL.logEvent(i.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"qr_code",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...o,action:"qr_code"}}),void a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"qr_code",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...o,action:"qr_code"}});e.key!==ia?e.key!==la||a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"qr_code",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...o,action:"qr_code"}}):a.UDCL.logEvent(U({...l,flexibleSharingEntryPointAction:"qr_code"}),{tags:{...o,action:"qr_code"}})})),ua=({store:e})=>{const[t,n]=y.useState(!1),r=y.useRef(null),o=ca(),i=y.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,a=Date.now()-e.$componentViewTime.get();o.select(oa).emit({dwellTime:t,timeSinceView:a}),e.$isHovered.set(!1),e.$props.get().onClickQrCodeButton()}),[e,o]),l=y.useCallback((()=>{o.select(ia).emit(null),n(!0),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,o]),c=y.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;o.select(la).emit({dwellTime:t}),n(!1),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,o]);return y.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]),y.createElement(y.Fragment,null,y.createElement(m.UtilityIconButton,{"data-testid":"qr-code-button",onClick:i,onMouseEnter:l,onMouseLeave:c,ref:r,variant:e.$props.get().buttonVariant,"data-uxa-log":"sm24-qrcode-button.loaded","data-uxa-interactions":"shown click"},y.createElement(a.UIIcon,{src:_.QrCodeLine,"aria-label":sa(s.intl)})),y.createElement(a.Tooltip.Control,{open:t,placement:"top",auto:!0,triggerRef:r,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},y.createElement(a.Text,null,sa(s.intl))))};ua.displayName="LoadedButton";const ma=({store:e})=>y.createElement(ua,{store:e});ma.displayName="Inner";const ga=e=>{const t=(e=>{const t=Tt(),a=c.useInitStore(t,(e=>e));return c.useInitStore(e,(e=>{const t=c.store(!1),n=c.store(0),r=c.store(0);return{$props:e,$data:a,$isHovered:t,$hoverStartTime:n,$componentViewTime:r}}))})(e);return y.createElement(ma,{store:t})};ga.displayName="QrCodeButton";const _a=({store:e,buttonVariant:t})=>{const a=y.useCallback((()=>{c.batch((()=>{e.$isExitingMainToQr.set(!0),e.$isEnteringQr.set(!0)}))}),[e.$isExitingMainToQr,e.$isEnteringQr]);return y.createElement(ga,{onClickQrCodeButton:a,buttonVariant:t})};_a.displayName="QrCodeButton";const pa=e=>e.formatMessage({id:"8sEPDx",defaultMessage:"Settings"}),fa=Symbol("ON_CLICK"),Ea=Symbol("ON_MOUSE_ENTER"),ba=Symbol("ON_MOUSE_LEAVE"),{useEmitter:ha,defaultEmitter:Ma}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(i.Context$2),r=t(i.Context$3),s=t(i.Context),o={...i.getTags(n),...i.getTags$1(r),...i.getTags$2(s)},l={...i.getProperties(n),...i.getProperties$1(r),...i.getProperties$2(s)};if(e.key===fa)return a.UDCL.logEvent(i.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"settings",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...o,action:"settings"}}),void a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"settings",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...o,action:"settings"}});e.key!==Ea?e.key!==ba||a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"settings",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...o,action:"settings"}}):a.UDCL.logEvent(U({...l,flexibleSharingEntryPointAction:"settings"}),{tags:{...o,action:"settings"}})})),Sa=({store:e})=>{const[t,n]=y.useState(!1),r=y.useRef(null),o=ha(),l=y.useCallback((()=>{const t=e.$data.get(),n=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,r=Date.now()-e.$componentViewTime.get();o.select(fa).emit({dwellTime:n,timeSinceView:r}),e.$isHovered.set(!1);let s=!1;"loaded"!==t.status||a.isNewApiMetadata(t.objectMetadata)?"loaded"===t.status&&a.isNewApiMetadata(t.objectMetadata)&&(s=!a.getCanInvite(t.objectMetadata,i.VIEWER)&&!a.getCanInvite(t.objectMetadata,i.EDITOR)):s=a.getIsLinkOnlyMode(t.objectMetadata),e.$props.get().onClickSettingsButton({shouldOpenLinkSettings:s})}),[e,o]),c=y.useCallback((()=>{o.select(Ea).emit(null),n(!0),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,o]),d=y.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;o.select(ba).emit({dwellTime:t}),n(!1),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,o]);return y.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]),y.createElement(y.Fragment,null,y.createElement(m.UtilityIconButton,{"data-testid":"settings-button",onClick:l,onMouseEnter:c,onMouseLeave:d,ref:r,variant:e.$props.get().buttonVariant,"data-uxa-log":"sm24-settings-button.loaded","data-uxa-interactions":"shown click","data-campaign-element-id":"share-modal-settings-button"},y.createElement(a.UIIcon,{src:_.SettingsLine,"aria-label":pa(s.intl)})),y.createElement(a.Tooltip.Control,{open:t,placement:"top",auto:!0,triggerRef:r,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},y.createElement(a.Text,null,pa(s.intl))))};Sa.displayName="LoadedButton";const va=({store:e})=>y.createElement(Sa,{store:e});va.displayName="Inner";const ya=e=>{const t=(e=>{const t=Tt(),a=c.useInitStore(t,(e=>e));return c.useInitStore(e,(e=>{const t=c.store(!1),n=c.store(0),r=c.store(0);return{$props:e,$data:a,$isHovered:t,$hoverStartTime:n,$componentViewTime:r}}))})(e);return y.createElement(va,{store:t})};ya.displayName="SettingsButton";const Aa=({store:e,buttonVariant:t})=>{const a=c.useStore(e.$objectIdentifier),n=y.useCallback((t=>{e.$props.get().settingsHandler(t),e.$props.get().onActionClicked()}),[e]);return y.createElement(ya,{onClickSettingsButton:n,objectIdentifier:a,buttonVariant:t})};Aa.displayName="SettingsButton";const Ca=e=>e.formatMessage({id:"FuFURj",defaultMessage:"Transfer a copy"}),Ia=Symbol("ON_CLICK"),Ta=Symbol("ON_CLICK_ENABLE_TRANSFER"),La=Symbol("ON_MOUSE_ENTER"),Ra=Symbol("ON_MOUSE_LEAVE"),{useEmitter:Na,defaultEmitter:ka}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(i.Context$2),r=t(i.Context$3),s=t(i.Context),o={...i.getTags(n),...i.getTags$1(r),...i.getTags$2(s)},l={...i.getProperties(n),...i.getProperties$1(r),...i.getProperties$2(s)};if(e.key===Ia)return a.UDCL.logEvent(i.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"transfer",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...o,action:"transfer"}}),void a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"transfer",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...o,action:"transfer"}});e.key!==La?e.key!==Ra?e.key!==Ta||a.UDCL.logEvent(i.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"enable_transfer_tooltip"}),{tags:{...o,action:"transfer"}}):a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"transfer",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...o,action:"transfer"}}):a.UDCL.logEvent(U({...l,flexibleSharingEntryPointAction:"transfer"}),{tags:{...o,action:"transfer"}})})),wa=({store:e})=>{const t=Na(),n=y.useCallback((()=>{const a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,n=Date.now()-e.$componentViewTime.get();t.select(Ia).emit({dwellTime:a,timeSinceView:n}),e.$isHovered.set(!1),e.$props.get().onClickTransferButton()}),[e,t]),r=y.useCallback((()=>{t.select(La).emit(null),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,t]),o=y.useCallback((()=>{const a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;t.select(Ra).emit({dwellTime:a}),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,t]);return y.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]),y.createElement(y.Fragment,null,y.createElement(m.ButtonWrapper,{onMouseEnter:r,onMouseLeave:o,"data-uxa-log":"sm24-transfer-button.loaded","data-uxa-interactions":"shown click"},y.createElement(m.VerticalButton,{"data-testid":"transfer-button",onClick:n},y.createElement(m.ButtonIconContainer,null,y.createElement(a.UIIcon,{src:f.DropboxTransferLine,size:"medium"})),y.createElement(m.Spacer,null),y.createElement(m.ButtonInnerColumn,null,y.createElement(m.ButtonTitle,{content:Ca(s.intl)})))))};wa.displayName="ChonkyBoiiLoadedButton";const xa=({store:e})=>{const t=Na(),n=i.useOpenUrl(),[r,o]=y.useState(!1),l=y.useRef(null),{canUserUseTransfer:d,canContentUseTransfer:u,canUserEnableTransfer:g}=c.useStore(e.$props),_=y.useCallback((()=>{t.select(Ta).emit(null),n("/team/admin/settings/sharing")}),[t,n]),p=y.useCallback((()=>{t.select(La).emit(null),o(!0),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,t]),E=y.useCallback((()=>{const a=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;t.select(Ra).emit({dwellTime:a}),o(!1),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,t]);let b="";var h,M;return d?u||(b=(e=>e.formatMessage({id:"LvDT7L",defaultMessage:"This is not a file type that can be copied."}))(s.intl)):g?(h=s.intl,M=()=>{_()},b=h.formatMessage({id:"eGWSHS",defaultMessage:"Your team has transfer turned off. <button>Turn on</button>"},{button:e=>y.createElement(a.Button,{variant:"transparent",onClick:M},e)})):b=(e=>e.formatMessage({id:"l+F4Tm",defaultMessage:"Ask an admin to allow Transfer a copy."}))(s.intl),y.createElement(y.Fragment,null,y.createElement(m.ButtonWrapper,{"data-uxa-log":"sm24-transfer-button.disabled","data-uxa-interactions":"shown click",ref:l,onMouseEnter:p,onMouseLeave:E},y.createElement(m.VerticalButton,{disabled:!0},y.createElement(m.ButtonIconContainer,null,y.createElement(a.UIIcon,{src:f.DropboxTransferLine,size:"medium"})),y.createElement(m.Spacer,null),y.createElement(m.ButtonInnerColumn,null,y.createElement(m.ButtonTitle,{content:Ca(s.intl)})))),y.createElement(a.Tooltip.Control,{open:r,placement:"top",auto:!0,triggerRef:l,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1)},y.createElement(a.Text,null,b)))};xa.displayName="ChonkyBoiiDisabledButton";const Da=()=>y.createElement(m.ButtonWrapper,{"data-uxa-log":"sm24-transfer-button.loading","data-uxa-interactions":"shown click"},y.createElement(m.VerticalButton,{disabled:!0},y.createElement(m.ButtonIconContainer,null,y.createElement(a.UIIcon,{src:f.DropboxTransferLine,size:"medium"})),y.createElement(m.Spacer,null),y.createElement(m.ButtonInnerColumn,null,y.createElement(a.Skeleton.Text,{size:"small",style:{marginTop:22}}))));Da.displayName="LoadingButton";const Pa=({store:e})=>{const{canUserUseTransfer:t,canContentUseTransfer:a,isTransferEligibilityLoading:n}=c.useStore(e.$props);return n?y.createElement(Da,null):t&&a?y.createElement(wa,{store:e}):y.createElement(xa,{store:e})};Pa.displayName="Inner";const $a=e=>{const t=(e=>{const t=Tt(),a=c.useInitStore(t,(e=>e));return c.useInitStore(e,(e=>{const t=c.store(!1),n=c.store(0),r=c.store(0);return{$props:e,$data:a,$isHovered:t,$hoverStartTime:n,$componentViewTime:r}}))})(e);return y.createElement(Pa,{store:t})};$a.displayName="TransferButton";const Oa=({store:e})=>{const t=c.useStore(e.$objectIdentifier),a=y.useCallback((()=>{e.$props.get().transferHandler(),e.$props.get().onActionClicked()}),[e]),n=c.useStore(e.$canContentUseTransfer),r=c.useStore(e.$canUserUseTransfer),s=c.useStore(e.$canUserEnableTransfer),o=c.useStore(e.$isTransferEligibilityLoading);return y.createElement($a,{canContentUseTransfer:n,canUserUseTransfer:r,canUserEnableTransfer:s,isTransferEligibilityLoading:o,onClickTransferButton:a,objectIdentifier:t})};Oa.displayName="TransferButton";const Fa=(e,t)=>a.sharingCreateSharedLinkWithSettingsPackage.useQuery({apiArg:{path:i.getContentIdOrPathFromObjectIdentifier(e),settings:t}}),Ba=e=>{var t;const a=e.error,n=e.data;if(a&&"shared_link_already_exists"===(null===(t=a.appError)||void 0===t?void 0:t[".tag"])){const e=a.appError.shared_link_already_exists;return"metadata"===e[".tag"]?e.metadata:void 0}if(n)return n.apiData};var ja;!function(e){e.CREATING_LINK="CREATING_LINK",e.CREATED_LINK="CREATED_LINK",e.ERROR_CREATING_LINK="ERROR_CREATING_LINK",e.COPIED_LINK="COPIED_LINK",e.ERROR_COPYING_LINK="ERROR_COPYING_LINK",e.UPDATING_LINK="UPDATING_LINK",e.UPDATED_LINK="UPDATED_LINK",e.ERROR_UPDATING_LINK="ERROR_UPDATING_LINK",e.CAN_COPY_LINK="CAN_COPY_LINK"}(ja||(ja={}));const Ua={$props:c.atom({oid:{".tag":"file",fileId:""},sharingPrefsResult:{isLoading:!0},accountMetadataResult:{isLoading:!0},objectMetadataResult:{isLoading:!0},sharedLinkMetadataResult:{isLoading:!0},settingsHandler:()=>{},manageAccessHandler:()=>{},onRequestClose:()=>{}}),$currentAudience:c.atom(i.PUBLIC),$allowedAudiences:c.atom([]),$pendingAudience:c.atom(null),$accessLevel:c.atom(i.VIEWER$1),$pendingAccessLevel:c.atom(null),$isAudienceDowngrade:c.atom(!1),$isAdvancedSettingsRequired:c.atom(!1),$linkStatus:c.atom(ja.CREATING_LINK)},{StoreProvider:Va,useStore:Ha}=c.defineStoreProvider((e=>{const t=c.proxy((()=>{const t=e.get().sharingPrefsResult;return t.isLoading||t.isError?null:t.output})),a=c.proxy((()=>{const t=e.get().accountMetadataResult;return t.isLoading||t.isError?null:t.output})),n=c.proxy((()=>{const e=a.get(),n=t.get();e&&"personal"!==e.role&&e.is_team_member;return n?i.getUserDefaultCopyLinkAudienceLevel(n):i.PUBLIC})),r=c.atom(n.get()),s=c.atom([i.NO_ONE,i.TEAM,i.PUBLIC]),o=c.atom(null),l=c.atom(null),d=c.proxy((()=>{const e=t.get();return e?i.getUserDefaultCopyLinkAccessLevel(e):i.VIEWER$1})),u=c.atom(!1),m=c.atom(!1),g=c.atom(ja.CREATED_LINK);return{$props:e,$currentAudience:r,$allowedAudiences:s,$pendingAudience:o,$accessLevel:d,$pendingAccessLevel:l,$isAudienceDowngrade:u,$isAdvancedSettingsRequired:m,$linkStatus:g}}),Ua),qa=e=>{const t=i.useSharingAccountInfo(),n=i.useSharingPrefs(),r=a.useSharingObjectMetadata(e.oid),s=((e,t)=>{const a=Fa(e,t);return y.useMemo((()=>{var e;if(!a)return{isLoading:!0};if(a.isLoading)return{isLoading:!0};if(a.error){const e=Ba(a);return e?{isError:!1,isLoading:!1,output:e}:{isLoading:!1,isError:!0,error:a.error.appError}}return{isLoading:!1,isError:!1,output:null===(e=a.data)||void 0===e?void 0:e.apiData}}),[a])})(e.oid,{access:i.DEFAULT});return y.createElement(Va,{accountMetadataResult:t,sharingPrefsResult:n,objectMetadataResult:r,sharedLinkMetadataResult:s,...e})};qa.displayName="Provider";const Wa=({})=>{const e=Ha(),t=c.useAtom(e.$currentAudience),n=c.useAtom(e.$accessLevel);return y.createElement(a.Text,{style:{display:"flex",alignItems:"flex-start",color:"var(--dig-color__text__base)"},size:"small"},s.intl.formatMessage({id:"Anw/Zh",defaultMessage:"{noAudience, select, true {can edit} other {with this link can {canEdit, select, true {edit} other {view}}}}"},{noAudience:"no_one"===t[".tag"],canEdit:"editor"===n[".tag"]}))};Wa.displayName="AccessLevel";const za=(e,t)=>{switch(t[".tag"]){case"public":return{title:e.formatMessage({id:"cryQmP",defaultMessage:"Anyone"}),subtitle:e.formatMessage({id:"W43EHG",defaultMessage:"Anyone with this link can access"})};case"team":return{title:e.formatMessage({id:"Xdvlat",defaultMessage:"Team members"}),subtitle:e.formatMessage({id:"ICYuX7",defaultMessage:"Team members with this link can access"})};case"password":return{title:e.formatMessage({id:"S3o4my",defaultMessage:"Password protected"}),subtitle:e.formatMessage({id:"sGqBO7",defaultMessage:"People with the password"})};case"no_one":return{title:e.formatMessage({id:"uAvRTc",defaultMessage:"Only people invited"}),subtitle:e.formatMessage({id:"UvwRPT",defaultMessage:"This link is off and does not grant additional access to anyone"})};default:return{title:"",subtitle:""}}},Ga=e=>e.formatMessage({id:"IsEYXV",defaultMessage:"Who can access"});a.injectInternalStyle("/static/metaserver/static/js/sharing/sharing-sdk/legos/copy-link-screen/internals/link-audience-dropdown.module.out-vflXLTjjq.css",(e=>"._container_jmjbi_1,._textContainer_jmjbi_6{align-items:center;display:flex}._menuWrapper_jmjbi_11{padding:8px 0;white-space:nowrap}._menuContent_jmjbi_16{max-width:300px;min-width:300px}._menuRowContent_jmjbi_21{margin:0;padding:7px 0 7px 8px!important}._menuSelectItem_jmjbi_26{padding:0 16px}._menuSubtitle_jmjbi_30{word-wrap:break-word;overflow-wrap:break-word;white-space:normal}._leftRowAccessory_jmjbi_36{margin:0}._rightRowAccessory_jmjbi_40{margin:0!important;padding-left:8px}._button_jmjbi_45{font-family:var(--type__body__standard--fontfamily);font-size:var(--type__body__standard--fontsize);font-weight:var(--type__body__standard--fontweight);letter-spacing:0}"));const Za="_container_jmjbi_1",Qa="_textContainer_jmjbi_6",Ya="_menuContent_jmjbi_16",Ka="_menuRowContent_jmjbi_21",Ja="_menuSelectItem_jmjbi_26",Xa="_menuSubtitle_jmjbi_30",en="_leftRowAccessory_jmjbi_36",tn="_rightRowAccessory_jmjbi_40",an="_button_jmjbi_45",nn=({})=>{const e=s.useIntl(),t=Ha(),n=c.useAtom(t.$currentAudience),r=c.useAtom(t.$allowedAudiences),o=c.useAtom(t.$pendingAudience),i=c.useAtom(t.$pendingAccessLevel),l=c.useAtom(t.$linkStatus);let d=!1;const u=y.useMemo((()=>null!==o||null!==i||l===ja.UPDATING_LINK),[o,i,l]),m=y.useCallback((async e=>{t.$currentAudience.set(e)}),[t]),g=y.useCallback((e=>{e!==n&&(m(e),d=!0)}),[n,m]),_=r.length,p=0===r.length||1===r.length&&r[0][".tag"]===n[".tag"];return y.createElement("div",{className:Za,"data-testid":"link-audience-dropdown"},p?y.createElement(a.Text,{color:u?"disabled":"standard",className:Qa},y.createElement(rn,{audience:n}),za(e,n).title):y.createElement(a.Menu.Wrapper,{onSelection:g,isPortaled:!1,"data-testid":"link-audience-dropdown-menu","data-uxa-log":"copy-link-screen-link-audience-dropdown.opened","data-uxa-interactions":"click"},(({getContentProps:t,getTriggerProps:s})=>y.createElement(y.Fragment,null,y.createElement(a.Button,{...s(),variant:"outline",tone:"neutral",size:"small",withDropdownIcon:_>1,"data-testid":"link-audience-dropdown-button",disabled:u,className:an,withIconStart:y.createElement(rn,{audience:n})},za(e,n).title),y.createElement(a.Menu.Content,{"data-sharing-sdk":"1",...t(),placement:"bottom-start",className:Ya},y.createElement(a.Menu.Segment,{withLabel:Ga(e)},r.map((t=>y.createElement(a.Menu.SelectItem,{"data-uxa-log":d?"copy-link-screen-link-audience-dropdown.selected":null,"data-uxa-interactions":d?"click":"noop",key:t[".tag"],value:t,"data-testid":`link-audience-dropdown-${t[".tag"]}-item`,selected:t[".tag"]===n[".tag"],preferComposition:!0,className:Ja},y.createElement(a.Menu.RowAccessory,{className:en},t[".tag"]===n[".tag"]?y.createElement(a.UIIcon,{src:a.CheckmarkLine,role:"presentation"}):null),y.createElement(a.Menu.RowContent,{className:Ka},y.createElement(a.Menu.RowTitle,null,za(e,t).title),y.createElement(a.Menu.RowSubtitle,{className:Xa},za(e,t).subtitle)),y.createElement(a.Menu.RowAccessory,{className:tn},y.createElement(rn,{audience:t})))))))))))};nn.displayName="LinkAudienceDropdown";const rn=({audience:e})=>{const t=y.useMemo((()=>"public"===e[".tag"]?a.GlobeLine:"team"===e[".tag"]?d.TeamLine:"no_one"===e[".tag"]?E.LockLine:"password"===e[".tag"]?f.PasswordsLine:null),[e]);return null===t?null:y.createElement(a.UIIcon,{src:t,size:"medium","data-testid":"link-audience-dropdown-icon",role:"presentation"})};rn.displayName="AudienceIcon";const sn=()=>y.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"var(--dig-spacing__micro__small)",height:"122px"},"data-uxa-log":"sm24-copy_link_screen.loading","data-uxa-interactions":"shown"},y.createElement(a.Spinner,{size:"medium",withTrack:!0,hasOpaqueTrack:!0}),y.createElement(a.Text,{size:"small",color:"subtle"},s.intl.formatMessage({id:"XtsMXq",defaultMessage:"Getting the link"})));sn.displayName="LoadingScreen";const on=()=>{const e=Ha(),t=c.useStore(e.$props),n=y.useCallback((()=>{t.onRequestClose()}),[t]);return y.createElement("div",{className:i.classes.headerSectionButtonContainer},y.createElement(a.IconButton,{variant:"borderless",shape:"standard",size:"medium",tone:"neutral",onClick:n},y.createElement(a.UIIcon,{src:a.CloseLine})))};on.displayName="CloseButton";const ln=()=>{const e=Ha(),t=c.useStore(e.$props),{objectMetadataResult:n,accountMetadataResult:r,sharingPrefsResult:o}=t,l=!n.isLoading&&n.isError,d=!r.isLoading&&r.isError,u=!o.isLoading&&o.isError,m=!l&&!d&&!u,g=n.isLoading||n.isError?"":a.getName(n.output);return y.createElement("div",{style:{display:"flex",alignItems:"flex-start"}},m&&y.createElement("div",{className:i.classes.headerSectionTextContainer},y.createElement(a.Text,{size:"medium",isBold:!0,className:i.classes.headerSectionPrimaryText},y.createElement(a.Truncate,{location:.5},s.intl.formatMessage({id:"K4WVkI",defaultMessage:"Link copied to"}))),y.createElement(a.Text,{size:"small",color:"subtle"},y.createElement(a.Truncate,{location:.5},g))),y.createElement(on,null))};ln.displayName="HeaderSection";a.injectInternalStyle("/static/metaserver/static/js/sharing/sharing-sdk/legos/copy-link-screen/internals/link-section.module.out-vflJgUUnr.css",(e=>"._badgeAsText_gpgfl_1{text-wrap:nowrap;align-items:center;border-radius:var(--dig-radius__small);display:flex;font-family:var(--dig-type__family__action);font-size:var(--dig-type__size__action__small);font-weight:500;letter-spacing:var(--dig-type__letterspacing__action);margin-right:calc(var(--dig-spacing__micro__xsmall)*-1);padding-left:var(--dig-spacing__micro__small);padding-right:var(--dig-spacing__micro__small);white-space:nowrap;width:fit-content}._badgeAsTextSuccess_gpgfl_20{background-color:var(--dig-color__success__surface--state-1);color:var(--dig-color__success__base)}._badgeAsTextUpdate_gpgfl_26{background-color:var(--dig-color__selection__surface--state-1);color:var(--dig-color__selection__base)}._badgeIcon_gpgfl_32{padding-right:var(--dig-spacing__micro__xsmall)}._badgeAsButton_gpgfl_36{margin-right:calc(var(--dig-spacing__micro__xsmall)*-1)}._updatingContainer_gpgfl_40{position:relative}._updatingOverlay_gpgfl_45{opacity:0;pointer-events:none;position:absolute;right:12px;top:50%;transform:translateY(-50%);transition:opacity .2s ease;z-index:1}._updatingContainer_gpgfl_40:has(input:disabled){pointer-events:none}._updatingContainer_gpgfl_40:has(input:disabled) ._updatingOverlay_gpgfl_45{opacity:1}"));const cn="_badgeAsTextSuccess_gpgfl_20 _badgeAsText_gpgfl_1",dn="_badgeAsTextUpdate_gpgfl_26 _badgeAsText_gpgfl_1",un="_badgeIcon_gpgfl_32",mn="_badgeAsButton_gpgfl_36",gn="_updatingContainer_gpgfl_40",_n="_updatingOverlay_gpgfl_45",pn=()=>{const e=Ha(),[t,n]=y.useState(!1),r=y.useCallback((()=>{}),[]),o=c.useAtom(e.$isAdvancedSettingsRequired),l=y.useMemo((()=>!o),[o]),d=c.useAtom(e.$accessLevel),u=c.useAtom(e.$linkStatus);return y.createElement("div",null,l?y.createElement("div",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},y.createElement("div",{className:u===ja.UPDATING_LINK?gn:""},y.createElement(a.TextInput,{size:"large",readOnly:!0,wrapperProps:{style:{backgroundColor:"var(--dig-color__background__base)"}},value:"https:/www.dropbox.com/scl/fi/fs8348493",withRightAccessory:(e=>{switch(u){case ja.COPIED_LINK:return y.createElement(a.Text,{className:cn},d===i.EDITOR$1?s.intl.formatMessage({id:"qaLT/q",defaultMessage:"Edit link copied"}):(e=>e.formatMessage({id:"Ged5jl",defaultMessage:"View link copied"}))(s.intl));case ja.UPDATED_LINK:return y.createElement(a.Text,{className:dn},d===i.EDITOR$1?(e=>e.formatMessage({id:"vxhXNy",defaultMessage:"Edit link updated"}))(s.intl):(e=>e.formatMessage({id:"7WIftp",defaultMessage:"View link updated"}))(s.intl));case ja.CAN_COPY_LINK:return e&&y.createElement(a.Button,{variant:"primary",size:"small",onClick:r,className:mn},(e=>e.formatMessage({id:"1xxmJZ",defaultMessage:"Copy link"}))(s.intl));default:return null}})(t),disabled:u===ja.UPDATING_LINK}),y.createElement("div",{className:_n},y.createElement(a.Text,{className:dn},y.createElement(a.UIIcon,{src:b.SyncingLine,className:un,size:"small"}),s.intl.formatMessage({id:"JSbtot",defaultMessage:"Updating link"}))))):null)};pn.displayName="LinkSection";const fn=()=>{const e=Ha(),t=c.useAtom(e.$accessLevel);return y.createElement(a.IconButton,{variant:"filled",shape:"standard",size:"small",tone:"neutral",onClick:()=>{let a;a="editor"===t[".tag"]?"edit_link_settings":"view_link_settings";e.$props.get().settingsHandler({initialTab:a})},"data-uxa-log":"copy-link-screen-settings-button.loaded","data-uxa-interactions":"shown click"},y.createElement(a.UIIcon,{"aria-label":"Settings",src:_.SettingsLine}))};fn.displayName="SettingsButton";const En=()=>{const e=Ha(),t=c.useStore(e.$props),n=c.useAtom(e.$isAudienceDowngrade),r=c.useAtom(e.$isAdvancedSettingsRequired),o=y.useMemo((()=>n&&!r),[n,r]),i=y.useMemo((()=>r),[r]),l=c.useAtom(e.$accessLevel);return y.createElement(y.Fragment,null,y.createElement("div",null,o?y.createElement(a.Banner,{withLeftIcon:y.createElement(a.UIIcon,{src:a.InfoLine}),withCloseButton:"Close",type:"attention",variant:"basic"},y.createElement(a.Banner.Message,null,s.intl.formatMessage({id:"tpf5uf",defaultMessage:"People who have used this link might still have access"})),y.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"left"}},y.createElement(a.Banner.Actions,null,y.createElement(a.Button,{variant:"transparent",size:"medium",tone:"neutral",onClick:()=>{t.manageAccessHandler()}},(e=>e.formatMessage({id:"Gas2Hs",defaultMessage:"Who has access"}))(s.intl))))):null),y.createElement("div",null,i?y.createElement(a.Banner,{withLeftIcon:y.createElement(a.UIIcon,{src:a.InfoLine}),type:"attention",variant:"basic"},y.createElement(a.Banner.Message,null,(e=>e.formatMessage({id:"3QuI0e",defaultMessage:"Your admin requires to set a password for links shared outside the team."}))(s.intl)),y.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"left"}},y.createElement(a.Banner.Actions,null,y.createElement(a.Button,{variant:"transparent",size:"medium",tone:"neutral",onClick:()=>{let t;t="editor"===l[".tag"]?"edit_link_settings":"view_link_settings";e.$props.get().settingsHandler({initialTab:t})}},(e=>e.formatMessage({id:"2rr8SQ",defaultMessage:"Set password"}))(s.intl))))):null))};En.displayName="EdgeCaseBanners";const bn=()=>y.createElement("div",{style:{display:"flex",padding:"var(--dig-spacing__micro__medium)",flexDirection:"column",alignItems:"center",gap:"var(--dig-spacing__micro__small)"}},y.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"var(--dig-spacing__micro__xsmall)"}},y.createElement(a.UIIcon,{src:a.FailLine,size:"large"})),y.createElement(a.Text,{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"var(--dig-spacing__micro__xsmall)",alignSelf:"stretch",fontStyle:"normal",fontWeight:"var(--dig-type__weight__strong)",lineHeight:"var(--dig-line-height__label__small)",letterSpacing:"var(--dig-letter-spacing__action__medium)"}},s.intl.formatMessage({id:"qmGnVg",defaultMessage:"Couldn’t copy link"})),y.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}},y.createElement(a.Text,{style:{display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",color:"var(--dig-color__text__subtle)",textOverflow:"ellipsis",fontFamily:"var(--dig-font-family__text)",fontSize:"var(--dig-font-size__text__small)",fontStyle:"normal",fontWeight:"var(--dig-type__weight__base)",lineHeight:"var(--dig-line-height__label__small)",gap:"var(--dig-spacing__micro__xsmall)"}},(e=>e.formatMessage({id:"hkT9RW",defaultMessage:"Try reloading the page or asking us for"}))(s.intl),y.createElement(a.Link,{href:"https://www.dropbox.com/get_help",style:{display:"flex",justifyContent:"center",alignItems:"center",fontFamily:"var(--dig-font-family__text)",fontSize:"var(--dig-font-size__text__small)",fontStyle:"normal",fontWeight:"var(--dig-type__weight__base)",lineHeight:"var(--dig-line-height__label__small)",textDecorationLine:"underline",textDecorationStyle:"solid",color:"var(--dig-color__primary__base)"}},(e=>e.formatMessage({id:"yvCTUR",defaultMessage:"help"}))(s.intl)))));bn.displayName="ErrorScreen";const hn=e=>y.createElement(qa,{...e},y.createElement(Mn,null));hn.displayName="CopyLinkScreen";const Mn=()=>{const e=Ha(),t=c.useAtom(e.$props),{accountMetadataResult:a,objectMetadataResult:n,sharingPrefsResult:r,sharedLinkMetadataResult:s}=t,o=n.isLoading,i=!n.isLoading&&!n.isError,l=!n.isLoading&&n.isError,d=a.isLoading,u=!a.isLoading&&!a.isError,m=!a.isLoading&&a.isError,g=r.isLoading,_=!r.isLoading&&!r.isError,p=!r.isLoading&&r.isError,f=s.isLoading,E=!s.isLoading&&!s.isError,b=!s.isLoading&&s.isError,h=c.useAtom(e.$linkStatus),M=l||m||p||b||h===ja.ERROR_CREATING_LINK||h===ja.ERROR_UPDATING_LINK,S=i&&u&&_&&E;return o||d||g||f?y.createElement(sn,null):M?y.createElement(y.Fragment,null,y.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},y.createElement(bn,null))):S?y.createElement("div",{"data-testid":"copy-link-screen-with-store","data-uxa-log":"sm24-copy_link_screen.loaded","data-uxa-interactions":"shown",style:{display:"flex",flexDirection:"column",gap:"var(--dig-spacing__micro__small)"}},y.createElement(ln,null),y.createElement("div",null,y.createElement("div",{style:{display:"flex",alignItems:"flex-start",alignSelf:"stretch"}},y.createElement(En,null)),y.createElement(pn,null),y.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"var(--dig-spacing__micro__small)"}},y.createElement("div",{style:{display:"flex",alignItems:"center",gap:"var(--dig-spacing__micro__xsmall)"}},y.createElement(nn,null),y.createElement(Wa,null)),y.createElement(fn,null)))):null};Mn.displayName="CopyLinkScreenWithStore";const Sn=({store:e})=>{const t=c.useStore(e.$props),{objectIdentifier:a,settingsHandler:n,manageAccessHandler:r,onRequestClose:s}=t;return y.createElement(hn,{oid:a,settingsHandler:n,manageAccessHandler:r,onRequestClose:s})};Sn.displayName="CopyLinkScreen";const vn=e=>e.formatMessage({id:"yBYjtJ",defaultMessage:"Close"}),yn=Symbol("ON_CLICK"),An=Symbol("ON_MOUSE_ENTER"),Cn=Symbol("ON_MOUSE_LEAVE"),{useEmitter:In,defaultEmitter:Tn}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(i.Context$2),r=t(i.Context$3),s=t(i.Context),o={...i.getTags(n),...i.getTags$1(r),...i.getTags$2(s)},l={...i.getProperties(n),...i.getProperties$1(r),...i.getProperties$2(s)};if(e.key===yn)return a.UDCL.logEvent(i.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"close",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...o,action:"close"}}),void a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"close",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...o,action:"close"}});e.key!==An?e.key!==Cn||a.UDCL.logEvent(V({...l,flexibleSharingEntryPointAction:"close",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...o,action:"close"}}):a.UDCL.logEvent(U({...l,flexibleSharingEntryPointAction:"close"}),{tags:{...o,action:"close"}})})),Ln=({store:e})=>{const[t,n]=y.useState(!1),r=y.useRef(null),o=In(),i=y.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0,a=Date.now()-e.$componentViewTime.get();o.select(yn).emit({dwellTime:t,timeSinceView:a}),e.$isHovered.set(!1),e.$props.get().onClickCloseButton()}),[e,o]),l=y.useCallback((()=>{o.select(An).emit(null),n(!0),e.$isHovered.set(!0),e.$hoverStartTime.set(Date.now())}),[e,o]),d=y.useCallback((()=>{const t=e.$isHovered.get()?Date.now()-e.$hoverStartTime.get():void 0;o.select(Cn).emit({dwellTime:t}),n(!1),e.$isHovered.set(!1),e.$hoverStartTime.set(0)}),[e,o]);y.useEffect((()=>{e.$componentViewTime.set(Date.now())}),[e]);const u=c.useStore(e.$disabled);return y.createElement(y.Fragment,null,y.createElement(m.HeaderIconButton,{"data-testid":"close-button",onClick:i,onMouseEnter:l,onMouseLeave:d,ref:r,variant:e.$props.get().buttonVariant,disabled:u,"data-uxa-log":"sm24-close-button","data-uxa-interactions":"click"},y.createElement(a.UIIcon,{src:a.CloseLine,"aria-label":vn(s.intl)})),y.createElement(a.Tooltip.Control,{open:!u&&t,placement:"top",auto:!0,triggerRef:r,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)},y.createElement(a.Text,null,vn(s.intl))))};Ln.displayName="LoadedButton";const Rn=({store:e})=>y.createElement(Ln,{store:e});Rn.displayName="Inner";const Nn=e=>{const t=(e=>{const t=Tt(),a=c.useInitStore(t,(e=>e));return c.useInitStore(e,(e=>{const t=c.store(!1),n=c.store(0),r=c.store(0),s=c.proxy((()=>{var t;return null!==(t=e.get().disabled)&&void 0!==t&&t}));return{$props:e,$data:a,$isHovered:t,$hoverStartTime:n,$componentViewTime:r,$disabled:s}}))})(e);return y.createElement(Rn,{store:t})};Nn.displayName="CloseButton";const kn=({store:e,buttonVariant:t})=>{const a=c.useStore(e.$isClickawayLocked),n=y.useCallback((()=>{e.$props.get().onRequestClose()}),[e]);return y.createElement(Nn,{onClickCloseButton:n,buttonVariant:t,disabled:a})};function wn(e){return{class:"share",action:"view",object:"manage_access",properties:e}}kn.displayName="CloseButton";const xn=Symbol("ON_CLICK_OUTSIDE"),Dn=Symbol("ON_RESIZE"),Pn=Symbol("ON_OPEN"),$n=Symbol("ON_VIEW_MANAGE_ACCESS_ENTRY_POINT_BUTTON"),{useEmitter:On,defaultEmitter:Fn}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(i.Context$2),r=t(i.Context$3),s=t(i.Context),o={...i.getTags(n),...i.getTags$1(r),...i.getTags$2(s)},l={...i.getProperties(n),...i.getProperties$1(r),...i.getProperties$2(s)};e.key!==Pn?e.key!==xn&&e.key!==Dn?e.key!==$n||a.UDCL.logEvent(wn({...l,manageAccessElement:"manage_access_entry_point_button"}),{tags:{...o,element:"manage_access_entry_point_button"}}):a.UDCL.logEvent(i.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:e.payload.action,flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView||void 0}),{tags:{...o,action:e.payload.action}}):a.UDCL.logEvent(function(e){return{class:"sharing_sender",action:"view",object:"flexible_sharing_entrypoint",properties:e}}({...l}),{tags:o})})),Bn=({store:e})=>{const t=e.$props.get().objectIdentifier,a=Tt(),n=On(),r="loaded"===a.status?a.objectIdentifier:t,s=y.useCallback((()=>{c.batch((()=>{e.$currentScreen.set(qt.MANAGE_ACCESS),e.$isSuggestionsOpen.set(!1)}))}),[e]),o=y.useCallback((()=>{n.select($n).emit(null)}),[n]);return r?y.createElement("div",null,y.createElement(Je,{oid:r,onClick:s,onView:o})):null};Bn.displayName="ManageAccessFacepileButton";const jn=e=>e.formatMessage({id:"4mDOPx",defaultMessage:"Folder"}),Un=(e,t)=>e.formatMessage({id:"Y8cvK0",defaultMessage:"Share {contentName}"},{contentName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.FILENAME)}),Vn=e=>e.formatMessage({id:"EbXgYu",defaultMessage:"Create QR code"}),Hn=e=>e.formatMessage({id:"Qn7mSN",defaultMessage:"People with access to"}),qn=e=>e.formatMessage({id:"FQ6/b6",defaultMessage:"Link copied to"}),Wn=({store:e})=>{const t=c.useStore(e.$currentScreen),n=c.useStore(e.$props),r=t===qt.INBAND,o=t===qt.MANAGE_ACCESS,l=t===qt.COPY_LINK,{firstLine:d,secondLine:u}=y.useMemo((()=>{const e=a.getFilename(n.fileOrFolder);switch(t){case qt.INBAND:return{firstLine:(r=s.intl,r.formatMessage({id:"DOMI0b",defaultMessage:"Add people to"})),secondLine:e};case qt.QRCODE:return{firstLine:Vn(s.intl),secondLine:e};case qt.MANAGE_ACCESS:return{firstLine:Hn(s.intl),secondLine:e};case qt.COPY_LINK:return{firstLine:qn(s.intl),secondLine:e};case qt.MAIN:default:return{firstLine:Un(s.intl,e),secondLine:n.fileOrFolder.is_dir?jn(s.intl):a.formatBytes(s.intl,n.fileOrFolder.bytes,2,!1)}}var r}),[t,n.fileOrFolder]),m=y.useCallback((()=>{e.$currentScreen.set(qt.INBAND)}),[e]),g=r?220:void 0;return l?null:y.createElement(y.Fragment,null,o&&y.createElement("div",{className:i.classes.headerSectionBackButton},y.createElement(a.IconButton,{onClick:m,variant:"borderless",shape:"standard",size:"medium",tone:"neutral","data-uxa-log":"sm24_back_button"},y.createElement(a.UIIcon,{src:a.ArrowLeftLine}))),y.createElement("div",{className:i.classes.headerSectionTextContainer},y.createElement(a.Text,{size:"medium",isBold:!0,className:i.classes.headerSectionPrimaryText},y.createElement(a.Truncate,{location:.5},d)),y.createElement(a.Text,{size:"small",color:"subtle"},y.createElement(a.Truncate,{maxWidth:g,location:.5},u))),y.createElement("div",{className:i.classes.headerSectionRightContainer},r&&y.createElement(Bn,{store:e}),y.createElement("div",{className:i.classes.headerSectionButtonContainer},y.createElement(kn,{store:e,buttonVariant:"borderless"}))))};Wn.displayName="HeaderSection";const zn=({store:e})=>{const t=c.useStore(e.$props),n=Tt(),{objectIdentifier:r}=t,s=c.useStore(e.$inviteTargets),o=c.useStore(e.$inviteMessage),l=y.useCallback((t=>{e.$inviteMessage.set(t)}),[e]),d=y.useCallback((t=>{e.$inviteTargets.set(t)}),[e]),u=y.useCallback((()=>{e.$isClickawayLocked.set(!0)}),[e]),m=y.useCallback((()=>{e.$isClickawayLocked.set(!1)}),[e]),g=y.useCallback((()=>{e.$isClickawayLocked.set(!1),e.$props.get().onInbandShareCompleted(),a.invalidateObjectMembers(r),a.invalidateSharingObjectMetadata(r)}),[e,r]),_=y.useCallback((()=>{e.$isInbandStarted.set(!0)}),[e]),p=y.useCallback((t=>{e.$isSuggestionsOpen.set(t)}),[e]),f=y.useCallback((async()=>{"loaded"===n.status&&await n.refreshObjectMetadata()}),[n]),E=y.useCallback((async()=>{"loaded"===n.status&&await n.refreshModal()}),[n]);return y.createElement(i.Inband,{oid:t.objectIdentifier,inviteMessage:o,inviteTargets:s,hasUpdatedAccountMetadata:!1,onCloseClick:()=>t.onRequestClose(),onTargetsDropdownFocusChange:p,onInviteMessageChange:l,onInviteTargetsChange:d,onShareStart:u,onShareFailure:m,onInbandShareSuccess:g,onStartInband:_,onRefreshObjectMetadata:f,onRefreshModal:E})};zn.displayName="InbandShareScreen";const Gn=({children:e})=>{const t=Tt();return y.createElement(a.ContextProvider,{context:i.Context,value:"loaded"===t.status?t.objectMetadata:null},y.createElement(i.MetadataProvider,{sharingObjectMetadata:"loaded"===t.status?t.objectMetadata:void 0,sharingPrefs:"loaded"===t.status?t.sharingPrefs:void 0,sharingObjectIdentifier:"loaded"===t.status?t.objectIdentifier:void 0,shareMe24Metadata:{isShareMe24:!0}},e))};Gn.displayName="LoggingMetadataProvider";const Zn=["altText","inverse"];var Qn=e=>{let{altText:t,inverse:n}=e,r=h._objectWithoutProperties(e,Zn);const{getInverseProps:s}=a.useTheme(),{className:o}=s(),i="dig-Illustration dig-13or4mr1_4-5-0 dig-Illustration-spot"+(n?o+" dig-Illustration--inverse":"");return y.createElement("svg",h._objectSpread2(h._objectSpread2({role:"presentation"},r),{},{className:i,viewBox:"0 0 500 500",fill:"none",xmlns:"http://www.w3.org/2000/svg"}),y.createElement("title",null,t),y.createElement("g",{fillRule:"evenodd",clipRule:"evenodd"},y.createElement("path",{d:"M136.608 219.783c-.342.342-9.166.718-21.52.916-7.467.12-15.13.436-17.029.703-3.389.477-9.153 2.017-17.153 4.585-6.83 2.192-12.763 6.926-12.763 10.183 0 1.285.948 2.347 1.922 2.153.335-.068 1.23.205 1.99.604.76.398 4.653 1.698 8.653 2.888 4 1.189 7.935 2.426 8.745 2.748.81.322 3.957.95 6.995 1.396 3.038.447 6.766 1.109 8.285 1.472 1.519.363 6.179.859 10.355 1.102 4.177.243 11.323.694 15.879 1.001 4.557.307 13.877.571 20.712.585 8.356.017 13.439.225 15.519.636 3.939.776 5.306.256 6.821-2.6 1.333-2.514 2.347-3.199 6.052-4.092 3.643-.877 11.22-.573 18.783.754 2.912.511 6.743.935 8.515.941 3.191.012 4.857.217 12.887 1.585 2.278.388 7.456 1.117 11.507 1.621 10.391 1.293 17.48 3.696 23.671 8.026 2.213 1.547 4.645 2.044 10.21 2.082 2.18.015 5.079.239 6.443.498 1.363.258 8.044.572 14.844.696 6.801.124 12.567.351 12.814.503.247.153 5.245.251 11.108.218 7.33-.041 12.921.188 17.904.731 6.665.728 7.291.732 7.824.048.495-.635 1.152-.691 4.488-.383 7.189.664 11.632-.544 23.937-6.505 6.357-3.08 6.87-3.434 10.816-7.446 6.363-6.469 6.816-7.896 3.777-11.88-2.419-3.171-5.583-5.312-8.328-5.636-5.711-.673-60.96-3.99-80.826-4.853-12.024-.522-24.348-1.154-27.385-1.404-3.038-.251-9.05-.661-13.36-.913-4.309-.25-8.81-.59-10.001-.753-2.464-.337-2.424-.387-2.867 3.573-.354 3.163-2.526 7.021-4.839 8.594-1.379.938-2.011 1.065-4.386.882-3.063-.236-6.457-1.712-6.84-2.975-.136-.447-.29-2.946-.343-5.552-.052-2.607-.258-4.839-.456-4.962-.352-.218-14.986-.809-35.019-1.415l-9.993-.302.242 1.567c.133.861-.049 2.39-.405 3.397-.614 1.734-.791 1.862-3.366 2.419-2.754.595-6.588.424-8.051-.358-1.155-.618-2.849-3.547-3.16-5.464l-.269-1.649-11.603-.049c-6.381-.027-11.662.011-11.736.084Z",fill:"#14C8EB"}),y.createElement("path",{d:"M220.118 164.552c-1.416 1.416-.008 5.05 2.264 5.842 3.399 1.185 5.468.37 5.468-2.153 0-2.364-2.291-4.241-5.176-4.241-1.102 0-2.252.249-2.556.552Zm4.555.86c2.176 1.55 1.652 4.571-.793 4.571-1.146 0-2.933-1.981-2.933-3.25 0-.898 1.16-2.273 1.917-2.273.26 0 1.073.429 1.809.952Zm-15.348 2.998c-2.979 1.606-.271 4.964 3.809 4.723 2.868-.169 5.32 2.581 7.969 8.937.709 1.702.706 1.722-.225 1.224-.52-.279-1.702-.567-2.625-.642a37.632 37.632 0 0 1-3.431-.475c-1.47-.285-1.932-.17-2.876.718-1.563 1.468-1.425 2.99.44 4.854 1.799 1.799 2.38 1.89 3.914.613.849-.707 1.117-1.402 1.151-2.977.05-2.325.538-2.534 3.264-1.394 1.124.469 1.655 1.034 1.842 1.956.145.713.463 1.932.707 2.709.626 1.993.553 3.217-.233 3.869-.52.431-.707 1.959-.806 6.561l-.128 5.998-4.279 1.078c-3.882.978-4.608 1.345-7.825 3.954-1.949 1.58-3.782 3.191-4.072 3.578a40.945 40.945 0 0 1-1.507 1.822c-.991 1.133-1.06 1.916-.193 2.205.261.087 2.219-1.671 4.351-3.906 4.932-5.172 6.062-5.986 9.409-6.786 4.149-.99 4.369-.947 4.063.81-.144.823-.707 2.842-1.252 4.488-.857 2.588-.991 4.044-.993 10.816-.003 7.392.055 7.904 1.039 9.284 1.448 2.031 4.462 3.114 7.726 2.777 3.431-.354 5.138-1.466 6.672-4.344 1.703-3.199 1.934-4.452 1.886-10.263-.045-5.46-.716-7.418-4.039-11.769-1.241-1.627-1.683-2.704-1.844-4.498-.867-9.639-1.045-10.639-2.041-11.449-.544-.443-1.484-.806-2.089-.806-.965 0-1.099-.211-1.093-1.726.008-1.971 1.062-6.75 1.89-8.567.492-1.08.743-1.191 2.111-.934 2.852.535 4.598-2.579 2.333-4.165-1.554-1.089-2.493-.872-3.833.884-1.233 1.617-3.393 7.783-3.47 9.906-.035.98-.108.917-.494-.427-.249-.867-.593-4.785-.764-8.707-.221-5.066-.478-7.186-.886-7.321-.437-.145-.577 1.013-.58 4.795l-.004 4.986-1.372-2.391c-1.218-2.124-4.999-5.663-6.05-5.663-.217 0-.394-.586-.394-1.301 0-1.379-1.411-3.009-2.992-3.456-.506-.144-1.489.046-2.186.422Zm3.346 1.131c.276.515.369 1.355.207 1.867-.455 1.436-3.15 1.053-3.366-.478-.283-2.003 2.238-3.111 3.159-1.389Zm19.443 7.621c.46.46-.135 1.469-1.324 2.248-1.627 1.067-2.215.425-1.076-1.174.913-1.283 1.797-1.678 2.4-1.074Zm-16.235 6.393c.601.724.305 2.771-.549 3.8-.676.816-2.516.719-2.849-.15-.497-1.296-.299-2.299.659-3.327 1.097-1.177 1.947-1.278 2.739-.323Zm11.051 11.044 2.071.313.103 5.796.103 5.795 2.236 3.257c3.443 5.016 3.928 6.685 3.683 12.659-.189 4.568-.351 5.326-1.711 8.006-.834 1.643-2.008 3.231-2.637 3.568-2.686 1.437-6.559.071-8.074-2.849-.723-1.395-.874-2.811-.933-8.745-.062-6.189.053-7.418.91-9.759 1.15-3.142 1.831-13.434 1.125-16.98-.385-1.929-.351-2.125.31-1.772.409.219 1.675.539 2.814.711Zm5.983 10.339c0 .267.155.506.345.531 1.226.166 4.492.347 10.931.607 8.407.339 12.441.859 17.03 2.195 5.885 1.714 9.435 4.137 9.435 6.442 0 .485.282 1.44.625 2.124.345.684.761 2.267.925 3.519.281 2.145.965 3.223 1.742 2.743.399-.247.081-4.095-.586-7.09-1.054-4.73-6.5-8.094-16.336-10.093-5.298-1.077-24.111-1.84-24.111-.978Zm-70.375 2.927c-3.543 1.241-4.12 4.647-2.533 14.933.248 1.611 2.013 3.585 3.87 4.329 1.702.681 9.003.014 10.137-.927.783-.65.93-1.435 1.047-5.589.184-6.458-.328-9.563-1.835-11.136-1.902-1.986-7.295-2.798-10.686-1.61Zm6.766.313c1.022.004 1.915.405 2.738 1.228l1.222 1.221-1.127.433c-2.016.775-11.023-.419-11.023-1.461 0-.792 4.041-1.915 5.753-1.598.506.094 1.603.174 2.437.177Zm136.099 2.049c-3.668.451-5.489.965-8.972 2.534-5.127 2.309-6.987 3.685-9.657 7.145-1.628 2.11-1.866 2.665-1.392 3.237.315.379.747.69.961.69.213 0 1.862-1.536 3.663-3.412 2.474-2.576 4.124-3.825 6.739-5.1 5.876-2.866 6.506-2.996 14.354-2.974 9.574.027 31.69 1.174 33.426 1.734 5.941 1.914 6.559 2.316 8.849 5.752 1.213 1.82 2.609 4.293 3.101 5.496.94 2.295 1.048 2.393 1.969 1.808 1.267-.804-1.761-7.824-4.712-10.924-1.732-1.819-11.101-4.351-18.643-5.037-1.645-.15-3.923-.36-5.062-.466-1.14-.106-5.385-.311-9.436-.454-4.05-.143-8.089-.336-8.975-.428-.886-.092-3.682.087-6.213.399Zm-140.711 1.446c1.082.339 3.486.675 5.342.746l3.375.129.091 5.915c.116 7.589-.045 7.885-4.539 8.327-3.278.324-5.297.059-4.868-.637.128-.206-.09-.642-.483-.969-1.637-1.358-2.16-3.35-2.391-9.117-.22-5.477-.192-5.712.638-5.369.477.197 1.753.636 2.835.975Zm98.289 2.61c.877 1.075 1.916 2.733 2.309 3.682.636 1.536.894 1.726 2.349 1.726.899 0 1.634-.142 1.634-.315 0-1.308-2.172-4.277-4.063-5.554-3.264-2.204-4.236-2.003-2.229.461Zm160.707 13.759c-6.483 1.463-8.45 2.811-14.339 9.829-2.125 2.531-4.646 5.431-5.605 6.443-1.881 1.988-4.62 6.037-10.867 16.063-8.484 13.615-12.208 16.067-29.752 19.584a60.29 60.29 0 0 1-5.293.761c-1.497.135-4.379.438-6.404.672a183.82 183.82 0 0 1-7.824.688c-3.732.237-6.421.574-11.276 1.414-2.151.373-3.553 1.729-4.888 4.727-2.206 4.957-2.514 7.186-2.375 17.195.128 9.272.135 9.328 1.49 12.076 1.615 3.279 5.7 9.379 8.025 11.987a110.62 110.62 0 0 1 3.492 4.18c1.685 2.134 9.145 8.517 13.082 11.193.91.619 1.929 1.395 2.263 1.726.335.33.819.601 1.076.601.412 0-.358 1.553-4.451 8.975-.558 1.012-1.8 3.29-2.761 5.062-.96 1.772-2.232 3.995-2.826 4.939-.595.944-1.081 1.81-1.081 1.923 0 .114-.756 1.515-1.68 3.116-.925 1.6-2.447 4.256-3.383 5.901a1975.49 1975.49 0 0 1-3.553 6.214c-6.731 11.717-9.334 16.375-9.334 16.706 0 .924-1.219 1.967-1.965 1.681-.735-.282-.728-.392.103-1.559.492-.69 1.295-2.274 1.787-3.52.491-1.246 1.32-2.99 1.842-3.875.522-.885 2.177-4.509 3.677-8.053 1.501-3.544 4.329-9.861 6.285-14.037 1.956-4.177 4.078-8.734 4.715-10.126.637-1.392 2.605-5.61 4.371-9.372 2.909-6.198 3.143-6.908 2.493-7.559-.65-.651-.766-.591-1.229.628-.281.74-1.145 2.691-1.92 4.336-2.944 6.252-4.902 10.443-6.021 12.888-1.034 2.259-2.298 4.968-6.765 14.498-2.289 4.885-3.231 7.073-3.231 7.512 0 .236-.29.67-.645.965-.355.294-.786 1.096-.958 1.782-.172.686-.909 2.49-1.638 4.008a120.056 120.056 0 0 0-2.532 5.754 937.766 937.766 0 0 1-1.727 4.25c-.445 1.075-.389 1.359.383 1.953.497.383 1.509.645 2.248.583 1.446-.122.333 1.703 15.366-25.197 3.461-6.191 5.101-9.098 8.833-15.648a632.7 632.7 0 0 0 3.238-5.753 299.82 299.82 0 0 1 3.159-5.516c1.039-1.768 1.888-3.533 1.888-3.923 0-.389-.673-1.073-1.495-1.52-.823-.447-3.049-2.044-4.948-3.55a804.668 804.668 0 0 0-5.753-4.519c-4.362-3.377-13.17-13.57-14.381-16.642-.15-.38-.813-1.519-1.474-2.531-2.442-3.739-2.418-3.586-2.226-14.083.14-7.635.368-10.549 1.017-12.957.491-1.824 1.085-3.107 1.438-3.107.331 0 .933-.331 1.337-.735.95-.95 4.744-1.951 8.536-2.252 20.583-1.635 29.121-3.136 39.581-6.955 6.114-2.232 8.844-4.946 15.927-15.832.577-.886 1.681-2.543 2.455-3.682 3.048-4.491 4.768-7.214 5.662-8.964.514-1.007 2.512-3.781 4.44-6.166a620.193 620.193 0 0 0 4.779-5.974c4.829-6.203 9.561-8.057 20.587-8.065 5.227-.004 6.195.134 10.586 1.511 6.974 2.187 12.085 4.79 14.958 7.617 1.327 1.306 2.558 2.829 2.733 3.384.398 1.252.996 1.3 1.309.103.325-1.244-1.856-4.549-4.325-6.553-2.81-2.281-5.674-3.623-12.604-5.907-5.575-1.837-6.376-1.98-11.737-2.101-4.475-.1-6.673.079-9.895.805Zm-379.936 3.721c-.002.185-.78.736-1.729 1.225-.949.489-2.406 1.598-3.236 2.463-2.01 2.093-2.294 5.05-1.006 10.474.511 2.152 1.34 6.812 1.842 10.356.503 3.544 1.447 8.514 2.098 11.046a297.701 297.701 0 0 1 2.271 9.665c.598 2.785 1.52 6.306 2.05 7.824 1.115 3.201 2.277 8.3 2.57 11.277.112 1.139.498 2.899.857 3.912.36 1.012.78 2.469.934 3.238.353 1.761 3.942 8.89 5.51 10.947.652.853 1.184 1.789 1.184 2.081 0 .883 3.157 4.09 5.207 5.288 2.504 1.463 4.727 2.081 9.52 2.645 2.152.252 4.534.547 5.294.654.759.107 3.4.224 5.868.26 4.316.062 4.487.103 4.487 1.091 0 .565-.135 1.163-.3 1.329-.29.288-1.953 4.827-3.91 10.668-.508 1.519-1.095 3.176-1.302 3.682-.208.506-.59 1.542-.85 2.301-.905 2.654-3.402 9.673-3.765 10.586a72.791 72.791 0 0 0-.919 2.531c-.304.886-.738 2.025-.965 2.532-.226.506-.811 2.163-1.3 3.682-.489 1.519-1.643 4.832-2.564 7.364-3.235 8.889-8.068 23.807-8.177 25.243-.167 2.18 1.065 1.844 2.272-.62 1.18-2.411 1.394-2.272.35.228-.767 1.836-.618 2.994.385 2.994.548 0 2.203-3.122 4.148-7.824.366-.886 1.303-3.061 2.082-4.833.778-1.772 2.441-5.811 3.695-8.975 1.253-3.164 3.672-9.17 5.373-13.347 1.702-4.177 3.768-9.355 4.592-11.507.825-2.151 2.575-6.461 3.89-9.577 1.315-3.115 2.47-6.015 2.566-6.443.272-1.205 4.337-10.776 4.83-11.371.278-.335 2.581-.566 6.321-.634 3.235-.058 7.122-.179 8.638-.269 1.516-.089 5.655-.313 9.199-.496a889.42 889.42 0 0 0 8.054-.442c.886-.059 4.511-.259 8.055-.443 3.544-.184 6.598-.429 6.787-.544.572-.349 1.126 1.438 4.224 13.65 1.637 6.455 3.51 13.704 4.161 16.109a5226.94 5226.94 0 0 1 1.371 5.063c.102.38.524 2.037.939 3.682.796 3.166 1.505 5.842 2.744 10.356a1375.242 1375.242 0 0 1 4.461 16.799c2.625 10.132 3.555 13.597 4.507 16.799.527 1.772.86 3.481.739 3.797-.469 1.236-1.174.46-1.882-2.071-.407-1.456-1.527-5.132-2.488-8.169-8.761-27.679-10.16-32.053-11.264-35.21a320.568 320.568 0 0 1-2.495-7.594c-.797-2.531-2.698-8.427-4.225-13.101a1403.312 1403.312 0 0 1-4.398-13.693c-1.336-4.281-1.779-5.193-2.516-5.193-1.173 0-1.13.736.257 4.421.634 1.684 1.239 3.501 1.345 4.038.105.537.824 2.84 1.598 5.118.773 2.278 2.561 7.87 3.973 12.427 1.412 4.556 3.061 9.734 3.664 11.506.603 1.772 2.156 6.639 3.451 10.816 1.296 4.177 2.951 9.355 3.679 11.506.728 2.152 2.812 8.469 4.631 14.038 3.903 11.947 4.224 12.657 5.707 12.657 1.704 0 2.557-.477 2.557-1.429 0-.956-3.196-14.133-5.792-23.885-.91-3.417-1.921-7.352-2.247-8.745-.325-1.392-1.563-6.259-2.751-10.816-1.189-4.556-2.324-9.009-2.523-9.895-.2-.886-1.234-4.925-2.298-8.975l-3.568-13.577c-.899-3.418-1.892-7.198-2.206-8.4l-.572-2.186h7.229l.01 2.646c.043 11.533.632 17.859 1.701 18.27 1.25.48 1.611-.253 1.317-2.677-.157-1.298-.388-5.467-.513-9.264-.126-3.797-.345-7.473-.487-8.17-.196-.952-.081-1.265.462-1.265.396 0 2.639-.621 4.984-1.381 3.756-1.216 4.412-1.593 5.522-3.172 1.813-2.577 2.357-5.795 2.073-12.243-.436-9.906-3.131-15.038-9.479-18.047l-2.463-1.168.286-2.821c.571-5.617.504-28.314-.084-28.903-.304-.303-.711-.393-.905-.201-.527.525-.891 9.772-.85 21.586l.037 10.491-1.15-.288c-.632-.159-1.175-.323-1.206-.366-.03-.043-.407-3.495-.836-7.672a3123.368 3123.368 0 0 0-1.671-15.773c-.489-4.498-.89-8.381-.89-8.629 0-.248-.238-.451-.528-.451-.383 0-.435 1.105-.186 4.027.188 2.215.425 5.166.526 6.558.101 1.393.395 4.499.655 6.904.755 7.015 1.378 14.418 1.224 14.571-.077.078-1.81.013-3.849-.145l-3.708-.285-.05-2.353c-.071-3.307-.422-4.655-2.185-8.386-2.173-4.602-6.083-7.894-12.037-10.136-2.362-.889-3.805-1.091-8.054-1.123-2.847-.022-6.471.107-8.053.286-2.284.259-2.888.195-2.932-.309-.031-.349-.024-2.291.014-4.317.039-2.025-.056-4.976-.211-6.558-.252-2.582-.386-2.877-1.304-2.877-1.011 0-1.021.067-.849 5.638.095 3.102.348 6.311.562 7.134l.389 1.496h-5.91l-.07-3.797c-.038-2.089-.118-4.004-.177-4.257-.059-.253-.131-1.873-.16-3.599-.05-2.979-.106-3.132-1.088-2.992-.984.14-1.029.32-.894 3.599.078 1.899.336 5.093.572 7.099.237 2.005.38 3.69.319 3.743-.062.054-2.62-.034-5.682-.194l-5.57-.292-2.485-2.097c-3.82-3.223-9.364-6.73-15.948-10.088-2.09-1.065-3.674-2.137-3.522-2.383.384-.622-12.006-12.679-14.16-13.778-2.565-1.308-6.83-2.298-9.287-2.155-1.175.068-2.137.275-2.139.46Zm7.064 2.04c4.047 2.064 15.642 11.658 14.94 12.361-.29.289-8.763-1.798-13.35-3.289-4.192-1.362-5.904-2.89-6.984-6.231-.901-2.793-.95-3.924-.177-4.182.806-.27 3.848.461 5.571 1.341Zm-7.776 2.328c.28 1.882.683 2.863 2.103 5.116 1.207 1.916 5.368 3.603 13.334 5.407 1.899.43 4.902 1.295 6.674 1.922 3.51 1.242 14.167 6.612 15.649 7.885.506.435 1.852 1.382 2.991 2.106 1.14.723 3.084 2.162 4.322 3.197 3.092 2.585 14.067 13.388 16.159 15.907.941 1.133 2.983 2.979 4.538 4.103 1.554 1.124 2.938 2.209 3.074 2.411.675 1.007 6.103 1.399 21.021 1.517 9.486.075 16.95.334 18.313.635 1.266.279 3.234.687 4.373.905 2.507.48 3.759 1.113 6.359 3.214 4.273 3.454 5.456 6.81 5.883 16.683l.289 6.673-1.778 1.671c-1.801 1.693-5.362 3.27-8.696 3.852-1.005.176-4.416.386-7.58.468-3.165.081-7.618.261-9.896.399a978.55 978.55 0 0 1-10.125.539c-3.291.157-7.123.352-8.515.432-1.392.079-5.12.288-8.285.464-3.164.175-6.478.391-7.364.48-5.254.528-16.43.896-26.234.865-9.86-.032-11.495-.141-13.017-.865-1.77-.843-5.854-4.399-5.854-5.098 0-.211-1.119-2.262-2.487-4.557-1.368-2.295-2.742-4.984-3.053-5.976-.311-.992-.934-2.442-1.385-3.222-.974-1.687-2.566-6.763-2.97-9.474-.159-1.064-.464-2.396-.679-2.96-.215-.565-.513-1.803-.664-2.751-.15-.948-.454-2.071-.673-2.494-.219-.422-.965-3.15-1.657-6.061-.692-2.912-1.873-7.779-2.624-10.816-.75-3.038-1.858-8.423-2.46-11.967-.602-3.544-1.316-7.168-1.586-8.054-.27-.886-.796-3.333-1.167-5.436-.58-3.281-.584-4.035-.036-5.293.61-1.4 2.965-4.22 3.269-3.914.08.079.275 1.019.434 2.087Zm141.528 6.284c-.119.119-1.459.349-2.976.51-3.14.333-7.363 2.279-8.597 3.961-.855 1.165-1.982 8.604-2.436 16.068-.203 3.358.193 9.622.917 14.498.113.76.411 8.63.663 17.49.252 8.86.66 16.937.906 17.95.585 2.401 3.83 9.142 5.574 11.579.753 1.053 2.248 2.867 3.323 4.032 1.72 1.865 2.395 2.234 5.636 3.086 2.025.533 4.149.996 4.718 1.031.569.035 1.035.113 1.035.175 0 .061-2.47 9.071-5.49 20.021-5.579 20.226-9.726 35.504-9.888 36.428-.05.28-.33 1.235-.624 2.121-.293.886-.629 2.129-.747 2.762-.117.632-.977 4.05-1.911 7.594-2.169 8.233-2.274 9.05-1.381 10.776.649 1.255.966 1.42 2.728 1.42h1.993l2.078-5.408c1.143-2.974 2.957-8.1 4.032-11.391 1.075-3.291 2.218-6.604 2.541-7.364.588-1.382 10.497-30.591 15.888-46.831l2.864-8.629 1.898.014c1.044.008 3.348.201 5.12.431 1.772.229 7.571.754 12.887 1.165 5.316.411 10.567.89 11.669 1.065l2.003.316.143 3.912c.174 4.727.613 17.491.926 26.925.354 10.667.669 19.677.917 26.235.125 3.29.328 8.986.451 12.657.591 17.59 1.084 23.59 2.014 24.52.236.236 1.246.291 2.246.122l1.816-.307.295-5.609c1.234-23.479 1.839-36.705 2.384-52.095.134-3.797.333-8.353.443-10.125.11-1.772.329-7.157.487-11.967.158-4.81.359-9.211.448-9.78.106-.68-.158-1.207-.768-1.533-1.474-.789-1.288-2.246-1.974 15.455-.138 3.544-.36 9.654-.495 13.578-.136 3.924-.336 9.205-.447 11.736-.11 2.532-.329 9.263-.486 14.959-.158 5.695-.357 11.598-.443 13.117-.086 1.519-.173 6.865-.192 11.882l-.035 9.12-1.185-.145-1.185-.146-.163-8.054c-.216-10.645-.666-25.502-.92-30.377-.112-2.152-.32-8.365-.462-13.808-.141-5.442-.349-11.034-.461-12.426-.113-1.393-.336-7.917-.496-14.498-.238-9.855-.416-12.109-1.002-12.772-.674-.762-.426-.807 4.537-.829 6.573-.029 8.473-.262 13.073-1.601 4.435-1.29 11.912-3.609 14.827-4.599 1.165-.396 2.264-.555 2.442-.355.178.201 4.693 13.309 10.033 29.131 5.34 15.821 10.23 30.155 10.866 31.854 1.855 4.959.561 4.027-1.583-1.139-2.081-5.016-3.376-7.957-5.621-12.766-.768-1.645-2.485-5.477-3.815-8.514a494.486 494.486 0 0 0-4.253-9.435 448.306 448.306 0 0 1-4.14-9.206c-2.15-4.938-3.231-7.314-6.642-14.613-1.324-2.83-1.841-3.247-3.067-2.47-.709.449-.166 1.812 6.16 15.473.587 1.265 2.318 5.143 3.849 8.616 1.53 3.474 2.964 6.684 3.187 7.134.454.918 1.324 2.834 2.987 6.572.619 1.392 1.75 3.883 2.512 5.536.763 1.653 1.95 4.345 2.639 5.984.688 1.638 2.483 5.536 3.988 8.662 2.174 4.516 2.897 5.634 3.515 5.438 2.967-.94 2.678-1.401 3.025 4.836.174 3.121.38 6.192.458 6.824.078.633.174 2.121.214 3.306.059 1.759.252 2.212 1.05 2.466 1.455.462 1.798-.505 1.562-4.391-.115-1.898-.328-7.076-.472-11.506-.145-4.43-.35-9.504-.455-11.276a767.566 767.566 0 0 1-.449-8.975c-.143-3.165-.361-7.825-.487-10.356-.126-2.531-.433-8.952-.682-14.268a2796.74 2796.74 0 0 0-.678-13.807c-.123-2.279-.335-6.628-.471-9.666-.355-7.894-.665-14.526-.916-19.561-.119-2.404-.326-7.168-.46-10.585a734.676 734.676 0 0 0-.466-10.126c-.123-2.152-.334-6.294-.47-9.205-.136-2.911-.447-6.944-.692-8.963a257.663 257.663 0 0 1-.444-3.797c0-.07-.524-.127-1.163-.127h-1.163l.288 6.05c.255 5.367.207 6.019-.43 5.775-.91-.35-6.698 1.602-9.335 3.148-3.611 2.116-2.053 2.864 1.907.916 1.266-.623 2.638-1.139 3.049-1.147.411-.008 1.706-.549 2.876-1.204 1.171-.655 2.139-1.12 2.15-1.035.011.084.139 2.38.284 5.102.303 5.661.608 5.34-4.225 4.447-4.666-.863-8.303-2.967-12.65-7.318-4.499-4.504-3.973-3.839-12.3-15.57-2.319-3.268-8.704-10.065-10.711-11.404a198.794 198.794 0 0 1-3.661-2.524c-2.182-1.544-10.832-4.544-13.142-4.558-.76-.005-2.107-.23-2.991-.5-.884-.27-4.922-.786-8.972-1.146-4.05-.36-8.814-.873-10.586-1.139-9.439-1.42-29.738-3.462-30.165-3.035Zm265.692 1.284c.699 1.821-3.769 17.342-6.368 22.12-.375.69-.672 1.364-.66 1.498.044.505-3.35 7.039-5.195 9.999-1.057 1.696-2.807 4.112-3.888 5.369l-1.967 2.284 1.459.32c1.328.292 1.64.12 3.477-1.917 3.779-4.19 10.251-16.359 12.342-23.206a192.2 192.2 0 0 1 1.656-5.101c.49-1.428 1-3.5 1.133-4.603.134-1.103.338-2.457.455-3.009.298-1.415-.486-3.217-1.679-3.855-.829-.444-.967-.425-.765.101Zm-250.485 2.005c8.383.836 10.447 1.088 11.574 1.414 1.123.325 11.573 1.551 15.811 1.854 2.025.145 4.806.544 6.179.887 1.373.343 2.659.523 2.857.401.438-.271 6.965 1.362 9.232 2.309 2.341.978 10.371 7.591 12.717 10.473 1.094 1.344 4.1 5.26 6.679 8.702 4.029 5.375 5.922 7.597 11.023 12.935 1.42 1.485 5.621 3.96 8.354 4.921 1.622.57 4.01.957 6.239 1.011l3.611.087.256 2.582c.244 2.461.423 5.953.967 18.921.133 3.165.343 7.825.465 10.356.341 7.026.645 13.655.929 20.251.142 3.291.347 7.641.455 9.666.108 2.025.31 6.995.447 11.046.139 4.05.345 8.399.46 9.665.114 1.266.322 6.029.461 10.586l.253 8.284-1.789-5.753c-4.706-15.133-18.616-55.981-19.223-56.45-.562-.434-.244-.672 1.756-1.314 3.213-1.031 7.968-3.312 8.671-4.158.307-.37.824-.672 1.149-.672.897 0 5.739-4.099 5.739-4.858 0-.894-.111-.865-2.393.637-5.933 3.903-11.829 6.747-18.548 8.947-8.698 2.846-18.782 5.779-20.942 6.09-3.363.483-14.698.589-18.18.169l-5.062-.613c-1.862-.227-27.244-2.837-31.068-3.195-6.747-.632-8.289-.852-10.495-1.5-1.343-.393-3.036-1.216-3.762-1.827-3.472-2.921-7.976-10.881-9.732-17.198-.387-1.389-.615-6.536-.694-15.648-.065-7.468-.346-15.235-.624-17.26-.904-6.575-1.042-16.146-.326-22.483.738-6.529 1.247-7.67 4.081-9.141 1.928-1 9.119-1.689 12.578-1.205 1.265.178 5.718.664 9.895 1.081Zm258.443 7.845c-2.684 9.234-2.756 10.053-2.795 31.728-.038 22.003-.287 24.839-2.725 31.039-.64 1.63-1.165 3.267-1.165 3.637 0 .962-3.887 7.588-6.558 11.179-2.939 3.951-3.307 4.124-15.764 7.442-8.127 2.164-9.976 2.423-20.711 2.9-3.544.157-6.705.497-7.024.755-.805.652-15.133 1.606-22.742 1.515l-6.293-.076-.922 3.482c-.506 1.915-1.851 6.9-2.987 11.077-1.137 4.177-3.443 12.668-5.125 18.87-1.682 6.202-3.557 12.933-4.165 14.958-.609 2.025-1.958 6.893-2.999 10.816a2019.844 2019.844 0 0 1-2.274 8.515c-3.278 11.889-3.707 14.15-2.794 14.713.632.392 1.997-4.248 10.831-36.805 5.384-19.846 9.878-36.354 10.927-40.144l1.048-3.783 14.268-.209c7.847-.115 15.368-.422 16.713-.681 1.345-.259 3.727-.495 5.293-.522 3.304-.059 6.52-.526 14.814-2.152l8.217-1.609c1.228-.24 2.367-.303 2.531-.14.164.163.642 1.781 1.062 3.597.421 1.814 3.174 12.93 6.12 24.701 2.945 11.771 6.402 25.596 7.681 30.723 2.78 11.143 3.621 13.636 4.672 13.838.558.108.782-.156.777-.918-.008-1.014-2.136-9.846-4.806-19.94a2654.17 2654.17 0 0 1-3.983-15.418 5810.775 5810.775 0 0 0-4.559-17.72 1944.06 1944.06 0 0 1-3.236-12.657c-.794-3.164-1.739-5.985-2.099-6.269-.529-.417-.235-.71 1.539-1.53 5.14-2.379 6.432-3.485 9.947-8.513 7.179-10.269 10.47-22.793 9.744-37.077-.433-8.503-.455-21.314-.045-25.774.198-2.152.752-5.569 1.23-7.594 1.001-4.231 1.12-7.168.325-7.963-.926-.926-1.194-.652-1.968 2.009Zm-100.327 11.418c.096 3.559-.088 7.054-.493 9.32l-.648 3.626 1.189 1.059c.655.582 1.282.967 1.395.854.464-.465 1.134-6.798 1.127-10.668-.009-5.683-1.016-9.886-2.368-9.886-.196 0-.287 2.563-.202 5.695Zm-249.937-.549c2.785.037 7.946.028 11.469-.02 5.809-.079 6.741.025 10.012 1.114 3.624 1.207 7.74 3.849 10.082 6.47 1.641 1.837 3.492 6.352 3.847 9.383l.296 2.531-13.48-.017c-9.265-.011-14.056-.192-15.322-.579-2.64-.806-3.169-1.27-14.01-12.291-2.24-2.278-4.635-4.82-5.322-5.648l-1.248-1.506 4.307.248c2.369.137 6.585.279 9.369.315Zm192.937-.198c-.107.19-.145.863-.084 1.496.061.633.242 4.671.404 8.975.16 4.303.388 9.895.505 12.427.197 4.271.433 9.663.925 21.171.109 2.532.318 7.917.465 11.967.148 4.05.353 9.435.457 11.966.104 2.532.306 8.331.451 12.888.144 4.556.355 10.252.469 12.657.115 2.404.32 8.1.458 12.656.137 4.557.349 10.77.471 13.808.123 3.038.33 8.216.461 11.506.291 7.285.619 13.252.952 17.329.176 2.151.083 3.164-.313 3.409-.856.528-4.619.266-5.416-.378-.581-.47-.635-.45-.314.122 1.327 2.357 3.096 2.865 6.205 1.781l1.491-.52-.279-11.561c-.154-6.36-.368-13.53-.476-15.935-.108-2.405-.327-8.1-.486-12.657-.16-4.556-.363-9.838-.451-11.736-.089-1.899-.289-7.077-.444-11.506-.155-4.43-.373-10.023-.484-12.427-.112-2.405-.319-7.894-.461-12.197-.141-4.303-.347-10.103-.457-12.887-.11-2.785-.315-8.687-.456-13.117-.141-4.43-.348-10.333-.459-13.118a1851.69 1851.69 0 0 1-.503-15.418c-.164-5.696-.39-10.511-.502-10.701-.112-.19-.593-.345-1.069-.345s-.954.155-1.06.345Zm27.408 4.212-3.338 4.072-4.026-.229c-3.401-.195-4.742-.037-8.629 1.01-4.207 1.134-8.492 3.192-7.893 3.791.135.135 1.966-.284 4.07-.929 6.865-2.109 9.577-2.65 12.58-2.512l2.944.135-1.376 2.045c-2.215 3.292-3.562 10.033-3.971 19.87-.198 4.775-.179 4.893.844 5.16.576.151 1.103.218 1.171.15.068-.067.216-2.493.33-5.389.295-7.512 1.084-14.068 1.878-15.602.375-.726 1.98-3.013 3.567-5.081 5.309-6.919 6.817-9.321 6.267-9.984-.276-.332-.632-.598-.79-.591-.16.006-1.792 1.845-3.628 4.084Zm95.562 26.491c-.315.315-5.271 1.561-7.218 1.815-1.708.223-8.855.781-12.286.96-4.413.231-10.847 1.319-14.012 2.372-5.61 1.866-12.935 5.861-15.725 8.576-1.364 1.329-3.045 2.778-3.735 3.219-1.533.981-4.672 5.717-5.693 8.586-1.07 3.008-4.418 9.921-6.356 13.125-1.396 2.308-2.208 5.32-1.434 5.32.121 0 1.673-1.43 3.45-3.178 3.014-2.967 5.074-6.3 5.074-8.208 0-.92 4.244-9.331 5.962-11.817 2.842-4.112 8.171-7.948 15.21-10.948 7.189-3.064 9.812-3.568 24.49-4.709 6.409-.498 8.94-.896 11.846-1.864 3.943-1.314 4.328-1.583 3.888-2.728-.258-.674-2.909-1.073-3.461-.521Zm-104.037 8.304c-.293.293-8.703 1.542-11.354 1.686-1.761.096-1.899.179-1.178.707.467.341 2.066.598 3.722.598 1.985 0 2.922.182 2.963.576l.174 1.725c.064.633.257 4.983.431 9.666.174 4.683.394 9.757.489 11.276.094 1.519.292 5.765.439 9.435.521 13.019 1.053 24.168 1.407 29.456.11 1.646.326 4.959.482 7.362.163 2.52.508 4.515.817 4.711.825.525 3.434.415 3.789-.159.393-.637.506-5.555.921-40.145l.33-27.541-1.102.156-1.102.156-.064 32.799c-.064 32.607-.164 34.793-1.544 33.939-.194-.119-.393-3.793-.441-8.164-.048-4.371-.155-8.878-.239-10.017-.083-1.14-.281-5.696-.44-10.126-.303-8.419-.577-14.735-.96-22.092-.126-2.405-.348-7.79-.494-11.967-.146-4.177-.323-8.347-.393-9.267l-.127-1.674 3.335-.537c1.834-.296 3.462-.666 3.617-.821.49-.49-1.197-1.969-2.245-1.969-.551 0-1.106.104-1.233.231Zm45.872 3.503c-11.696 2.441-16.481 3.149-21.348 3.161-4.301.01-7.418.737-7.418 1.73 0 .541 1.007.618 5.869.448 5.849-.205 10.487-.823 19.215-2.562 5.348-1.065 8.27-1.556 9.927-1.67 1.509-.102 2.27-.577 2.27-1.416 0-.911-3.231-.793-8.515.309ZM135.17 323.165c-.727.145-.821.469-.609 2.083.139 1.051.367 2.418.506 3.036.14.619.673 3.208 1.185 5.753.512 2.546 1.131 5.457 1.375 6.47s.961 4.549 1.592 7.858c.632 3.309 1.255 6.312 1.384 6.674.128.361.335 1.278.46 2.037.364 2.224 2.157 10.245 3.289 14.722.752 2.971.9 4.226.526 4.457-.801.495-1.081.124-1.702-2.253a522.549 522.549 0 0 0-1.939-7.03 877.496 877.496 0 0 0-3.118-10.816c-2.25-7.667-9.672-31.67-9.847-31.845-.125-.125-.626-.101-1.113.054-.833.265-.848.423-.261 2.688.343 1.325.835 3.051 1.094 3.837.259.785.547 1.826.641 2.312.179.929 2.239 8.093 3.054 10.622.262.811.559 1.908.661 2.436.102.529.404 1.625.67 2.436.268.812 1.313 4.376 2.322 7.92 1.01 3.544 2.127 7.375 2.484 8.515l2.345 7.522 1.698 5.451 1.618-.303c3.382-.634 3.799-.96 3.383-2.637-.207-.835-.733-3.59-1.169-6.121-.435-2.532-1.172-6.26-1.636-8.285a293.625 293.625 0 0 1-1.61-7.594 260.83 260.83 0 0 0-1.131-5.523c-.202-.886-.585-2.646-.852-3.912a1430.05 1430.05 0 0 0-1.436-6.674 484.274 484.274 0 0 1-2.106-10.125c-.693-3.491-.901-3.935-1.758-3.765Zm-40.333 1.618c0 .208-3.093 7.694-5.736 13.883-1.19 2.785-2.744 6.616-3.456 8.515-.711 1.898-2.236 5.626-3.39 8.284a351.416 351.416 0 0 0-3.98 9.647c-2.8 7.15-7.986 19.348-8.154 19.179-.081-.08.148-.956.508-1.944 2.825-7.755 4.515-12.454 4.618-12.844.066-.253.243-.771.394-1.151.465-1.178 3.134-8.936 3.324-9.665.099-.38.692-2.14 1.318-3.912 4.822-13.658 6.351-18.041 6.502-18.64.095-.38.983-2.956 1.973-5.724 1.224-3.423 2.08-5.142 2.674-5.375.887-.348 3.405-.536 3.405-.253Zm9.67 4.103c.002 2.088.199 7.214.437 11.391.237 4.177.555 11.529.705 16.339.15 4.81.359 10.298.464 12.197.105 1.898.321 7.697.478 12.887.158 5.189.425 10.979.595 12.867.343 3.823.557 4.02 4.45 4.115l1.842.045.08-4.716c.043-2.594.199-12.277.345-21.516.147-9.24.377-23.468.513-31.617.241-14.562.229-14.828-.692-15.32-.515-.276-.959-.339-.986-.14-.292 2.145-.99 45.104-.998 61.46-.006 10.403-.048 10.931-.875 10.931-.478 0-.951-.259-1.052-.576-.1-.316-.407-5.339-.682-11.161-.613-12.978-.83-17.608-1.397-29.686-.243-5.19-.553-12.749-.689-16.799-.417-12.44-.655-14.498-1.67-14.498-.786 0-.872.374-.868 3.797Zm-33.414-2.119a89.746 89.746 0 0 1-.974 2.694c-.382 1.013-1.07 2.98-1.53 4.372-.459 1.393-2.002 5.846-3.43 9.896-4.114 11.677-6.025 17.237-9.714 28.266-3.485 10.42-3.582 11.055-1.688 11.079.525.006 9.323-17.369 9.323-18.411 0-.249.207-.453.46-.453s.46-.198.46-.44 1.573-3.712 3.494-7.71c12.716-26.457 13.287-27.75 12.261-27.75-.25 0-.712.311-1.027.691-.315.38-4.794 9.127-9.952 19.438-5.158 10.311-9.378 18.609-9.378 18.44 0-.169.228-.891.506-1.603.454-1.162 2.318-6.381 6.46-18.095a896.684 896.684 0 0 0 2.717-7.825c.732-2.151 1.87-5.362 2.53-7.134 1.74-4.684 2.037-5.753 1.6-5.753-.215 0-.716-.125-1.115-.278-.461-.176-.825.033-1.003.576Zm129.948 6.886c1.075.13 1.956.419 1.956.642 0 .429-2.102 6.486-2.795 8.053-1.016 2.299-21.089 62.584-22.336 67.082-.705 2.539-1.034 3.107-1.801 3.107-1.389 0-3.128-1.343-2.588-1.998.556-.675 4.291-14.289 18.075-65.89 1.014-3.797 2.153-7.985 2.531-9.307l.687-2.403 2.157.239c1.187.131 3.038.345 4.114.475Zm10.652 6.953c-.026 2.73-.126 6.103-.222 7.495-.096 1.392-.229 11.065-.297 21.495-.12 18.499-.1 18.981.798 19.662 1.014.768 3.327.937 4.31.314.357-.226.7-1.436.796-2.801.093-1.322.467-3.884.832-5.694.365-1.809 1.948-11.972 3.518-22.584 2.759-18.649 2.826-19.317 1.998-19.922-.472-.345-.906-.465-.965-.266-.18.607-5.571 37.01-5.882 39.713-.841 7.325-1.732 10.585-2.892 10.585-.184.001-.266-11.685-.183-25.968.152-25.907.15-25.97-.805-26.481-.941-.503-.958-.427-1.006 4.452Zm200.469 10.142c.168 3.227.381 6.179.474 6.558.094.38.296 3.694.449 7.364.154 3.671.37 8.02.481 9.666l.201 2.991-1.345-4.602c-.741-2.532-2.639-9.729-4.219-15.994-2.869-11.378-2.874-11.391-4.122-11.391h-1.25l1.301 4.947c3.785 14.399 9.795 38.19 9.824 38.892.025.589.423.805 1.483.805h1.448l-.126-5.105c-.07-2.808-.246-6.278-.392-7.71-.348-3.406-.554-5.842-1.672-19.818-.515-6.429-1.045-11.866-1.178-12.081-.132-.215-.56-.391-.951-.391-.618 0-.671.756-.406 5.869Zm-30.703-3.727c-.123.214-2.336 6.707-4.917 14.428-2.582 7.72-4.81 14.348-4.951 14.728-2.807 7.527-16.251 47.621-16.251 48.464 0 .368.298.917.662 1.219 1.127.936 1.288.511 10.419-27.591a9469.999 9469.999 0 0 1 11.293-34.505c4.444-13.465 5.14-15.961 4.603-16.499-.348-.348-.734-.458-.858-.244Zm46.601 3.181c0 .143.394 1.231.875 2.417a1840.646 1840.646 0 0 1 6.71 16.884c6.249 15.961 8.105 19.673 9.257 18.521.219-.219-1.195-4.972-2.087-7.015a81.891 81.891 0 0 1-1.172-2.991c-.424-1.139-1.06-2.693-1.413-3.452-.782-1.68-6.075-14.503-8.406-20.365-1.433-3.604-1.851-4.256-2.728-4.257-.569-.001-1.036.115-1.036.258ZM67.278 392.596c-.542.933-.673.634-.229-.523.157-.411.384-.651.502-.532.119.118-.004.593-.273 1.055Z",fill:"currentColor"}),y.createElement("path",{d:"M68.659 236.623c-.392.634 1.335 2.549 3.032 3.364 5.129 2.461 9.96 3.95 19.257 5.934 17.174 3.667 22.188 4.348 35.209 4.779 6.875.228 11.02.334 37.166.944 10.209.238 10.719.162 9.658-1.44-.368-.556-9.91-.906-37.159-1.362-15.334-.257-19.661-.5-28.075-1.581-3.671-.471-11.901-1.988-14.958-2.757a113.98 113.98 0 0 0-3.682-.839l-2.071-.434 2.543-.055c1.4-.031 4.195.144 6.213.387 2.019.243 6.57.662 10.114.932 3.544.268 8.1.694 10.126.945 7.297.905 21.775 1.734 28.765 1.649 3.924-.049 11.069.133 15.879.402 12.128.681 13.769.607 13.955-.631.08-.538.08-.998 0-1.023-.081-.024-3.254-.127-7.051-.228-3.797-.102-7.164-.283-7.481-.402-.317-.12-5.184-.231-10.816-.247-5.631-.016-12.931-.221-16.222-.456-3.291-.235-9.297-.65-13.347-.922-4.051-.273-8.4-.688-9.666-.921-1.265-.234-5.408-.543-9.205-.687-3.797-.143-9.182-.555-11.966-.914-2.785-.36-6.41-.687-8.055-.727-3.905-.095-6.8-.941-9.223-2.696-2.08-1.506-2.538-1.665-2.94-1.014Zm186.484 17.914c-1.438.092-2.186.349-2.186.75 0 .454 1.382.69 5.408.923 2.974.173 6.65.395 8.169.495 1.519.1 5.972.297 9.896.437 19.412.696 31.286 1.19 33.368 1.39 1.266.121 6.133.335 10.816.475 4.683.141 12.036.466 16.339.723 4.303.256 9.171.354 10.816.216l2.992-.25-2.992.704c-3.188.749-9.451.879-21.402.442a24727.77 24727.77 0 0 1-43.724-1.641c-14.681-.565-23.534-.467-23.367.258.134.589 11.67 1.414 24.978 1.786 5.696.159 12.53.39 15.188.511 2.658.121 8.561.329 13.118.462 12.828.374 21.818.71 24.947.931 5.239.371 15.995-1.416 17.856-2.965.506-.422 1.49-1.051 2.186-1.399.697-.347 1.266-.935 1.266-1.305 0-.542-.334-.594-1.726-.267-2.477.582-27.318.429-37.626-.232-4.809-.308-11.644-.642-15.188-.742-5.815-.163-9.687-.341-20.479-.938-3.058-.17-17.062-.66-23.935-.839a63.932 63.932 0 0 0-4.718.075Z",fill:"#1E1919"})))};const Yn=(e,t,n)=>{const r=a.getName(n),s=a.getParentFolderName(n);return t?e.formatMessage({id:"5xCeTo",defaultMessage:"Removing members from <strong>{folderName}</strong>…"},{folderName:i.Emstring.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>y.default.createElement("strong",null,e)}):""===s?e.formatMessage({id:"90I244",defaultMessage:"Sharing <strong>{folderName}</strong> with everyone…"},{folderName:i.Emstring.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>y.default.createElement("strong",null,e)}):e.formatMessage({id:"16RnmU",defaultMessage:"Sharing <strong>{folderName}</strong> with members of <strong>{parentFolderName}</strong>…"},{folderName:i.Emstring.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),parentFolderName:i.Emstring.em_snippet(s,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>y.default.createElement("strong",null,e)})},Kn=(e,t)=>t?e.formatMessage({id:"1HgFQB",defaultMessage:"Couldn’t remove members. Try again."}):e.formatMessage({id:"ypun4U",defaultMessage:"Couldn’t share folder. Try sharing again."}),Jn=e=>e.formatMessage({id:"sKbWSj",defaultMessage:"Couldn’t load member list. Please try again."}),Xn=(e,t,n)=>{const r=a.getName(n),s=a.getParentFolderName(n);return t?e.formatMessage({id:"7POTZF",defaultMessage:"Members removed from <strong>{folderName}</strong>."},{folderName:i.Emstring.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>y.default.createElement("strong",null,e)}):void 0===s||""===s?e.formatMessage({id:"nni9pE",defaultMessage:"<strong>{folderName}</strong> shared with everyone."},{folderName:i.Emstring.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>y.default.createElement("strong",null,e)}):e.formatMessage({id:"qvP8A+",defaultMessage:"<strong>{folderName}</strong> shared with members of <strong>{parentFolderName}</strong>."},{folderName:i.Emstring.em_snippet(r,a.SNIPPET_SIZES.FOLDER_NAME),parentFolderName:i.Emstring.em_snippet(s,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>y.default.createElement("strong",null,e)})},er=e=>e.formatMessage({id:"2kS9ex",defaultMessage:"Can view"}),tr=(e,t)=>"editor"===t[".tag"]?(e=>e.formatMessage({id:"R8tdDL",defaultMessage:"Can edit"}))(e):"owner"===t[".tag"]?(e=>e.formatMessage({id:"/epRg4",defaultMessage:"Owner"}))(e):"viewer"===t[".tag"]?er(e):"viewer_no_comment"===t[".tag"]?(e=>e.formatMessage({id:"pI4aSB",defaultMessage:"View-only"}))(e):er(e),ar=e=>e.formatMessage({id:"uiUfVo",defaultMessage:"People with a link might still have access."}),nr=e=>e.formatMessage({id:"J9wEBS",defaultMessage:"Manage Links"}),rr=e=>e.formatMessage({id:"6K7VUR",defaultMessage:"Close"}),sr=e=>e.formatMessage({id:"Tmil/1",defaultMessage:"Couldn’t remove member. Try removing them again."}),or=(e,t)=>e.formatMessage({id:"Ye9pDs",defaultMessage:"Removing member from <b>{currentFolder}</b>…"},{currentFolder:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e)}),ir=(e,t)=>e.formatMessage({id:"vhAme6",defaultMessage:"Member removed from <b>{currentFolder}</b>."},{currentFolder:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e)}),lr=e=>e.formatMessage({id:"/4HTAy",defaultMessage:"Updating member access…"}),cr=e=>e.formatMessage({id:"OpE7PX",defaultMessage:"Member access updated."}),dr=e=>e.formatMessage({id:"qMG/h/",defaultMessage:"Couldn’t change access."}),ur=(e,t)=>e.formatMessage({id:"zzQ4WU",defaultMessage:"Changing access for <b>{currentFolder}</b>…"},{currentFolder:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e)}),mr=e=>e.formatMessage({id:"ad6tQw",defaultMessage:"Couldn’t change access. Try changing access again."}),gr=(e,t)=>e.formatMessage({id:"PAzrUg",defaultMessage:"Removing members from <b>{currentFolder}</b>…"},{currentFolder:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e)}),_r=e=>e.formatMessage({id:"OyDuPN",defaultMessage:"Couldn’t remove members. Try removing them again."}),pr=e=>e.formatMessage({id:"idUNYc",defaultMessage:"Checkbox"}),fr=(e,t,n)=>e.formatMessage({id:"/7+vx5",defaultMessage:"Because {memberName} can edit the parent folder, their access to <b>{contentName}</b> can't be changed."},{memberName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),contentName:i.Emstring.em_snippet(n,a.SNIPPET_SIZES.FILENAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e)}),Er=(e,t)=>e.formatMessage({id:"b2R7ut",defaultMessage:"Can't change access for {memberName}"},{memberName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}),br=(e,t)=>e.formatMessage({id:"fP62vP",defaultMessage:"Couldn't change access for {memberName}"},{memberName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}),hr=(e,t,n,r)=>e.formatMessage({id:"kQXitL",defaultMessage:"{count, plural, one{To change their access to <b>{contentName}</b>, you'll need to change their access to the parent folder <b>{singleParentFolderName}</b>.} other{To change their access to <b>{contentName}</b>, you'll need to change their access to the parent folders listed.}}"},{count:t,contentName:i.Emstring.em_snippet(n,a.SNIPPET_SIZES.FILENAME),singleParentFolderName:i.Emstring.em_snippet(r,a.SNIPPET_SIZES.FILENAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e)}),Mr=e=>e.formatMessage({id:"DzCuYI",defaultMessage:"Okay"}),Sr=e=>e.formatMessage({id:"9CMIle",defaultMessage:"Cancel"}),vr=(e,t)=>e.formatMessage({id:"jc0mkL",defaultMessage:"Couldn't remove {memberName}"},{memberName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}),yr=(e,t,n)=>e.formatMessage({id:"1NJLE0",defaultMessage:"Because {memberName} has access to the parent folder, they can't be removed from <b>{contentName}</b>."},{memberName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),contentName:i.Emstring.em_snippet(n,a.SNIPPET_SIZES.FILENAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e)}),Ar=(e,t,n,r)=>e.formatMessage({id:"wslHDy",defaultMessage:"{count, plural, one{To remove them from <b>{contentName}</b>, you'll need to remove them from the parent folder <b>{singleParentFolderName}</b>.} other{To remove them from <b>{contentName}</b>, you'll need to remove them from the parent folders listed.}}"},{count:t,contentName:i.Emstring.em_snippet(n,a.SNIPPET_SIZES.FILENAME),singleParentFolderName:i.Emstring.em_snippet(r,a.SNIPPET_SIZES.FILENAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e)});function Cr(e){return{class:"share",action:"select",object:"manage_access_action",properties:e}}const Ir=Symbol("ON_VIEW_MANAGE_ACCESS"),Tr=Symbol("ON_VIEW_PARENT_FOLDER_REMOVE_ACCESS_MODAL"),Lr=Symbol("ON_VIEW_PARENT_FOLDER_CHANGE_ACCESS_MODAL"),Rr=Symbol("ON_VIEW_PARENT_FOLDER_CHANGE_INHERITANCE_MODAL"),Nr=Symbol("ON_VIEW_CONFIRMATION_MODAL"),kr=Symbol("ON_VIEW_REMOVE_ALL_INHERITED_MEMBERS_CONFIRMATION_MODAL"),wr=Symbol("ON_MEMBER_ACTION_START"),xr=Symbol("ON_MEMBER_ACTION_CANCEL"),Dr=Symbol("ON_MEMBER_ACTION_SUCCESS"),Pr=Symbol("ON_REMOVE_ALL_INHERITED_MEMBERS_START"),$r=Symbol("ON_REMOVE_ALL_INHERITED_MEMBERS_CANCEL"),Or=Symbol("ON_REMOVE_ALL_INHERITED_MEMBERS_SUCCESS"),Fr=Symbol("ON_FAILURE_RENDER"),{useEmitter:Br,defaultEmitter:jr}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(i.Context$2),r=t(i.Context$3),s=t(i.Context),o={...i.getTags(n),...i.getTags$1(r),...i.getTags$2(s),isSm24:"true"},l={...i.getProperties(n),...i.getProperties$1(r),...i.getProperties$2(s)};if(e.key!==Ir)if(e.key!==Tr)if(e.key!==Lr)if(e.key!==Nr)if(e.key!==kr)if(e.key!==wr)if(e.key!==xr)if(e.key!==Dr)if(e.key!==Pr)if(e.key!==$r)if(e.key!==Or)if(e.key!==Rr){if(e.key!==Fr)return a.exhausts(e,void 0);a.UDCL.logEvent("ops.view_manage_access_failure",{tags:{...o,eventState:"failed"}})}else a.UDCL.logEvent(wn({...l,manageAccessElement:"parent_folder_change_inheritance_modal"}),{tags:{...o,element:"parent_folder_change_inheritance_modal"}});else a.UDCL.logEnd(Cr({...l,eventState:"success",memberActionType:e.payload.memberActionType}),{tags:{...o,action:e.payload.memberActionType,eventState:"success"}});else a.UDCL.logEnd(Cr({...l,eventState:"canceled",memberActionType:e.payload.memberActionType}),{tags:{...o,action:e.payload.memberActionType,eventState:"canceled"}});else a.UDCL.logStart(Cr({...l,eventState:"start",memberActionType:e.payload.memberActionType}),{tags:{...o,action:e.payload.memberActionType,eventState:"start"}});else a.UDCL.logEnd(Cr({...l,eventState:"success",memberActionType:e.payload.memberActionType,newAccessLevel:e.payload.newAccessLevel?e.payload.newAccessLevel[".tag"]:void 0}),{tags:{...o,action:e.payload.memberActionType,eventState:"success"}});else a.UDCL.logEnd(Cr({...l,eventState:"canceled",memberActionType:e.payload.memberActionType}),{tags:{...o,action:e.payload.memberActionType,eventState:"canceled"}});else a.UDCL.logStart(Cr({...l,eventState:"start",memberActionType:e.payload.memberActionType,prevAccessLevel:e.payload.prevAccessLevel[".tag"]}),{tags:{...o,action:e.payload.memberActionType,eventState:"start"}});else a.UDCL.logEvent(wn({...l,manageAccessElement:"remove_all_inherited_members_confirmation_modal"}),{tags:{...o,element:"remove_all_inherited_members_confirmation_modal"}});else a.UDCL.logEvent(wn({...l,manageAccessElement:"manage_access_confirmation_modal"}),{tags:{...o,element:"manage_access_confirmation_modal"}});else a.UDCL.logEvent(wn({...l,manageAccessElement:"parent_folder_change_access_modal"}),{tags:{...o,element:"parent_folder_change_access_modal"}});else a.UDCL.logEvent(wn({...l,manageAccessElement:"parent_folder_remove_access_modal"}),{tags:{...o,element:"parent_folder_remove_access_modal"}});else a.UDCL.logEvent(wn({...l,manageAccessElement:"manage_access_screen"}),{tags:{...o,element:"manage_access_screen"}})})),Ur=(e,t)=>{var a;return!!(null!==(a=e.permissions)&&void 0!==a?a:[]).find((e=>e.action[".tag"]===t[".tag"]&&e.allow))},Vr=e=>"user"in e&&null!=e.user?e.user.display_name:"group"in e&&void 0!==e.group?e.group.group_name:"invitee"in e&&void 0!==e.invitee&&"email"===e.invitee[".tag"]?e.invitee.email:"",Hr=(e,t)=>!!t&&("user"in e&&null!=e.user&&e.user.account_id===t.account_id),qr=e=>"user"in e&&null!=e.user?{".tag":"dropbox_id",dropbox_id:e.user.account_id}:"group"in e&&void 0!==e.group?{".tag":"dropbox_id",dropbox_id:e.group.group_id}:"invitee"in e&&void 0!==e.invitee&&"email"===e.invitee[".tag"]?{".tag":"email",email:e.invitee.email}:{".tag":"other"};var Wr;!function(e){e[e.RemoveAccess=0]="RemoveAccess",e[e.DowngradeAccess=1]="DowngradeAccess"}(Wr||(Wr={}));const zr=e=>e.sort(((e,t)=>{const a=Vr(e).toLowerCase(),n=Vr(t).toLowerCase();return a<n?-1:a>n?1:0})),Gr=(e,t,a)=>{const n=((e,t)=>e.formatMessage({id:"b+NGsd",defaultMessage:"{time_str}"},{time_str:t}))(e,ts(e,a));return`${t} · ${n}\n`},Zr=(e,t)=>t<=0?"":((e,t)=>e.formatMessage({id:"+8e1lg",defaultMessage:"{count, plural, one{and # other} other{and # others}}"},{count:t}))(e,t),Qr=[{action:{".tag":"make_editor"},allow:!1},{action:{".tag":"make_owner"},allow:!1},{action:{".tag":"make_viewer"},allow:!1},{action:{".tag":"make_viewer_no_comment"},allow:!1},{action:{".tag":"remove"},allow:!1}],Yr=e=>e?e.map((e=>{const{seen_state_user:{user_id:t,display_name:a,email:n,sharing_access_type:r,same_team:s},when_last_seen:o}=e;let i={".tag":"viewer"};return r&&"edit_link_access"===r[".tag"]&&(i={".tag":"editor"}),{access_type:i,user:{account_id:t,display_name:a,email:n||"",same_team:s,disabled:!1},is_inherited:!1,permissions:Qr,time_last_seen:o?new Date(1e3*o).toString():void 0}})):[],Kr=6e4,Jr=36e5,Xr=864e5,es=2592e6,ts=(e,t,a=new Date)=>{const n=Number(a)-Number(t);if(n>=31536e6)return e.formatDate(t,{year:"numeric",month:"short",day:"numeric"});let r=0,s="minute";switch(n<Kr?(r=0,s="minute"):n<Jr?(r=Math.floor(n/Kr),s="minute"):n<Xr?(r=Math.floor(n/Jr),s="hour"):n<es?(r=Math.floor(n/Xr),s="day"):(r=Math.min(11,Math.floor(n/es)),s="month"),s){case"minute":return 0===r?(e=>e.formatMessage({id:"XP0b1q",defaultMessage:"just now"}))(e):((e,t)=>e.formatMessage({id:"wKaToF",defaultMessage:"{value, plural, one{# minute ago} other{# minutes ago}}"},{value:t}))(e,r);case"hour":return((e,t)=>e.formatMessage({id:"Tq1+vX",defaultMessage:"{value, plural, one{# hour ago} other{# hours ago}}"},{value:t}))(e,r);case"day":return 1===r?(e=>e.formatMessage({id:"YDw317",defaultMessage:"Yesterday"}))(e):((e,t)=>e.formatMessage({id:"jN1kbT",defaultMessage:"{value, plural, one{# day ago} other{# days ago}}"},{value:t}))(e,r);case"month":return 1===r?(e=>e.formatMessage({id:"aCaq4h",defaultMessage:"Last month"}))(e):((e,t)=>e.formatMessage({id:"RfkWNk",defaultMessage:"{value, plural, one{# month ago} other{# months ago}}"},{value:t}))(e,r)}},as={$props:c.atom({objectIdentifier:{".tag":"file",fileId:""},openLinkSettings:()=>{},onRequestClose:()=>{},onConfirmationModalShownChange:()=>{},onTransferFolderOwnership:()=>{},onChangeConfidentiality:()=>{},onObjectIdentifierChanged:()=>{},objectMetadataResult:{isLoading:!0},objectMembersResult:{isFirstPageLoaded:!1,isLoading:!0},listSharedLinksResult:{isLoading:!0},accountMetadataResult:{isLoading:!0},seenStateInfoResult:{isLoading:!0},customNoOtherMembersScreen:void 0}),$showSecurityBanner:c.atom(!1),$securityBannerType:c.atom(Wr.DowngradeAccess),$objectIdentifier:c.atom({".tag":"file",fileId:""}),$memberActionsInProgress:c.atom({}),$removeFileMemberFailureData:c.atom(null),$removeFileMemberWarningData:c.atom(null),$changeFileMemberAccessFailureData:c.atom(null),$changeFolderMemberAccessFailureData:c.atom(null),$removeFolderMemberFailureData:c.atom(null),$changeMemberAccessLevelData:c.atom(null),$removeMemberAccessLevelData:c.atom(null),$tempMemberAccessLevelData:c.atom(null),$objectMetadata:c.atom(void 0),$objectMembers:c.atom(void 0),$linksMetadata:c.atom(void 0),$accountMetadata:c.atom(void 0),$seenStateInfo:c.atom(void 0)},{StoreProvider:ns,useStore:rs}=c.defineStoreProvider((e=>{const t=c.store(!1),a=c.store(Wr.DowngradeAccess),n=c.store({}),r=c.store(null),s=c.store(null),o=c.store(null),i=c.store(null),l=c.store(null),d=c.store(null),u=c.store(null),m=c.store(null),g=c.store(void 0),_=c.store(void 0),p=c.store(void 0),f=c.store(void 0),E=c.store(void 0),b=c.store(e.get().objectIdentifier);return{$props:e,$showSecurityBanner:t,$securityBannerType:a,$objectIdentifier:b,$memberActionsInProgress:n,$removeFileMemberFailureData:r,$removeFileMemberWarningData:o,$changeFileMemberAccessFailureData:s,$changeFolderMemberAccessFailureData:i,$removeFolderMemberFailureData:l,$changeMemberAccessLevelData:d,$removeMemberAccessLevelData:u,$tempMemberAccessLevelData:m,$objectMetadata:g,$objectMembers:_,$linksMetadata:p,$accountMetadata:f,$seenStateInfo:E}}),as),ss=e=>{const t=a.useSharingObjectMetadata(e.objectIdentifier,!0),n=a.useObjectMembers(e.objectIdentifier,!1),r=ke(e.objectIdentifier),s=i.useSharingAccountInfo(),o=Ie(e.objectIdentifier);return y.createElement(ns,{objectMetadataResult:t,objectMembersResult:n,listSharedLinksResult:r,accountMetadataResult:s,seenStateInfoResult:o,...e})};ss.displayName="Provider";const os=()=>{const e=rs(),t=s.useIntl(),a=c.useAtom(e.$objectMetadata),n=c.useAtom(e.$objectMembers),r=c.useAtom(e.$linksMetadata),o=c.useAtom(e.$accountMetadata),l=c.useAtom(e.$seenStateInfo);return y.useMemo((()=>{if(!(a&&n&&r&&o&&l))throw u.reportStack("Resolved data for the Content Member List didn't load properly.",{severity:u.SEVERITY.CRITICAL,tags:["content-member-list"]}),i.fail(Jn(t)),new Error("Resolved data for the Content Member List is not loaded.");return{objectMetadata:a,objectMembers:n,linksMetadata:r,accountMetadata:o,seenStateInfo:l}}),[a,n,r,o,l,t])},is=()=>{const e=rs(),{objectMetadata:t,linksMetadata:n}=os(),r=s.useIntl(),o=c.useAtom(e.$showSecurityBanner),i=c.useAtom(e.$securityBannerType),{openLinkSettings:l}=c.useAtom(e.$props),d=n&&null!==a.getEditLinkMetadata(n),u=n&&null!==a.getViewLinkMetadata(n),m=()=>{e.$showSecurityBanner.set(!1)};if(!(a.getCanInvite(t,{".tag":"editor"})||a.getCanInvite(t,{".tag":"viewer"})))return y.createElement(ls,null);if(d&&o){let e;switch(i){case Wr.RemoveAccess:e=ar(r);break;case Wr.DowngradeAccess:default:e=(e=>e.formatMessage({id:"Sy/4UA",defaultMessage:"People who can view could still edit via link."}))(r)}return y.createElement(a.Box,{style:{marginBottom:"8px"}},y.createElement(cs,{header:e,transparentButtonLabel:nr(r),onClickOutlineButton:m,openLinkSettings:l}))}return u&&o&&i===Wr.RemoveAccess?y.createElement(a.Box,{style:{marginBottom:"8px"}},y.createElement(cs,{header:ar(r),transparentButtonLabel:nr(r),onClickOutlineButton:m,openLinkSettings:l})):null};is.displayName="ManageAccessDowngradeBanner";const ls=()=>{const e=s.useIntl(),t=i.useOpenUrl(),{objectMetadata:n,objectMembers:r,accountMetadata:o}=os(),l=i.getIsTeam(o)&&o.team_id===a.getOwnerTeamId(n),c=a.getOwnerTeamName(n),d=i.getIsTeamAdmin(o),u=a.getIsTeamSharedFolder(n),m=a.getIsFolder(n),g=()=>r.groups.some((e=>"team"===(e.group.group_type||{})[".tag"]&&Ur(e,{".tag":"make_editor"})&&Ur(e,{".tag":"make_viewer"})))&&null!=c?((e,t)=>e.formatMessage({id:"ifarDl",defaultMessage:"This folder is automatically shared with all members of {team_name}."},{team_name:t}))(e,c):l?d?((e,t)=>e.formatMessage({id:"9MdxEb",defaultMessage:"You can manage access in the admin console. <adminLink>Go to admin console</adminLink>"},{adminLink:e=>y.default.createElement(a.Button,{variant:"transparent",size:"small",onClick:()=>t("/team/admin/content/home")},e)}))(e,t):((e,t)=>e.formatMessage({id:"MSVH3B",defaultMessage:"Only admins and group managers can change team folder membership. <findAdminLink>Find admin</findAdminLink>"},{findAdminLink:e=>y.default.createElement(a.Button,{variant:"transparent",size:"small",onClick:()=>t("/team?_tk=left_nav_team")},e)}))(e,t):null!=c?((e,t)=>e.formatMessage({id:"ToMYBy",defaultMessage:"This folder can only be managed by the {ownerTeamName} team."},{ownerTeamName:t}))(e,c):(e=>e.formatMessage({id:"ReqZ5Y",defaultMessage:"This folder can only be managed by the owner team."}))(e),_=()=>m?(e=>e.formatMessage({id:"qQ/mzN",defaultMessage:"You don’t have permission to manage membership of this folder."}))(e):(e=>e.formatMessage({id:"+xrZUw",defaultMessage:"You don’t have permission to manage membership of this file."}))(e);return y.createElement(a.Banner,null,u?g():_())};ls.displayName="NoPermissionBanner";const cs=({header:e,onClickOutlineButton:t,openLinkSettings:n,transparentButtonLabel:r})=>{const o=s.useIntl();return y.createElement(a.Banner,{style:{padding:"12px"}},y.createElement(a.Box,{style:{display:"flex",flexDirection:"column",marginBottom:"8px"}},y.createElement(a.Text,null,e),y.createElement(a.Text,null,(e=>e.formatMessage({id:"ov3n4T",defaultMessage:"Delete the link to restrict access."}))(o))),y.createElement(a.Box,{style:{gap:"8px",display:"flex",flexDirection:"row",alignItems:"center"}},y.createElement(a.Button,{variant:"outline",onClick:t},y.createElement(a.Text,{size:"small",isBold:!0},(e=>e.formatMessage({id:"YCTkuR",defaultMessage:"Got It"}))(o))),y.createElement(a.Button,{variant:"transparent",onClick:()=>{n&&n({initialTab:"edit_link_settings"})}},y.createElement(a.Text,{size:"small",isBold:!0},r))))};cs.displayName="DowngradeBanner";const ds=i.define({name:"sharing.relinquishFolderMembership"},(e=>t=>i.handler(e.sharingRelinquishFolderMembership(t)))),us=i.define({name:"sharing.sharingCheckJobStatus"},(e=>t=>i.handler(e.sharingCheckJobStatus(t)))),ms=i.create({name:"CheckRelinquishFolderMembershipJobStatus"},(()=>{const e=i.useEndpoint(us);return y.useCallback((async({asyncJobId:t})=>{const a=await e({async_job_id:t});return"FATAL"===a.status?i.failure("NetworkFailure",{response:a}):"ERROR"===a.status?i.failure("ApiError",{response:a}):"in_progress"===a.output[".tag"]?i.success("InProgress",{response:{...a,output:a.output}}):"failed"===a.output[".tag"]?i.failure("Failed",{response:{...a,output:a.output}}):"complete"===a.output[".tag"]?i.success("Complete",{response:{...a,output:a.output}}):i.failureExhaustsAllTypes(a.output)}),[e])})),gs=i.create({name:"PollCheckRelinquishFolderMembershipJobStatus"},(()=>{const e=i.useAction(ms);return y.useCallback((async({asyncJobId:t,timeout:a,interval:n})=>{const r=await i.poll((async()=>{const a=await e({asyncJobId:t});return"InProgress"===a.type?{status:"RETRY"}:{status:"COMPLETE",output:a}}),{timeout:a,interval:n});return"TIMEOUT"===r.status?i.failure("Timeout",null):"ERROR"===r.status?i.failureUncaughtException(r.error):r.output.success?i.success("Complete",r.output.value):r.output}),[e])})),_s=i.create({name:"RelinquishFolderMembership"},(()=>{const e=i.useEndpoint(ds),t=i.useAction(gs);return y.useCallback((async({relinquishFolderMembershipArg:a,timeout:n,interval:r})=>{const s=await e(a);if("ERROR"===s.status)return i.failure("ApiError",{response:s});if("FATAL"===s.status)return i.failure("NetworkFailure",{response:s});if("complete"===s.output[".tag"])return i.success("Complete",{response:{...s,output:s.output}});if("async_job_id"!==s.output[".tag"])return i.failureExhaustsAllTypes(s.output);const o=await t({asyncJobId:s.output.async_job_id,timeout:n,interval:r});return o.success?i.success("PollingComplete",o.value):"ApiError"===o.type?i.failure("PollingApiError",o.value):"NetworkFailure"===o.type?i.failure("PollingNetworkFailure",o.value):"Failed"===o.type?i.failure("PollingFailed",o.value):"Timeout"===o.type?i.failure("PollingTimeout",o.value):o}),[e,t])})),ps=i.define({name:"sharing.removeFolderMember"},(e=>t=>i.handler(e.sharingRemoveFolderMemberV2(t)))),fs=i.define({name:"sharing.checkRemoveMemberJobStatus"},(e=>t=>i.handler(e.sharingCheckRemoveMemberJobStatus(t)))),Es=i.create({name:"CheckRemoveFolderMemberJobStatus"},(()=>{const e=i.useEndpoint(fs);return y.useCallback((async({asyncJobId:t})=>{const a=await e({async_job_id:t});return"FATAL"===a.status?i.failure("NetworkFailure",{response:a}):"ERROR"===a.status?i.failure("ApiError",{response:a}):"in_progress"===a.output[".tag"]?i.success("InProgress",{response:{...a,output:a.output}}):"failed"===a.output[".tag"]?i.failure("Failed",{response:{...a,output:a.output}}):"complete"===a.output[".tag"]?i.success("Complete",{response:{...a,output:a.output}}):i.failureExhaustsAllTypes(a.output)}),[e])})),bs=i.create({name:"PollCheckRemoveFolderMemberJobStatus"},(()=>{const e=i.useAction(Es);return y.useCallback((async({asyncJobId:t,timeout:a,interval:n})=>{const r=await i.poll((async()=>{const a=await e({asyncJobId:t});return"InProgress"===a.type?{status:"RETRY"}:{status:"COMPLETE",output:a}}),{timeout:a,interval:n});return"TIMEOUT"===r.status?i.failure("Timeout",null):"ERROR"===r.status?i.failureUncaughtException(r.error):r.output.success?i.success("Complete",r.output.value):r.output}),[e])})),hs=i.create({name:"RemoveFolderMember"},(()=>{const e=i.useEndpoint(ps),t=i.useAction(bs);return y.useCallback((async({removeFolderMemberArg:a,timeout:n,interval:r})=>{const s=await e(a);if("ERROR"===s.status)return i.failure("ApiError",{response:s});if("FATAL"===s.status)return i.failure("NetworkFailure",{response:s});const o=await t({asyncJobId:s.output.async_job_id,timeout:n,interval:r});return o.success?i.success("PollingComplete",o.value):"ApiError"===o.type?i.failure("PollingApiError",o.value):"NetworkFailure"===o.type?i.failure("PollingNetworkFailure",o.value):"Failed"===o.type?i.failure("PollingFailed",o.value):"Timeout"===o.type?i.failure("PollingTimeout",o.value):o}),[e,t])})),Ms=i.define({name:"sharing.getParentFolderAccess"},(e=>t=>i.handler(e.sharingGetParentFolderAccess(t)))),Ss=i.define({name:"sharing.relinquishFileMembership"},(e=>t=>i.handler(e.sharingRelinquishFileMembership(t)))),vs=i.define({name:"sharing.removeFileMember2"},(e=>t=>i.handler(e.sharingRemoveFileMember2(t)))),ys=i.define({name:"sharing.transferFolder"},(e=>t=>i.handler(e.sharingTransferFolderV2(t)))),As=i.define({name:"sharing.updateFileMember"},(e=>t=>i.handler(e.sharingUpdateFileMember(t)))),Cs=i.define({name:"sharing.updateFolderMember"},(e=>t=>i.handler(e.sharingUpdateFolderMemberV2(t)))),Is=e=>{const t=rs(),a=Br();return y.useCallback((n=>{a.select(wr).emit({memberActionType:e,prevAccessLevel:n.access_type});const r=qr(n),s=t.$memberActionsInProgress.get();t.$memberActionsInProgress.set({...s,[i.getUniqueId(r)]:!0})}),[a,e,t.$memberActionsInProgress])},Ts=e=>{const t=rs(),n=Br();return y.useCallback((async(r,s)=>{n.select(xr).emit({memberActionType:e});const o=t.$memberActionsInProgress.get(),l=qr(r),c={...o};delete c[i.getUniqueId(l)],await a.invalidateObjectMembers(s),window.requestAnimationFrame((()=>{t.$memberActionsInProgress.set({...c})}))}),[n,e,t.$memberActionsInProgress])},Ls=()=>{const e=s.useIntl();return y.useCallback((()=>{i.fail((e=>e.formatMessage({id:"xn+a8/",defaultMessage:"An unexpected error has occurred."}))(e))}),[e])},Rs=()=>{const e=rs();return y.useCallback((t=>{e.$props.get().onConfirmationModalShownChange(t)}),[e])},Ns=()=>{const e=rs(),t=i.useLogger(),a=i.useAction(i.action);return y.useCallback((async({sharedFolderId:n,inProgressMessage:r,setToConfidential:s,keepInheritedMembers:o=!1})=>{e.$props.get().onChangeConfidentiality(),i.inProgress(r),t("SHARE_MODAL_MANAGE_ACCESS__SET_ACCESS_INHERITANCE__API_START",null);const l=await a({setAccessInheritanceArg:{shared_folder_id:n,access_inheritance:s?{".tag":"no_inherit"}:{".tag":"inherit"},keep_inherited_members:s?o:void 0},timeout:12e4,interval:1e3});return l.success?t("SHARE_MODAL_MANAGE_ACCESS__SET_ACCESS_INHERITANCE__API_SUCCESS",null):t("SHARE_MODAL_MANAGE_ACCESS__SET_ACCESS_INHERITANCE__API_FAILURE",{output:l}),l}),[e.$props,t,a])},ks=()=>{const e=rs(),t=i.useLogger(),a=c.useAtom(e.$objectIdentifier),n=i.useAction(i.action$1);return y.useCallback((async({onStart:e,onInProgress:r,onCancel:s,onSuccess:o,onError:i,setToConfidential:l})=>{if(t("SHARE_MODAL_MANAGE_ACCESS__SHARE_FILE_FOLDER__API_START",null),e(),"file_folder"!==a[".tag"])return i(),null;r();const c=void 0!==l?l?{".tag":"confidential"}:{".tag":"not_confidential"}:void 0,d=await n({path:a.path,timeout:12e4,interval:1e3,confidentiality:c});if(!d.success)return"ApiError"===d.type&&"bad_path"===d.value.response.error[".tag"]&&"already_shared"===d.value.response.error.bad_path[".tag"]&&d.value.response.error.bad_path.shared_folder_id?(t("SHARE_MODAL_MANAGE_ACCESS__SHARE_FILE_FOLDER__API_FAILURE",{output:d}),d.value.response.error.bad_path.shared_folder_id):(t("SHARE_MODAL_MANAGE_ACCESS__SHARE_FILE_FOLDER__API_FAILURE",{output:d}),s(),i(),null);t("SHARE_MODAL_MANAGE_ACCESS__SHARE_FILE_FOLDER__API_SUCCESS",null);const u=d.value.response.output.shared_folder_id;return o(u),u}),[t,a,n])},ws=()=>{const e=rs(),t=c.useAtom(e.$objectIdentifier),a=Ls(),n=ks(),r=Is("share_folder"),s=Ts("share_folder"),o=(()=>{const e=Br();return y.useCallback((()=>{e.select(Dr).emit({memberActionType:"share_folder"})}),[e])})();return y.useCallback((async(e,l)=>await n({onStart:()=>{r(e)},onInProgress:()=>{i.inProgress(l)},onCancel:()=>{s(e,t)},onSuccess:()=>{o()},onError:()=>{a()}})),[n,r,s,t,o,a])},xs=()=>{const e=rs(),{objectMetadata:t}=os(),n=i.useLogger(),r=s.useIntl(),o=c.useAtom(e.$objectIdentifier),{onObjectIdentifierChanged:l}=c.useAtom(e.$props),d=Ls(),u=ws(),m=Ns(),g=i.useEndpoint(As),_=i.useEndpoint(Cs),p=i.useEndpoint(Ms),f=Ts("change_member_access"),E=(()=>{const e=rs(),t=Br();return y.useCallback((async(n,r,s)=>{t.select(Dr).emit({memberActionType:"change_member_access",newAccessLevel:s});const o=e.$memberActionsInProgress.get(),l=qr(n),d={...o};delete d[i.getUniqueId(l)],c.batch((()=>{e.$tempMemberAccessLevelData.set({accessLevel:s,member:l}),e.$memberActionsInProgress.set(d)})),await a.invalidateObjectMembers(r)}),[t,e.$memberActionsInProgress,e.$tempMemberAccessLevelData])})(),b=Is("change_member_access");return y.useCallback((async(s,c,h)=>{var M;const S=h.is_inherited&&"viewer"===s[".tag"]&&"viewer"!==(null===(M=h.inherited_access_type)||void 0===M?void 0:M[".tag"]);if(b(h),t&&a.getIsFile(t)){const l=qr(h),c={file:a.isNewApiMetadata(t)?"":t.id,member:l,access_level:s};n("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_START",null),S||i.inProgress(lr(r));const u=await g(c);"SUCCESS"===u.status?(n("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_SUCCESS",{response:u}),u.output.access_level&&u.output.access_level!==s?(f(h,o),e.$changeFileMemberAccessFailureData.set({error:u.output,member:l})):(E(h,o,s),i.complete(cr(r)))):("ERROR"===u.status?(i.fail(dr(r)),n("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_ERROR",{response:u})):n("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_FATAL",{response:u}),f(h,o),d())}else if(t&&(a.getIsSharedFolder(t)||a.getIsNonSharedFolder(t)&&c)){const g=t.name;let p=a.getIsNonSharedFolder(t)?null:t.shared_folder_id;if(a.getIsNonSharedFolder(t)&&(p=await u(h,ur(r,g))),!p)return void a.invalidateSharingObjectMetadata(o);const b={".tag":"shared_folder",sharedFolderId:p,fileId:o.fileId};if(l(b),c){if(!(await m({sharedFolderId:p,inProgressMessage:ur(r,g),setToConfidential:!0,keepInheritedMembers:!0})).success)return void i.fail(mr(r));a.invalidateSharingObjectMetadata(b)}n("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_START",null),S||i.inProgress(lr(r));const M=qr(h),v=await _({shared_folder_id:p,member:M,access_level:s});"SUCCESS"===v.status?(n("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_SUCCESS",{response:v}),v.output.access_level&&v.output.access_level!==s?(a.invalidateObjectMembers(b),f(h,b),e.$changeMemberAccessLevelData.set({data:v.output||[],member:M})):(E(h,b,s),i.complete(cr(r)))):"ERROR"===v.status?(n("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_ERROR",{response:v}),i.fail(dr(r)),e.$changeFolderMemberAccessFailureData.set({error:v.error,member:M}),f(h,b)):(n("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_FATAL",{response:v}),f(h,b),d(),i.fail(mr(r)))}else if(t&&a.getIsNonSharedFolder(t)){if("viewer"===s[".tag"]){n("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_START",null);const a=qr(h),r=await p({shared_folder_id:t.parent_shared_folder_id||"",member:a,access_level:s});return void("SUCCESS"===r.status?(n("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_SUCCESS",{response:r}),e.$changeMemberAccessLevelData.set({member:a,data:r.output})):("ERROR"===r.status?n("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_ERROR",{response:r}):n("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_FATAL",{response:r}),d()))}const c=await u(h,lr(r));if(!c)return void a.invalidateSharingObjectMetadata(o);const m={".tag":"shared_folder",sharedFolderId:c};l(m),n("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_START",null);const g=qr(h),b=await _({shared_folder_id:c||"",member:g,access_level:s});"SUCCESS"===b.status?(n("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_SUCCESS",{response:b}),b.output.access_level&&b.output.access_level!==s?(f(h,m),e.$changeMemberAccessLevelData.set({data:b.output||[],member:g})):(E(h,m,s),i.complete(cr(r)))):("ERROR"===b.status?n("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_ERROR",{response:b}):n("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_FATAL",{response:b}),f(h,m),d(),i.fail(mr(r)))}}),[b,t,n,g,r,f,o,e,E,d,l,_,u,m,p])},Ds=()=>{const e=rs(),{objectMetadata:t}=os(),n=i.useLogger(),r=s.useIntl(),o=i.useEndpoint(Ss),l=i.useAction(_s),d=c.useAtom(e.$objectIdentifier),{onObjectIdentifierChanged:u}=c.useAtom(e.$props),m=ws(),g=Ns(),_=Ls(),p=Is("relinquish_folder_membership"),f=Ts("relinquish_folder_membership"),E=(()=>{const e=rs(),t=Br();return y.useCallback((async()=>{t.select(Dr).emit({memberActionType:"relinquish_folder_membership"}),e.$props.get().onRequestClose()}),[t,e.$props])})();return y.useCallback((async(e,s,c)=>{if(t&&a.getIsFile(t)){p(e),n("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_START",null);const r=await o({file:a.isNewApiMetadata(t)?"":t.id});f(e,d),"SUCCESS"===r.status?(n("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_SUCCESS",{response:r}),E()):("ERROR"===r.status?n("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_ERROR",{response:r}):n("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_FATAL",{response:r}),_())}if(t&&(a.getIsSharedFolder(t)||a.getIsNonSharedFolder(t)&&s)){const o=a.getName(t);let b=a.getIsNonSharedFolder(t)?null:t.shared_folder_id;if(a.getIsNonSharedFolder(t)&&(b=await m(e,or(r,o))),!b)return;const h={".tag":"shared_folder",sharedFolderId:b,fileId:d.fileId};if(u(h),s){if(!(await g({sharedFolderId:b,inProgressMessage:or(r,o),setToConfidential:!0,keepInheritedMembers:!0})).success)return f(e,h),_(),void i.fail(sr(r));a.invalidateSharingObjectMetadata(h)}if(null!==b&&void 0!==c){p(e),n("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_START",null);const t=await l({relinquishFolderMembershipArg:{shared_folder_id:b,leave_a_copy:c},timeout:12e4,interval:1e3});f(e,h),t.success?(n("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_SUCCESS",null),E(),i.complete(ir(r,o))):(n("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_FAILURE",{output:t}),_(),i.fail(sr(r)))}}}),[t,p,n,o,f,d,E,_,u,m,r,g,l])},Ps=()=>{const e=rs(),{objectMetadata:t}=os(),n=i.useLogger(),r=s.useIntl(),o=i.useEndpoint(vs),l=i.useEndpoint(Ms),d=i.useAction(hs),u=c.useAtom(e.$objectIdentifier),{onObjectIdentifierChanged:m}=c.useAtom(e.$props),g=ws(),_=Ns(),p=Ls(),f=Ts("remove_member"),E=Is("remove_member"),b=(()=>{const e=rs(),t=Br();return y.useCallback((async(n,r)=>{t.select(Dr).emit({memberActionType:"remove_member"});const s=qr(n),o={...e.$memberActionsInProgress.get()};delete o[i.getUniqueId(s)],await a.invalidateObjectMembers(r),window.requestAnimationFrame((()=>{e.$memberActionsInProgress.set(o)}))}),[t,e.$memberActionsInProgress])})();return y.useCallback((async(s,c,h,M)=>{const S=qr(s);if(t&&a.getIsFile(t)){E(s),n("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_START",null);const r=await o({file:a.isNewApiMetadata(t)?"":t.id,member:S});"SUCCESS"===r.status?n("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_SUCCESS",{response:r}):"ERROR"===r.status?n("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_ERROR",{response:r}):n("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_FATAL",{response:r}),"SUCCESS"===r.status?"success"===r.output[".tag"]&&r.output.access_level?(f(s,u),e.$removeFileMemberWarningData.set({error:r.output,member:S})):b(s,u):"ERROR"===r.status&&"no_explicit_access"===r.error[".tag"]?(f(s,u),e.$removeFileMemberFailureData.set({error:r.error,member:S})):(f(s,u),p())}if(t&&(a.getIsSharedFolder(t)||a.getIsNonSharedFolder(t)&&c)){let o=a.getIsNonSharedFolder(t)?null:t.shared_folder_id;const l=a.getName(t);if(a.getIsNonSharedFolder(t)&&(o=await g(s,h?gr(r,l):or(r,l))),!o)return;const v={".tag":"shared_folder",sharedFolderId:o,fileId:u.fileId};if(m(v),c){if(!(await _({sharedFolderId:o,inProgressMessage:h?gr(r,l):or(r,l),setToConfidential:!0,keepInheritedMembers:!0})).success)return f(s,v),p(),void i.fail(h?_r(r):sr(r))}if(null!==o&&void 0!==M){E(s),n("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_START",null);const t=await d({removeFolderMemberArg:{shared_folder_id:o,member:S,leave_a_copy:M},timeout:12e4,interval:1e3});if(t.success){if(n("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_SUCCESS",null),"complete"===t.value.response.output[".tag"]&&t.value.response.output.access_level)return f(s,v),void e.$removeMemberAccessLevelData.set({member:S,data:t.value.response.output});b(s,v),i.complete(h?((e,t)=>e.formatMessage({id:"yqWm25",defaultMessage:"Members removed from <b>{currentFolder}</b>."},{currentFolder:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e)}))(r,l):ir(r,l))}else"ApiError"===t.type?(n("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_FAILURE",{output:t}),e.$removeFolderMemberFailureData.set({error:t.value.response.error,member:S}),f(s,v)):(n("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_FAILURE",{output:t}),f(s,v),p(),i.fail(h?_r(r):sr(r)))}}else if(t&&a.getIsNonSharedFolder(t)){n("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_START",null);const a=await l({shared_folder_id:t.parent_shared_folder_id||"",member:S});"SUCCESS"===a.status?(n("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_SUCCESS",{response:a}),e.$removeMemberAccessLevelData.set({member:S,data:a.output})):("ERROR"===a.status?n("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_ERROR",{response:a}):n("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_FATAL",{response:a}),p())}}),[t,E,n,o,f,u,e,b,p,m,g,r,_,d,l])},$s=()=>{const e=rs(),{objectMetadata:t}=os(),n=i.useLogger(),r=i.useEndpoint(ys),o=Ls(),l=s.useIntl(),d=c.useAtom(e.$objectIdentifier),u=Is("transfer_folder_ownership"),m=Ts("transfer_folder_ownership"),g=(()=>{const e=rs(),t=Br();return y.useCallback((async()=>{t.select(Dr).emit({memberActionType:"transfer_folder_ownership"}),await e.$props.get().onTransferFolderOwnership()}),[t,e.$props])})();return y.useCallback((async(e,s,c)=>{if(!t||t&&!a.getIsSharedFolder(t))throw new Error("Unsupported file type.");u(s),n("SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_START",null);const _=await r({shared_folder_id:a.isNewApiMetadata(t)?"":t.shared_folder_id,to_dropbox_id:e});"SUCCESS"===_.status?(n("SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_SUCCESS",null),await g(),i.complete(((e,t)=>e.formatMessage({id:"BNpXMo",defaultMessage:"Made {displayName} the owner."},{displayName:t}))(l,c))):(m(s,d),"ERROR"===_.status?n("SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_ERROR",{response:_}):"FATAL"===_.status&&n("SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_FATAL",{response:_}),o())}),[t,u,n,r,m,d,g,l,o])},Os=()=>{const e=rs(),{objectMetadata:t}=os(),n=s.useIntl(),r=c.useAtom(e.$objectIdentifier),{onObjectIdentifierChanged:o}=c.useAtom(e.$props),l=Ls(),d=(()=>{const e=Br();return y.useCallback((()=>{e.select(Pr).emit({memberActionType:"remove_all_inherited_members"})}),[e])})(),u=(()=>{const e=Br();return y.useCallback((()=>{e.select($r).emit({memberActionType:"remove_all_inherited_members"})}),[e])})(),m=(()=>{const e=rs(),t=Br();return y.useCallback((async(n,r=!1)=>{r||t.select(Or).emit({memberActionType:"remove_all_inherited_members"}),await a.invalidateObjectMembers(n),e.$props.get().onChangeConfidentiality()}),[t,e.$props])})(),g=ks(),_=Ns();return y.useCallback((async s=>{if(!t)return l(),null;const c=async()=>{const a=e.$objectIdentifier.get();if("shared_folder"!==a[".tag"])return;(await _({sharedFolderId:a.sharedFolderId,inProgressMessage:Yn(n,!1,t),setToConfidential:!1})).success?(i.complete(Xn(n,!1,t)),m(a,!0)):i.fail(Kn(n,!1))};if("shared_folder"===r[".tag"]){d();return(await _({sharedFolderId:r.sharedFolderId,inProgressMessage:Yn(n,s,t),setToConfidential:!0,keepInheritedMembers:!1})).success?(i.completeWithUndo({title:Xn(n,s,t),onUndoClick:c}),await a.invalidateObjectMembers(r),m(r)):(i.fail(Kn(n,!0)),u()),r.sharedFolderId}{const s=s=>{i.completeWithUndo({title:Xn(n,!0,t),onUndoClick:c});const l={".tag":"shared_folder",sharedFolderId:s};e.$objectIdentifier.set(l),o(l),a.invalidateSharingObjectMetadata(r),m(l)},l=()=>{i.inProgress(Yn(n,!0,t))},_=()=>{i.fail(Kn(n,!0))};return await g({onStart:()=>{d()},onInProgress:l,onCancel:()=>{u()},onSuccess:s,onError:_,setToConfidential:!0})}}),[t,r,l,e.$objectIdentifier,_,n,d,m,u,g,o])},Fs=({isOpen:e,onClose:t})=>{const{objectMetadata:n}=os(),r=Br(),o=s.useIntl(),l=i.usePlatform()!==i.Platforms.DESKTOP,c=Rs(),d=Os();if(y.useEffect((()=>{c(e)}),[e,c]),y.useEffect((()=>{e&&r.select(kr).emit(null)}),[e,r]),!e)return null;const u=a.getName(n),m=a.getParentFolderName(n);return y.createElement(y.Fragment,null,y.createElement(a.Modal$1,{open:e,isCentered:!0,withCloseButton:l?rr(o):void 0,onRequestClose:()=>{t()}},y.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},y.createElement(a.Modal$1.Title,null,((e,t)=>e.formatMessage({id:"V8posb",defaultMessage:"Remove members of “{parentFolderName}” folder?"},{parentFolderName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.FOLDER_NAME)}))(o,m))),y.createElement(a.Modal$1.Body,null,((e,t,n)=>e.formatMessage({id:"YMtvO3",defaultMessage:"Members of <b>{parentFolderName}</b> folder won’t be able to access <b>{folderName}</b>."},{parentFolderName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.FOLDER_NAME),folderName:i.Emstring.em_snippet(n,a.SNIPPET_SIZES.FOLDER_NAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e)}))(o,m,u)),y.createElement(a.Modal$1.Footer,null,y.createElement(a.Button,{variant:"opacity",onClick:()=>{t()}},(e=>e.formatMessage({id:"JJWPQC",defaultMessage:"Cancel"}))(o)),y.createElement(a.Button,{variant:"primary",onClick:()=>{t(),d(!0)}},(e=>e.formatMessage({id:"0BoZ69",defaultMessage:"Remove"}))(o)))))};Fs.displayName="RemoveAllInheritedMembersConfirmationModal";const Bs=e=>{if("member_error"===e[".tag"]){const t=e.member_error;if("no_explicit_access"===t[".tag"]){return t.access_details||[]}}return[]},js=e=>{const{intl:t,folderName:n,folderPath:r,role:s,isPaired:o,onManageAccessClicked:i}=e,l=((e,t)=>e?`/${t}`:"/home")(o,s),c=`${l}${r}?share_manage_access=true`;return y.createElement(a.Menu.Row,{preferComposition:!0,style:{height:"57px",alignItems:"center"}},y.createElement(a.Menu.RowAccessory,null,y.createElement(S.FolderSharedDefaultSmall,null)),y.createElement(a.Menu.RowContent,null,y.createElement(a.Truncate,{location:.5},y.createElement(a.Menu.RowTitle,null,n))),y.createElement(a.Menu.RowAccessory,null,y.createElement(a.Button,{variant:"transparent",onClick:()=>{i(c)},size:"small"},(e=>e.formatMessage({id:"Ca+R4I",defaultMessage:"Manage Access"}))(t))))},Us=e=>{const t=rs(),a=Rs(),n=Ts("change_member_access"),r=c.useAtom(t.$props).objectIdentifier;return y.useCallback((()=>{t.$changeFileMemberAccessFailureData.set(null),t.$changeFolderMemberAccessFailureData.set(null),t.$changeMemberAccessLevelData.set(null),a(!1),n(e,r)}),[e,r,a,n,t])},Vs=({member:e})=>{var t;const n=rs(),r=Br(),o=s.useIntl(),{objectMetadata:l}=os(),d=c.useAtom(n.$changeFileMemberAccessFailureData),u=Vr(e),m=i.usePlatform()!==i.Platforms.DESKTOP,g=y.useRef(!1),_=d&&d.error.access_details;y.useEffect((()=>{g.current||_&&(g.current=!0,r.select(Lr).emit(null))}),[_,r]);const p=Us(e),f=Rs();if(!_)return null;const E=d.error.access_details,b=E?E[0]:void 0;return f(!0),b?y.createElement(a.Modal$1,{open:!0,isCentered:!0,withCloseButton:m?rr(o):void 0,onRequestClose:p},y.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},y.createElement(a.Modal$1.Title,null,br(o,u))),y.createElement(a.Modal$1.Body,null,hr(o,null!==(t=null==E?void 0:E.length)&&void 0!==t?t:0,a.getName(l),b.folder_name)),y.createElement(a.Modal$1.Footer,null,y.createElement(a.Button,{variant:"primary",onClick:p},Mr(o)))):y.createElement(a.Modal$1,{open:!0,isCentered:!0,withCloseButton:m?rr(o):void 0,onRequestClose:p},y.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},y.createElement(a.Modal$1.Title,null,Er(o,u))),y.createElement(a.Modal$1.Body,null,fr(o,u,a.getName(l))),y.createElement(a.Modal$1.Footer,null))};Vs.displayName="NoExplicitAccessOnAccessChangeModal";const Hs=({member:e})=>{const t=rs(),n=s.useIntl(),r=Br(),{objectMetadata:o,accountMetadata:l}=os(),d=c.useAtom(t.$changeFolderMemberAccessFailureData),u=c.useAtom(t.$changeMemberAccessLevelData),m=(()=>{const e=i.useOpenUrl();return y.useCallback((t=>e(t)),[e])})(),g=Us(e),_=Vr(e),p=i.usePlatform()!==i.Platforms.DESKTOP,f=y.useRef(!1),E=d||u,b=qr(e),h=(null==u?void 0:u.member)||(null==d?void 0:d.member),M=i.getAreMemberSelectorsEqual(h,b);if(y.useEffect((()=>{const e=E&&M;f.current||e&&(f.current=!0,r.select(Lr).emit(null))}),[E,M,r]),!E)return null;if(!M)return null;const S=d?Bs(d.error):(null==u?void 0:u.data.access_details)||[];if(!(0!==S.length))return y.createElement(a.Modal$1,{open:!0,isCentered:!0,withCloseButton:p?rr(n):void 0,onRequestClose:g},y.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},y.createElement(a.Modal$1.Title,null,Er(n,_))),y.createElement(a.Modal$1.Body,null,fr(n,_,a.getName(o))),y.createElement(a.Modal$1.Footer,null,y.createElement(a.Button,{variant:"opacity",onClick:g},Sr(n))));const v=hr(n,S.length,a.getName(o),S[0].folder_name);return y.createElement(a.Modal$1,{open:!0,isCentered:!0,withCloseButton:p?rr(n):void 0,onRequestClose:g},y.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},y.createElement(a.Modal$1.Title,null,br(n,_))),y.createElement(a.Modal$1.Body,null,v,y.createElement(a.Box,{style:{height:"100%",maxHeight:"150px",border:"1px solid #DFDCD8",borderRadius:"5px",overflow:"auto",marginTop:"var(--spacing__unit--3)"}},S.slice(0,15).map(((e,t)=>y.createElement(js,{key:t,intl:n,folderName:e.folder_name,folderPath:e.path,onManageAccessClicked:m,role:l.role,isPaired:l.is_paired}))))),y.createElement(a.Modal$1.Footer,null,y.createElement(a.Button,{variant:"opacity",onClick:g},Sr(n))))};Hs.displayName="ParentFolderAccessModal";const qs=e=>{const t=rs(),a=Rs(),n=Ts("remove_member"),r=c.useAtom(t.$objectIdentifier);return y.useCallback((()=>{t.$removeFileMemberFailureData.set(null),t.$removeFileMemberWarningData.set(null),t.$removeFolderMemberFailureData.set(null),t.$removeMemberAccessLevelData.set(null),a(!1),n(e,r)}),[e,r,a,n,t])},Ws=({member:e})=>{var t,n,r,o;const l=rs(),{objectMetadata:d}=os(),u=s.useIntl(),m=Br(),g=c.useAtom(l.$removeFileMemberFailureData),_=c.useAtom(l.$removeFileMemberWarningData),p=qs(e),f=Vr(e),E=Rs(),b=i.usePlatform()!==i.Platforms.DESKTOP,h=y.useRef(!1),M=g||_,S="no_explicit_access"===(null===(t=null==g?void 0:g.error)||void 0===t?void 0:t[".tag"])&&("success"!==(null===(n=null==_?void 0:_.error)||void 0===n?void 0:n[".tag"])||null!=(null===(r=null==_?void 0:_.error)||void 0===r?void 0:r.access_details));let v=null;"success"===(null==_?void 0:_.error[".tag"])?v=_.error.access_details||[]:g&&"no_explicit_access"===g.error[".tag"]&&(v=g.error.access_details||[]);const A=null!=v;if(y.useEffect((()=>{const e=M&&S&&A;h.current||e&&(h.current=!0,m.select(Tr).emit(null))}),[m,h,M,S,A]),!M)return null;if(!S)return null;if(!A)return null;const C=v?v[0]:null;return E(!0),C?y.createElement(a.Modal$1,{open:!0,isCentered:!0,withCloseButton:b?rr(u):void 0,onRequestClose:p},y.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},y.createElement(a.Modal$1.Title,null,vr(u,f))),y.createElement(a.Modal$1.Body,null,Ar(u,null!==(o=null==v?void 0:v.length)&&void 0!==o?o:0,a.getName(d),C.folder_name)),y.createElement(a.Modal$1.Footer,null,y.createElement(a.Button,{variant:"primary",onClick:p},Mr(u)))):y.createElement(a.Modal$1,{open:!0,isCentered:!0,withCloseButton:b?rr(u):void 0,onRequestClose:p},y.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},y.createElement(a.Modal$1.Title,null,vr(u,f))),y.createElement(a.Modal$1.Body,null,yr(u,f,a.getName(d))),y.createElement(a.Modal$1.Footer,null,y.createElement(a.Button,{variant:"primary",onClick:p},Mr(u))))};Ws.displayName="NoExplicitAccessOnRemoveModal";const zs=({member:e})=>{const t=rs(),{objectMetadata:n,accountMetadata:r}=os(),o=s.useIntl(),l=Br(),d=c.useAtom(t.$removeMemberAccessLevelData),u=c.useAtom(t.$removeFolderMemberFailureData),m=(()=>{const e=i.useOpenUrl();return y.useCallback((t=>e(t)),[e])})(),g=qs(e),_=Vr(e),p=i.usePlatform()!==i.Platforms.DESKTOP,f=y.useRef(!1),E=u||d;if(y.useEffect((()=>{if(!f.current){E&&(f.current=!0,l.select(Tr).emit(null))}}),[l,E]),!E)return null;const b=u?Bs(u.error):(null==d?void 0:d.data.access_details)||[];if(!(0!==b.length))return y.createElement(a.Modal$1,{open:!0,isCentered:!0,withCloseButton:p?rr(o):void 0,onRequestClose:g},y.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},y.createElement(a.Modal$1.Title,null,vr(o,_))),y.createElement(a.Modal$1.Body,null,yr(o,_,a.getName(n))),y.createElement(a.Modal$1.Footer,null,y.createElement(a.Button,{variant:"opacity",onClick:g},Sr(o))));const h=Ar(o,b.length,a.getName(n),b[0].folder_name);return y.createElement(a.Modal$1,{open:!0,isCentered:!0,withCloseButton:p?rr(o):void 0,onRequestClose:g},y.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},y.createElement(a.Modal$1.Title,null,vr(o,_))),y.createElement(a.Modal$1.Body,null,h,y.createElement("div",{style:{height:"100%",maxHeight:"150px",border:"1px solid #DFDCD8",borderRadius:"5px",overflow:"auto",marginTop:"var(--spacing__unit--3)"}},b.slice(0,15).map(((e,t)=>y.createElement(js,{key:t,intl:o,folderName:e.folder_name,folderPath:e.path,onManageAccessClicked:m,role:r.role,isPaired:r.is_paired}))))),y.createElement(a.Modal$1.Footer,null,y.createElement(a.Button,{variant:"opacity",onClick:g},Sr(o))))};zs.displayName="ParentFolderAccessModal";var Gs;!function(e){e[e.RemoveAccess=0]="RemoveAccess",e[e.DowngradeAccess=1]="DowngradeAccess"}(Gs||(Gs={}));var Zs;!function(e){function t(e){return e.startsWith("dbafvid:")}e.isAnonymousUserId=t,e.isAnonymousSeenState=e=>t(e.seen_state_user.user_id)}(Zs||(Zs={}));const Qs=({isOpen:e,member:t,selectedAccessLevel:n,onClose:r})=>{const o=Br(),l=s.useIntl(),c=i.usePlatform()!==i.Platforms.DESKTOP,{user:d}=a.useActiveUser(),u=Rs(),m=xs(),g=Ds(),_=Ps(),{objectMetadata:p}=os();y.useEffect((()=>{u(e)}),[e,u]);const f=y.useRef(!1);if(y.useEffect((()=>{f.current||e&&(f.current=!0,o.select(Rr).emit(null))}),[e,o]),!e)return null;const E=Hr(t,d),b=a.getName(p),h=a.getParentFolderName(p),M=a.getOwnerTeamName(p),S=""===h,v=E,A="remove"!==n,C=(e=>{let t="";return"user"in e&&void 0!==e.user&&(t=e.user.display_name),"group"in e&&void 0!==e.group&&(t=e.group.group_name),"invitee"in e&&void 0!==e.invitee&&"email"==e.invitee[".tag"]&&(t=e.invitee.email),t})(t),I=Ys(l,A,S),T=Ks(l,M,b,h,v,A,S),L=Js(l,M,b,h,C,v,A,S);return y.createElement(y.Fragment,null,y.createElement(a.Modal$1,{open:e,isCentered:!0,withCloseButton:c?rr(l):void 0,onRequestClose:()=>{r()}},y.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},y.createElement(a.Modal$1.Title,null,T)),y.createElement(a.Modal$1.Body,null,L),y.createElement(a.Modal$1.Footer,null,y.createElement(a.Button,{variant:"opacity",onClick:()=>{r()}},(e=>e.formatMessage({id:"TnNYmK",defaultMessage:"Cancel"}))(l)),y.createElement(a.Button,{variant:"primary",onClick:()=>{r();const e="group"in t&&void 0!==t.group;if(A){m({".tag":n},!0,t)}else v?g(t,!0,!1):_(t,!0,e,!1)}},I))))};Qs.displayName="ChangeInheritanceConfirmationModal";const Ys=(e,t,a)=>t?(e=>e.formatMessage({id:"Mq03yj",defaultMessage:"Change access"}))(e):a?(e=>e.formatMessage({id:"PjD4Vl",defaultMessage:"Remove everyone"}))(e):(e=>e.formatMessage({id:"poGJG/",defaultMessage:"Remove"}))(e),Ks=(e,t,n,r,s,o,l)=>s?((e,t)=>e.formatMessage({id:"gODx5K",defaultMessage:"Remove yourself from <b>{parentFolderName}</b>?"},{parentFolderName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.FOLDER_NAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e)}))(e,r):o?((e,t)=>e.formatMessage({id:"gBVsYr",defaultMessage:"Change how members can access “{currentFolder}”?"},{currentFolder:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}))(e,n):l?t?((e,t)=>e.formatMessage({id:"n/U4N5",defaultMessage:"Remove everyone at “{teamName}”?"},{teamName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}))(e,t):(e=>e.formatMessage({id:"u5fnTi",defaultMessage:"Remove everyone on your team?"}))(e):((e,t)=>e.formatMessage({id:"Ca5nCo",defaultMessage:"Remove a member of “{parentFolderName}”?"},{parentFolderName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}))(e,r),Js=(e,t,n,r,s,o,l,c)=>o?((e,t)=>e.formatMessage({id:"cowZmX",defaultMessage:"You won’t be able to see future changes to this shared folder, and new members of <b>{parentFolderName}</b> won’t have access to this folder automatically."},{parentFolderName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e)}))(e,r):l?c?((e,t,n)=>e.formatMessage({id:"a6N9uo",defaultMessage:"{memberName} will only be able to view this folder, and new {teamName} members won’t be able to access it automatically.{br}{br}To add more people to this folder in the future, you’ll need to invite them directly."},{memberName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),teamName:i.Emstring.em_snippet(n||"team",a.SNIPPET_SIZES.DISPLAY_NAME),br:y.default.createElement("br",null)}))(e,s,t):((e,t,n)=>e.formatMessage({id:"39gzeK",defaultMessage:"{memberName} will only be able to view this folder, and new members of <b>{parentFolderName}</b> won’t be able to access it automatically.{br}{br}To add more people to this folder in the future, you’ll need to invite them directly."},{memberName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),parentFolderName:i.Emstring.em_snippet(n,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e),br:y.default.createElement("br",null)}))(e,s,r):c?((e,t,n)=>e.formatMessage({id:"4qLIy8",defaultMessage:"{teamName} members won’t be able to see future changes to <b>{currentFolderName}</b> automatically.{br}{br}To give people access to this folder in the future, you’ll need to invite them directly."},{teamName:i.Emstring.em_snippet(t||"Team",a.SNIPPET_SIZES.DISPLAY_NAME),currentFolderName:i.Emstring.em_snippet(n,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e),br:y.default.createElement("br",null)}))(e,t,n):((e,t,n)=>e.formatMessage({id:"5HeI0Z",defaultMessage:"{memberName} and new members of the <b>{parentFolderName}</b> folder won’t be able to see future changes to this shared folder.{br}{br}To add more people to this folder in the future, you’ll need to invite them directly."},{memberName:i.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),parentFolderName:i.Emstring.em_snippet(n,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>y.default.createElement("b",{style:{fontWeight:500}},e),br:y.default.createElement("br",null)}))(e,s,r),Xs=(e,t,n,r,s,o,i,l)=>{const c=a.getIsFolder(t),d=a.getParentSharedFolderId(t),u=a.getParentFolderName(t),m=a.getIsSharedFolder(t)&&!a.getIsConfidentialFolder(t)&&d,g=Ur(e,{".tag":"leave_a_copy"})&&!i,_=l.formatMessage({id:"YRtFe9",defaultMessage:"Cancel"});let p=null,f=null,E=null,b=null,h=!1,M=null,S="";const v=()=>{S="https://help.dropbox.com/files-folders/share/remove-link",M=l.formatMessage({id:"SwVT41",defaultMessage:"More about links"}),h=!0};return"remove"===r&&(o?(E=(e=>e.formatMessage({id:"4xmHQa",defaultMessage:"Remove my access"}))(l),c?(p=(e=>e.formatMessage({id:"bsRTH6",defaultMessage:"Remove your access to this folder?"}))(l),f=m?(e=>e.formatMessage({id:"1aWCsg",defaultMessage:"You may still have access to this folder through a company group or parent folder."}))(l):(e=>e.formatMessage({id:"fchbsZ",defaultMessage:"If you continue, you won’t be able to access this folder anymore."}))(l),g&&(b=(e=>e.formatMessage({id:"lLVlO2",defaultMessage:"Keep a copy of this folder"}))(l))):(p=(e=>e.formatMessage({id:"FCMIIX",defaultMessage:"Remove your access to this file?"}))(l),f=(e=>e.formatMessage({id:"6NPSkt",defaultMessage:"If you continue, you won’t be able to access this file anymore."}))(l))):(E=(e=>e.formatMessage({id:"VVzPdA",defaultMessage:"Remove"}))(l),p=((e,t)=>e.formatMessage({id:"WJ0lPe",defaultMessage:"Remove {name}?"},{name:t}))(l,n),c?(m?u?(v(),f=((e,t,a)=>e.formatMessage({id:"pnMbuO",defaultMessage:"If you remove <strong>{name}</strong>, they won’t be able to see future changes to this shared folder. Keep in mind that anyone who can access <strong>{parentname}</strong> will still be able to access this folder."},{strong:e=>y.default.createElement("strong",null,e),name:t,parentname:a}))(l,n,u)):(v(),f=((e,t)=>e.formatMessage({id:"eBf70w",defaultMessage:"If you remove <strong>{name}</strong>, they won’t be able to see future changes to this shared folder. Keep in mind that anyone who can access the parent folder will still be able to access this folder."},{strong:e=>y.default.createElement("strong",null,e),name:t}))(l,n)):f=((e,t)=>e.formatMessage({id:"RL/0uv",defaultMessage:"If you remove <strong>{name}</strong>, they won’t be able to see future changes to this shared folder."},{strong:e=>y.default.createElement("strong",null,e),name:t}))(l,n),g&&(b=((e,t)=>e.formatMessage({id:"82sluj",defaultMessage:"Let {name} keep a copy of this shared folder"},{name:t}))(l,n))):s?(v(),f=(e=>e.formatMessage({id:"oax1/b",defaultMessage:"Keep in mind, if group members have a shared link to this file, they might still be able to view or edit it."}))(l)):(v(),f=(e=>e.formatMessage({id:"WhoBZ9",defaultMessage:"Keep in mind, if they have a shared link to this file, they might still be able to view or edit it."}))(l)))),"owner"===r&&(p=((e,t)=>e.formatMessage({id:"hWdhIJ",defaultMessage:"Make {name} the owner of this folder?"},{name:t}))(l,n),f=((e,t)=>e.formatMessage({id:"6cevm4",defaultMessage:"{name} will become the owner of all items in this folder. Only they will be able to unshare or change folder settings."},{name:t}))(l,n),E=(e=>e.formatMessage({id:"3Do/LR",defaultMessage:"Make owner"}))(l)),{title:p,body:f,confirmText:E,cancelText:_,optionLabel:b,shouldShowLink:h,linkText:M,linkHref:S}},eo=({member:e,selectedAccessLevel:t,isConfirmationModalOpen:n,setIsConfirmationModalOpen:r})=>{const o=s.useIntl(),l=Br(),c=i.useOpenUrl(),{user:d}=a.useActiveUser(),[u,m]=y.useState(!1),g=Ds(),_=Ps(),p=$s(),{objectMetadata:f}=os(),E=Vr(e),b=(e=>"group"in e&&void 0!==e.group)(e),h=Hr(e,d),M=(e=>"user"in e&&void 0!==e.user&&e.user.disabled)(e),S=i.usePlatform()!==i.Platforms.DESKTOP,v=y.useRef(!1);y.useEffect((()=>{v.current||n&&(v.current=!0,l.select(Nr).emit(null))}),[n,l]);const{title:A,body:C,confirmText:I,cancelText:T,optionLabel:L,shouldShowLink:R,linkHref:N,linkText:k}=Xs(e,f,E,t,b,h,M,o);if(void 0===A)return null;const w=e=>Ur(e,{".tag":"leave_a_copy"});return y.createElement(a.Modal$1,{open:n,isCentered:!0,withCloseButton:S?rr(o):void 0,onRequestClose:()=>r(!1)},y.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},y.createElement(a.Modal$1.Title,null,A)),y.createElement(a.Modal$1.Body,{hasVerticalSpacing:!1},C,L?y.createElement("p",{style:{display:"flex",marginTop:"8px"}},y.createElement(a.Checkbox,{"aria-label":pr(o),checked:u,onClick:()=>{m(!u)},style:{marginRight:"var(--spacing__base_unit)"}}),L):null),y.createElement(a.Modal$1.Footer,null,R&&y.createElement(a.Link,{onClick:e=>{e.preventDefault(),c(i.formatUrl(N))},href:N},k),y.createElement("div",{style:{flex:1}}),y.createElement(a.Button,{variant:"opacity",onClick:()=>r(!1)},T),y.createElement(a.Button,{variant:"primary",onClick:()=>{const a=qr(e),n="dropbox_id"===a[".tag"]?a.dropbox_id:"";r(!1),"remove"===t&&(h?g(e,!1,w(e)&&u):_(e,!1,!1,w(e)&&u)),"owner"===t&&n&&p(n,e,E)}},I)))};eo.displayName="ManageAccessModalConfirmationModal";const to=({member:e})=>{var t;const n=rs(),{objectMetadata:r,linksMetadata:o,seenStateInfo:l}=os(),d=s.useIntl(),{user:u}=a.useActiveUser(),{openLinkSettings:m}=c.useAtom(n.$props),g=c.useAtom(n.$tempMemberAccessLevelData),[_,p]=y.useState(),[f,E]=y.useState(!1),[b,h]=y.useState(!1),M=xs(),S=Ps(),v=Rs(),A=(e=>{if(!e)return{};const t={};return e.forEach((e=>{const{seen_state_user:{user_id:a,display_name:n,email:r,photo_circle_url:s,same_team:o}}=e,i={account_id:a,name:{given_name:"",surname:"",familiar_name:"",display_name:n,abbreviated_name:""},email:r||"",email_verified:!0,profile_photo_url:s,is_teammate:o,disabled:!1};t[a]=i})),t})(Te(l,o)),C=new Set(Object.keys(A));y.useEffect((()=>{v(f)}),[f,v]);const I=i.getAreMemberSelectorsEqual(null==g?void 0:g.member,qr(e)),T=ao(e),L=I&&(null==g?void 0:g.accessLevel)?g.accessLevel:e.access_type,R="user"in e&&(null===(t=e.user)||void 0===t?void 0:t.disabled)||!1,N=L[".tag"],k=T===(null==u?void 0:u.account_id),w=e.is_inherited,x=a.getCanDoAction(r,{".tag":"update_confidentiality"})&&w,D=x||!a.getIsNonSharedFolder(r)&&a.getCanDoAction(r,{".tag":"relinquish_membership"});let P=no(e,T,r,N,k&&D,C,d,R);const $=(t,s)=>{const o={".tag":s},l=((e,t)=>{const a=Object.keys(i.AccessLevelWeight);return e!==t&&-1!==a.indexOf(e)&&-1!==a.indexOf(t)&&i.AccessLevelWeight[t]<i.AccessLevelWeight[e]})(N,s),c=s===a.MEMBER_ACTION.REMOVE,d=!c&&l;if(c||d){(e=>{n.$showSecurityBanner.set(!0),n.$securityBannerType.set(e)})(c?Wr.RemoveAccess:Wr.DowngradeAccess)}const u=a.getIsSharedFolder(r)?e.inherited_access_type:e.access_type,g=c||d&&u&&l,_=c&&w;var f;N!==s&&(p(s),x&&g?h(!0):_&&a.getIsFolder(r)&&!a.getIsInsideTeamFolderTree(r)?S(e,!1,!1,!1):"remove"===s||"owner"===s?E(!0):"manage_link_access"===s?(f="editor"===N?"edit_link_settings":"view_link_settings",t.preventDefault(),m({initialTab:f})):M(o,!1,e))};return w&&"viewer"===N&&(P=P.filter((e=>"editor"!==e.apiId))),0===P.length?null:1===P.length&&P[0].apiId===N?y.createElement(a.Button,{size:"small",variant:"transparent",hasNoUnderline:!0,style:{cursor:"default"}},y.createElement(a.Text,{color:"faint",size:"small"},tr(d,L))):y.createElement(y.Fragment,null,y.createElement(a.Menu.Wrapper,null,(({getContentProps:t,getTriggerProps:n})=>y.createElement(y.Fragment,null,y.createElement(a.Button,{...n(),size:"small",variant:"transparent",withDropdownIcon:!0,hasNoUnderline:!0,"aria-label":d.formatMessage({id:"O+fOwG",defaultMessage:"Change access for {memberName}"},{memberName:Vr(e)}),"data-uxa-log":"manage_access_dropdown_button"},y.createElement(a.Text,{size:"small"},tr(d,L))),y.createElement(a.Menu.Content,{...t(),placement:"bottom-end",style:{width:300}},y.createElement(a.Menu.Segment,null,P.map((e=>y.createElement(a.Menu.SelectItem,{key:e.label,value:e.apiId,selected:N===e.apiId,disabled:e.disabled,onClick:t=>$(t,e.apiId)},y.createElement(a.Menu.Row,{withTitle:e.label,withSubtitle:e.tooltip,style:e.variant&&"red"===e.variant?{color:"var(--color__alert__text)"}:void 0}))))))))),y.createElement(eo,{member:e,selectedAccessLevel:_,isConfirmationModalOpen:f,setIsConfirmationModalOpen:E}),y.createElement(Qs,{isOpen:b,member:e,selectedAccessLevel:_,onClose:()=>h(!1)}))};to.displayName="ManageAccessMemberAccessDropdown";const ao=e=>"user"in e&&null!=e.user?e.user.account_id:"group"in e&&null!=e.group?e.group.group_id:"invitee"in e&&null!=e.invitee&&"email"===e.invitee[".tag"]?e.invitee.email:"",no=(e,t,n,r,s,o,i,l)=>{const c=o.has(t),d=a.getIsFolder(n),u=function(e,t){return[["make_editor",{value:"editor",title:L(t),folder_description:k(t),file_description:w(t),collection_description:x(t)}],["make_viewer",{value:"viewer",title:R(t),folder_description:D(t),file_description:D(t),collection_description:P(t)}],["make_viewer_no_comment",{value:"viewer_no_comment",title:N(t),folder_description:$(t),file_description:$(t),collection_description:P(t)}],["make_owner",{value:"owner",title:t.formatMessage({id:"UBvfnM",defaultMessage:"Make owner"}),file_description:"",folder_description:"",collection_description:""}],["remove",{value:"remove",title:e?t.formatMessage({id:"xv0D2w",defaultMessage:"Remove my access"}):t.formatMessage({id:"HRdOei",defaultMessage:"Remove"}),file_description:"",folder_description:"",collection_description:""}],["manage_link_access",{value:"manage_link_access",title:t.formatMessage({id:"EQzfeF",defaultMessage:"Manage access"}),file_description:"",folder_description:"",collection_description:""}]]}(s,i),m={};if(e.permissions)for(const t of e.permissions)m[t.action[".tag"]]=t.allow;let g=[];for(const[e,t]of u){const a=ro(i,m,c,r,e,t,d,s,l);a&&g.push(a)}const _=g.find((e=>"manage_link_access"===e.apiId));return _&&(g=[_]),g},ro=(e,t,a,n,r,s,o,i,l)=>{if("manage_link_access"===s.value&&a)return{apiId:s.value,label:s.title,tooltip:e.formatMessage({id:"qze8JT",defaultMessage:"Change or remove their access in link settings"}),disabled:!1};if(((e,t,a,n,r,s)=>t===a||s&&e in s&&s[e]&&(!r||"remove"===t)||"remove"===t&&n)(r,s.value,n,i,l,t)){const e=o?s.folder_description:s.file_description,t="remove"===s.value?"red":"default";return{apiId:s.value,label:s.title,tooltip:e||"",variant:t}}},so=({member:e,accountDataMap:t})=>{const n=rs(),{seenStateInfo:r}=os(),o=s.useIntl(),{user:l}=a.useActiveUser(),{memberNameTruncationLimit:d}=c.useAtom(n.$props),u=c.useAtom(n.$memberActionsInProgress),m="user"in e&&null!=e.user?t[e.user.account_id]:void 0,g=(e=>{const t={};if(!e)return t;for(const a of e.seen_state_info.seen_states)if(!Le.isAnonymousSeenState(a)){const e=a.seen_state_user.sharing_access_type;if(e)switch(e[".tag"]){case"view_member_access":case"edit_member_access":const n=e.group_ids;for(const e of n)e in t||(t[e]=[]),t[e].push(a)}}return t})(r),_=io(e,m),p=lo(e,o),f=Vr(e),E=mo(o,e,m),b=uo(o,e,g),h=co(e,l),M=qr(e),S=(e=>e.formatMessage({id:"nspb6l",defaultMessage:"External"}))(o),v=null==m?void 0:m.disabled,A=b.length>0,C=((null==E?void 0:E.length)||0)+(h?S.length:0);let I=!1;return u[i.getUniqueId(M)]&&(I=!0),y.createElement(y.Fragment,null,y.createElement(a.Box,{style:{display:"flex",alignItems:"center",height:"52px",padding:"0 8px"},"data-testid":"manage-access-member-list-item",role:"listitem"},y.createElement(a.Box,{style:{width:"36px",display:"flex",flexShrink:0,padding:"0px"}},y.createElement(a.Avatar,{hasNoOutline:!0,size:"standard",src:_},p)),y.createElement(a.Box,{style:{display:"flex",flexDirection:"column",marginLeft:"12px"}},y.createElement(a.Box,{style:{display:"flex",alignItems:"center"}},y.createElement(a.Text,{variant:"label",size:"small"},f.length>(null!=d?d:32)?y.createElement(a.Tooltip,{title:f,placement:"bottom"},y.createElement(a.Box,null,y.createElement(a.Truncate,{lines:1,maxWidth:200},f))):f),v&&y.createElement(y.Fragment,null,y.createElement(a.Box,{style:{padding:"0 2px"}},"·"),y.createElement(a.Text,{variant:"label",color:"error",size:"small"},(e=>e.formatMessage({id:"6jx51W",defaultMessage:"Disabled"}))(o))),A&&y.createElement(oo,{lastSeenTimestamp:b,member:e},y.createElement(a.Text,{color:"faint",size:"small",variant:"label",style:{display:"flex",alignItems:"center"}},y.createElement(a.UIIcon,{src:a.ShowLine,size:"small",style:{marginLeft:"4px"}})))),y.createElement(a.Box,{style:{display:"flex",alignItems:"center",flexGrow:1}},E&&y.createElement(a.Text,{variant:"label",color:"subtle",size:"small"},C>(null!=d?d:32)?y.createElement(a.Tooltip,{title:E,placement:"bottom"},y.createElement(a.Box,null,y.createElement(a.Truncate,{lines:1,maxWidth:145},E))):E),h&&y.createElement(y.Fragment,null,E&&y.createElement(a.Box,{style:{padding:"0 2px"}},"·"),y.createElement(a.Text,{variant:"label",size:"small",style:{color:"var(--dig-color__warning__base)"}},S)))),y.createElement(a.Box,{style:{marginLeft:"auto"}},I?y.createElement(a.Spinner,{style:{marginRight:"8px"},"aria-valuetext":"Loading xsmall",size:"xsmall"}):y.createElement(to,{member:e}))),y.createElement(Ws,{member:e}),y.createElement(Vs,{member:e}),y.createElement(zs,{member:e}),y.createElement(Hs,{member:e}))};so.displayName="ManageAccessMemberListItem";const oo=({member:e,lastSeenTimestamp:t,children:n})=>{const r="group"in e&&void 0!==e.group;return y.createElement(a.Tooltip,{title:y.createElement(a.Box,{display:"flex",flexDirection:"column",alignItems:"center"},t.map(((e,t)=>r?y.createElement(a.Tooltip.Text,{key:t,size:"small",color:"standard",withMargin:!1},e):y.createElement(a.Tooltip.Text,{key:t,size:"small",color:0!==t||r?"subtle":"standard",withMargin:!1},e))))},n)},io=(e,t)=>{if("user"in e&&null!=e.user)return null==t?void 0:t.profile_photo_url},lo=(e,t)=>"user"in e&&null!=e.user?i.getUserInitials(e.user.display_name,t.locale):"group"in e&&void 0!==e.group?i.getGroupInitials(e.group.group_name):"invitee"in e&&void 0!==e.invitee&&"email"===e.invitee[".tag"]?i.getUserInitials(e.invitee.email,t.locale):"",co=(e,t)=>{if("owner"===e.access_type[".tag"])return!1;const a=null==t?void 0:t.is_team;return"user"in e&&null!=e.user&&null!=e.user.email?!!a&&!e.user.same_team:"group"in e&&void 0!==e.group?!e.group.same_team:!("invitee"in e)||void 0===e.invitee||!!e.user&&!e.user.same_team},uo=(e,t,a)=>{const n=[];if("user"in t&&null!=t.user&&"time_last_seen"in t&&null!=t.time_last_seen){const a=t.time_last_seen;n.push(((e,t)=>{let a="";t&&(a=((e,t)=>e.formatMessage({id:"yobnDT",defaultMessage:"Viewed {time_str}"},{time_str:t}))(e,ts(e,t)));return a})(e,new Date(a))),n.push(((e,t)=>e.formatDate(t,{day:"numeric",month:"short",year:"numeric"})+" "+e.formatTime(t,{hour:"numeric",minute:"numeric"}))(e,new Date(a)))}if("group"in t&&void 0!==t.group&&a){const r=t.group.group_id;if(r in a){const t=((e,t)=>{const a=[];let n=0,r=0,s=0;const o=[];t.forEach((e=>{const t=e.seen_state_user.display_name,r=e.when_last_seen;r&&(a.push([t,new Date(1e3*r)]),n+=1)})),r=n<=10?n:9,s=n-r;for(let t=0;t<r;t++){const[n,r]=a[t];o.push(Gr(e,n,r))}return s>0&&o.push(Zr(e,s)),o})(e,a[r]);n.push(...t)}}return n},mo=(e,t,a)=>{if("user"in t&&null!=t.user)return a?a.email_verified?t.user.email:null:t.user.email.endsWith("#")?null:t.user.email;if("group"in t&&null!=t.group){const a=t.group.member_count;return a?((e,t)=>t<=0?"":e.formatMessage({id:"XMHn5C",defaultMessage:"{count, plural, one{# member} other{# members}}"},{count:t}))(e,a):null}return"invitee"in t&&null!=t.invitee&&t.invitee[".tag"],null},go=({inheritedMembers:e,accountDataMap:t})=>{const{objectMetadata:n}=os(),r=s.useIntl(),[o,i]=y.useState(!1),[l,c]=y.useState(!1),[d,u]=y.useState(!1),m=a.getParentFolderName(n),g=a.getOwnerTeamName(n)||"",_=a.getCanDoAction(n,a.UPDATE_CONFIDENTIALITY_TAG),p=[...e.filter((e=>e.is_inherited&&"group"in e)),...e.filter((e=>e.is_inherited&&!("group"in e)))],f=l?p:p.slice(0,25);return 0===e.length?null:y.createElement(y.Fragment,null,y.createElement(a.Box,{style:{backgroundColor:"var(--dig-color__opacity__surface)",borderRadius:"6px"}},y.createElement(a.Box,{style:{height:"52px",display:"flex",alignItems:"center",padding:"0 8px"}},y.createElement(a.Box,{style:{display:"flex",alignItems:"center",height:"32px",width:"32px"}},y.createElement(S.FolderSharedDefaultSmall,null)),y.createElement(a.Box,{style:{marginRight:"auto",marginLeft:"8px"}},y.createElement(a.Text,{size:"small",isBold:!0,style:{lineHeight:"unset"}},y.createElement(a.Truncate,{maxWidth:255},((e,t,a)=>t?e.formatMessage({id:"IJUh05",defaultMessage:"People with access to “{folder_name}”"},{folder_name:t}):e.formatMessage({id:"6fi/fQ",defaultMessage:"Everyone at {team_name}"},{team_name:a}))(r,m,g)))),y.createElement(a.Box,null,e.length>0?y.createElement(a.Box,null,y.createElement(a.IconButton,{variant:"opacity",size:"small",onClick:()=>{i(!o)},"data-uxa-log":"inherited_member_list_toggle"},y.createElement(a.UIIcon,{src:o?a.ChevronDownLine:a.ChevronRightLine,size:"small"}))):null)),o&&y.createElement(a.Box,{style:{display:"flex",flexDirection:"column"}},f.map(((e,n)=>y.createElement(a.Box,{key:n},y.createElement(so,{member:e,accountDataMap:t})))),e.length>5&&!l&&y.createElement(a.Box,null,y.createElement(a.Button,{variant:"outline",size:"small",onClick:()=>{c(!l)},style:{margin:"8px 12px 16px 12px"}},((e,t)=>e.formatMessage({id:"GHErP8",defaultMessage:"Show all {num_members} members"},{num_members:t}))(r,e.length))),_&&y.createElement(a.Box,{style:{display:"flex",padding:"var(--dig-spacing__micro__medium)",justifyContent:"center",borderTop:"1px solid var(--dig-color__border__subtle)"}},y.createElement(a.Button,{variant:"transparent",size:"small",tone:"destructive",onClick:()=>u(!0)},(e=>e.formatMessage({id:"ntjDJF",defaultMessage:"Remove all"}))(r))))),y.createElement(Fs,{isOpen:d,onClose:()=>u(!1)}))};go.displayName="ManageAccessMemberInheritedList";const _o=()=>{const{objectMetadata:e,objectMembers:t,linksMetadata:n,seenStateInfo:r}=os(),{viewer:s}=a.useViewer(),o=Te(r,n),i=Yr(o),l=t?[...t.groups,...t.invitees,...t.users,...i]:[],c=(t?[...t.users,...i]:[]).map((e=>e.user.account_id)),d=Re(c),u=!d.isLoading&&!d.isError?d.output:{},m=((e,t)=>{if(!t)return!1;const n=!!a.getParentSharedFolderId(e);return null!=t.team_id&&!!a.getOwnerTeam(e)&&a.getOwnerTeamId(e)===t.team_dbtid&&n})(e,s),g=m?l.filter((e=>e.is_inherited&&null!=e.access_type&&"traverse"!==e.access_type[".tag"])):[],_=m?l.filter((e=>!e.is_inherited&&null!=e.access_type)):l,p=zr(g),f=zr(_);return y.createElement(a.Box,{style:{height:"100%",overflowY:"auto",scrollbarWidth:"thin"}},y.createElement(go,{inheritedMembers:p,accountDataMap:u}),f.map(((e,t)=>y.createElement(so,{key:t,member:e,accountDataMap:u}))))};_o.displayName="ManageAccessMemberList";const po=()=>{const e=rs(),{objectMembers:t,linksMetadata:n,seenStateInfo:r}=os(),{customNoOtherMembersScreen:o}=c.useAtom(e.$props),i=s.useIntl(),l=Br(),d=c.useAtom(e.$objectIdentifier),u=y.useRef(!1);y.useEffect((()=>{u.current||(u.current=!0,l.select(Ir).emit(null))}),[l]);const m=Te(r,n),g=Yr(m);return t.groups.length>0||t.invitees.length>0||t.users.length>0||g.length>0?(u.current||(u.current=!0,l.select(Ir).emit(null)),y.createElement(a.Box,{style:{display:"flex",flexDirection:"column"}},y.createElement(is,null),y.createElement(_o,null))):o||y.createElement(a.Box,{display:"flex",alignItems:"center",flexDirection:"column"},y.createElement(Qn,{style:{width:"200px",height:"200px"}}),y.createElement(a.Text,{style:{width:"260px",textAlign:"center"}},((e,t)=>e.formatMessage({id:"PDTyQ+",defaultMessage:"When specific people are invited to this {isFile, select, true {file} other {folder}}, they’ll be listed here."},{isFile:t}))(i,"file"===d[".tag"])))};po.displayName="ContentMemberListInner";const fo=()=>{const e=rs(),t=Br(),{objectMetadataResult:n,objectMembersResult:r,listSharedLinksResult:s,accountMetadataResult:o,seenStateInfoResult:i}=c.useAtom(e.$props),[l,d]=y.useState(!1),u=c.useAtom(e.$objectIdentifier),m=n.isLoading,g=!n.isLoading&&!n.isError,_=!r.isFirstPageLoaded,p=r.isFirstPageLoaded&&!r.isFirstPageOnly,f=!s.isLoading&&!s.isError,E=s.isLoading,b=o.isLoading,h=!o.isLoading&&!o.isError,M=i.isLoading,S=!i.isLoading&&!i.isError,v=m||_||E||b||M,A=g&&p&&f&&h&&S;return y.useEffect((()=>{A&&(c.batch((()=>{e.$objectMetadata.set(n.output),e.$objectMembers.set(r.allMembers),e.$linksMetadata.set(s.output),e.$accountMetadata.set(o.output),e.$seenStateInfo.set(i.output)})),d(!0))}),[A,n,r,s,o,i]),y.useEffect((()=>{if(g){const t=n.output,a=t&&".tag"in t&&"shared_folder"===t[".tag"];"file_folder"===u[".tag"]&&a&&e.$objectIdentifier.set({".tag":"shared_folder",sharedFolderId:t.shared_folder_id})}}),[g,u,n,e.$objectIdentifier]),v?y.createElement(a.Box,{style:{display:"flex",alignItems:"center",justifyContent:"center"},"data-testid":"content-member-list-loading-indicator"},y.createElement(a.Spinner,null)):l?y.createElement(po,null):(t.select(Fr).emit(null),null)};fo.displayName="ContentMemberListWithStore";const Eo=()=>{const e=s.useIntl();return y.createElement(a.Box,{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},y.createElement(M.BowlEmptySpot,{style:{width:"200px",height:"200px"}}),y.createElement(a.Text,{style:{width:"260px",textAlign:"center",marginTop:"16px"}},Jn(e)))};Eo.displayName="ErrorFallback";const bo=e=>y.createElement(ss,{...e},y.createElement(a.ErrorBoundary,{FallbackComponent:Eo,onError:e=>{u.reportException({err:e,severity:u.SEVERITY.CRITICAL,tags:["content-member-list"],exc_extra:{message:"Error loading Content Member List"}})}},y.createElement(fo,null)));bo.displayName="ContentMemberList";const ho=({store:e})=>{const{objectIdentifier:t,settingsHandler:n,onRequestClose:r}=c.useStore(e.$props),s=Tt(),l=y.useCallback((e=>{"loaded"===s.status&&s.onObjectIdentifierChanged(e)}),[s]),d=y.useCallback((()=>{r()}),[r]),u=y.useCallback((()=>{e.$currentScreen.set(qt.INBAND)}),[e]),m=y.useCallback((()=>{e.$currentScreen.set(qt.INBAND),a.invalidateSharingObjectMetadata(t),async function(e){const t=i.getContentIdOrPathFromObjectIdentifier(e);a.sharingListSharedLinksPackage.invalidateQueries(o.queryClient,{path:t,direct_only:!0})}(t),a.invalidateObjectMembers(t)}),[t,e.$currentScreen]),g="loaded"===s.status?s.objectIdentifier:t;return g?y.createElement(a.Box,{style:{height:"322px",overflowY:"scroll"}},y.createElement(bo,{objectIdentifier:g,openLinkSettings:n,onRequestClose:d,onChangeConfidentiality:u,onTransferFolderOwnership:m,onObjectIdentifierChanged:l,onConfirmationModalShownChange:()=>{}})):null};ho.displayName="ManageAccessScreen";const Mo=({store:e})=>{var t;const r=c.useStore(e.$props),s=c.useStore(e.$currentScreen),o=c.useStore(e.$isExitingMainToQr),d=c.useStore(e.$isEnteringQr),u=c.useStore(e.$isEnteringInband),m=c.useStore(e.$isInbandStarted),g=c.useStore(e.$isClickawayLocked),_=c.useStore(e.$isSuggestionsOpen),p=c.useStore(e.$componentViewTime),f=c.useStore(e.$displayMode),E=null===(t=a.useExperimentVariant("sm24_mobile_web"))||void 0===t?void 0:t.variant,b=r.isOpen,h=r.fileOrFolder,M=r.onRequestClose,S=r.settingsHandler,v=r.onActionClicked,A=On(),C=Tt();y.useEffect((()=>{b&&(A.select(Pn).emit(null),e.$componentViewTime.set(Date.now()),a.publishEvent(a.CampaignEvents.SHARE_MODAL_OPENED))}),[b,A,e.$componentViewTime]);const I="loaded"===C.status&&C.accountMetadata.is_sharing_banned;y.useEffect((()=>{if(I){M();const t=r.referrerLoggingMetadata;e={actionSurface:null==t?void 0:t.actionSurface,actionElement:null==t?void 0:t.actionElement},a.UDCL.logEvent({class:"share",action:"shown",object:"sharing_banned_modal",properties:{actionSurface:e.actionSurface,actionElement:e.actionElement}}),a.mountModal(y.default.createElement(Ce,{onAfterClose:()=>{a.UDCL.logEvent({class:"share",action:"dismiss",object:"sharing_banned_modal",properties:{actionSurface:e.actionSurface,actionElement:e.actionElement}}),a.unmountModal(void 0,Ae)}}),void 0,Ae)}var e}),[I]);const T=y.useCallback((()=>{if(g||_)return;const e=Date.now()-p,t=m?"clickaway_from_inband":"clickaway";A.select(xn).emit({timeSinceView:e,action:t}),M()}),[g,_,p,m,A,M]),L=y.useCallback((()=>{S({shouldOpenLinkSettings:!0}),v()}),[v,S]),R=y.useCallback((()=>{o&&d&&(e.$isExitingMainToQr.set(!1),e.$currentScreen.set(qt.QRCODE))}),[d,o,e.$currentScreen,e.$isExitingMainToQr]),N=y.useCallback((t=>{d&&t.animationName===i.classes.fadeIn&&e.$isEnteringQr.set(!1)}),[e.$isEnteringQr,d]),k=y.useCallback((t=>{u&&t.animationName===i.classes.expandOuterWrapperInband&&e.$isEnteringInband.set(!1)}),[u,e.$isEnteringInband]),w=y.useCallback((()=>e.$displayMode.set({displayMode:"centered_v1"})),[e.$displayMode]),x=y.useMemo((()=>"ON"===E&&n.is_mobile_or_tablet()?{displayMode:"drawer"}:"anchored_v1"===f.displayMode?{displayMode:"anchored_v1",anchorRef:f.displayModeRef,offsetDistance:5,placement:f.displayModePositioning,onAnchorInvalid:w}:{displayMode:"centered_v1"}),[f,w,E]),D=r.canUserCreateStack,P=l.isContentEligibleForStack(h),$=!!D&&P,O=s!==qt.COPY_LINK?y.createElement(Wn,{store:e}):null;return y.createElement(Se,{onEscape:T,onClickOutside:T,isOpen:b,currentScreen:s,isExitingMainToQr:o,onOverlayOrModalAnimationEnd:R,header:O,...x},y.createElement("div",{className:a.cx("oa-pulsar-effect-SHARE_MODAL_TOKENIZER")},s===qt.INBAND&&y.createElement("div",{onAnimationEnd:k,className:a.cx({[i.classes.inbandScreenExpand]:u}),style:{padding:"6px",minHeight:"310px"}},y.createElement(zn,{store:e})),s===qt.MAIN&&y.createElement(y.Fragment,null,y.createElement(ve,null,y.createElement(ra,{store:e})),y.createElement(ve,null,y.createElement(ye,null,y.createElement(Wt,{store:e})),y.createElement(ye,null,y.createElement(Oa,{store:e}))),$&&y.createElement(ve,null,y.createElement(na,{store:e})),y.createElement(ve,{styleName:a.cx(i.classes.utilityButtonRow,i.classes.buttonRowBmusQr)},y.createElement(_a,{store:e,buttonVariant:"filled"}),y.createElement(Aa,{store:e,buttonVariant:"filled"}))),s===qt.QRCODE&&y.createElement("div",{className:a.cx({[i.classes.qrScreenExpand]:!o&&d}),onAnimationEnd:N},y.createElement(he,{file:h,onSettingsClick:L,onGetQrCodeError:()=>{M()}})),s===qt.MANAGE_ACCESS&&y.createElement(ho,{store:e}),s===qt.COPY_LINK&&y.createElement(Sn,{store:e})))};Mo.displayName="Inner";e.Main=e=>{const t=(e=>c.useInitStore(e,(t=>{const a=c.proxy((()=>t.get().objectIdentifier)),n=c.proxy((()=>t.get().progressiveInbandVariant)),r=c.proxy((()=>t.get().canUserUseTransfer)),s=c.proxy((()=>t.get().canContentUseTransfer)),o=c.proxy((()=>t.get().canUserEnableTransfer)),i=c.proxy((()=>t.get().isTransferEligibilityLoading)),l=c.proxy((()=>t.get().isFolderFileCountOverLimit)),d=c.proxy((()=>t.get().contents)),u=c.store(0),m=c.store(!1),g=c.store(!1),_=c.store(qt.MAIN),p=c.store(!1),f=c.store(!1),E=c.store(!1),b=c.store(!1),h=c.store("anchored_v1"===e.initialDisplayMode?{displayMode:e.initialDisplayMode,displayModePositioning:e.displayModePositioning,displayModeRef:e.displayModeRef}:{displayMode:e.initialDisplayMode}),M=c.store([]),S=c.store("");return{$props:t,$objectIdentifier:a,$progressiveInbandVariant:n,$canUserUseTransfer:r,$canContentUseTransfer:s,$canUserEnableTransfer:o,$isTransferEligibilityLoading:i,$componentViewTime:u,$isClickawayLocked:m,$isInbandStarted:g,$currentScreen:_,$isExitingMainToQr:p,$isEnteringInband:E,$isEnteringQr:f,$isSuggestionsOpen:b,$displayMode:h,$inviteTargets:M,$inviteMessage:S,$isFolderFileCountOverLimit:l,$contents:d}})))(e),{isOpen:n,onRequestClose:s}=e;return n?y.createElement(r.ShareBlockingWrapper,{action:a.LockedStateModalAction.SHARE_MODAL,onStatusChange:e=>{e===a.Status.USER_ABORTED_ACTION&&s()}},y.createElement(Gn,null,y.createElement(Mo,{store:t}))):null},e.Provider=It,e.TokenizerButton=J,e.formatSubtitleNoPermissions=e=>e.formatMessage({id:"ji4c03",defaultMessage:"This folder contains subfolders that you don’t own."}),e.formatSubtitleWithPermissionsFile=e=>e.formatMessage({id:"7453qx",defaultMessage:"When specific people are invited to this file, they’ll be listed here."}),e.formatSubtitleWithPermissionsFolder=e=>e.formatMessage({id:"rgZZgG",defaultMessage:"When specific people are invited to this folder, they’ll be listed here."}),e.formatTitleNoPermissions=e=>e.formatMessage({id:"66T/EA",defaultMessage:"Can’t manage people with access"}),e.formatTitleWithPermissions=e=>e.formatMessage({id:"f7F1sF",defaultMessage:"Keep track of people and permissions"}),e.useData=Tt}));
//# sourceMappingURL=c_shareme24_main.js-vflbt_sM3.map

//# debugId=2071ec1a-d9c6-3809-83c5-4e9520a5efb1