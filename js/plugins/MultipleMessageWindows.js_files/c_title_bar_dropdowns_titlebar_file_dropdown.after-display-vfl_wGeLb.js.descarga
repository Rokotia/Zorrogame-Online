!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="3366495b-e359-3e8d-9a81-4e62dfcb95c5")}catch(e){}}();
define(["require","exports","react","./e_file_viewer_static_scl_page_file","./c_core_i18n","./c_flows_conversions_conversion_actions","./c_dig-icons_assets_ui-icon_line_sidebar-show-right","./c_action_plugins_open_in_action_dropdown","./c_lodash-es_lodash","./c_cloud_docs_open_with_utils","./c_file_viewer_components_titlebar_menu_content","./c_memoize-one","./e_core_exception","./c_src_sink_index","./c_api_v2_routes_password_confirmation_provider","./c_api_v2_routes_cloud_docs_provider","./e_edison","./c_chat_chat_constants","./c_init_data_edison","./c_init_data_debug_panel","./c_react-use_misc_util","./e_data_modules_stormcrow","./c_watermarking_utils_getImageDefaultSizes","./c_api_v2_client_base","./c_spectrum_util_raf_throttle","./c_core_notify","react-dom","./c_spectrum_util_uuid_generator","./c_security_csrf_hmac","metaserver/static/js/langpack","./c_dig-icons_assets_ui-icon_line_pdf","./c_dig-icons_assets_ui-icon_line_video","./c_react-use_useEffectOnce","./c_icon_templates_stateless_index","./c_spectrum_svg_icon_bundle","./c_shared_components_templates_modal_template","./c_profile_services_profile_services_link","./c_abuse_login_and_register_constants_fetch","./c_react_query_helpers_queries_login_and_register_constants","./c_api_v2_default_team_client","./c_dig-icons_assets_ui-icon_line_rotate-right","./c_gdd_migration_ui_utils","./c_file_imports_gdrive_file_picker","./c_shortcuts_conversion_utils","./c_icon_shortcuts_icon","./c_spectrum-content-icon-compatibility_src_file_icon","./c_dig-content-icons_icons_file-unknown-large","./c_dig-content-icons_hooks_useContentIconViewbox","./c_dig-content-icons_icons_file-link-large","./c_dig-content-icons_icons_folder-team-read-only-small","./c_dig-content-icons_icons_folder-shared-default-small","./c_dig-content-icons_icons_folder-base-default-large","./c_dig-content-icons_icons_folder-base-default-small","./c_dig-content-icons_icons_file-excel-large","./c_icon_folder_icon","./c_ui_title_bubble","./c_ui_overlay","./c_cloud_docs_hooks","./c_extensions_open_button_utils","./c_spectrum_modal_utility_modal","./c_spectrum_button","./c_spectrum_tertiary_link","./c_icon_templates_actionable_index","./c_spectrum_icon_form_index","./c_ui_image","./c_dig-icons_assets_ui-icon_line_shuffle","./c_ui_sprite","./c_dig-icons_assets_ui-icon_line_admin-console"],(function(e,i,t,n,o,r,c,s,a,l,_,u,d,S,f,v,p,A,w,I,E,h,P,C,g,m,D,T,b,N,L,O,R,y,F,K,k,M,x,U,V,G,H,B,W,z,Y,j,q,X,Z,Q,$,J,ee,ie,te,ne,oe,re,ce,se,ae,le,_e,ue,de,Se){"use strict";function fe(e){if(e&&e.__esModule)return e;var i=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(i,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),i.default=e,Object.freeze(i)}var ve=fe(t);const pe={...n.fileActionCondition,filterValidFile:e=>{const i=n.fileActionCondition.filterValidFile(e);return!i||n.isInsideVaultFolder(i)||n.isPnmSuppressMoveSelected(i)||n.isEncryptedFile(i)?void 0:i}},Ae=n.withActionCondition(pe,((i,t,o,r)=>({label:n.COPY_ACTION_STRING,userAction:n.UserAction.Copy,icon:n.CopyLine,action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_copy_action_action"],i,t)})).then((({copyActionWrapper:e})=>e({file:i.file,user:i.user,previewType:t,browseContext:o,browseExceptions:r})))},disabled:{disabled:!1}})),void 0),we=n.withActionCondition(n.deleteActionCondition,((i,t,o,r,c)=>({label:n.DELETE_ACTION_STRING,icon:n.DeleteLine,userAction:n.UserAction.Delete,disabled:i.file.read_only?{disabled:!0,tooltipMessage:n.ACTION_DISABLED_STRING}:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_delete_action_action"],i,t)})).then((({deleteActionWrapper:e})=>e({logUserAction:t,setDeleteFileModalOpenCallback:o,file:i.file,user:i.user,previewSurface:r,onFileChanged:c})))}})),void 0),Ie=n.withActionCondition(n.duplicateFilesActionCondition,((e,i)=>({userAction:void 0,label:n.FIND_DUPLICATES_ACTION_STRING,accessibleLabel:n.FIND_DUPLICATES_ACTION_STRING,action:{type:"click",handler:async()=>i()},disabled:{disabled:!1},icon:n.DuplicateLine})),void 0),Ee=[n.SDKPreviewSurface.BROWSE,n.SDKPreviewSurface.FILE_LOCKING,n.SDKPreviewSurface.HELLOSIGN,n.SDKPreviewSurface.HOME,n.SDKPreviewSurface.INBAND_SHARE,n.SDKPreviewSurface.PHOTOS,n.SDKPreviewSurface.RECENTS,n.SDKPreviewSurface.SEARCH,n.SDKPreviewSurface.SHARED_COLLECTION,n.SDKPreviewSurface.SHARED_CONTENT_LINK,n.SDKPreviewSurface.SHARED_LINK,n.SDKPreviewSurface.SHARED_LINK_EMBED,n.SDKPreviewSurface.SHARED_COLLECTION,n.SDKPreviewSurface.STANDALONE_PREVIEW,n.SDKPreviewSurface.STARRED,n.SDKPreviewSurface.TRANSFER,n.SDKPreviewSurface.UNKNOWN,n.SDKPreviewSurface.VERSION_HISTORY,n.SDKPreviewSurface.FSS_DESKTOP_PREVIEW],he={filterValidFile:n.allowAllFiles,filterValidUser:n.filterLoggedInUser,shouldShowForPreviewSurface:n.filterSurfaceIn(Ee),shouldShowForPreviewType:n.alwaysShow},Pe=n.withActionCondition(he,((e,i)=>({userAction:void 0,icon:n.FileHistoryLine,label:n.FILE_ACTIVITY_ACTION_STRING,accessibleLabel:n.FILE_ACTIVITY_ACCESSIBILITY_STRING,action:{type:"click",handler:async()=>i()},disabled:{disabled:!1}})),void 0);const Ce=e=>{const{conversionActions:i,file:t}=e,n=i.filter((e=>e.actionGroup===r.ConversionActionGroup.VIDEO_SCALE)),o=i.filter((e=>e.actionGroup!==r.ConversionActionGroup.VIDEO_SCALE)),c=o.length>0?ge(o,t,e):null,s=n.length>0?ge(n,t,e):null;return ve.default.createElement(ve.default.Fragment,null,c,s)},ge=(e,i,t)=>ve.default.createElement(n.Menu.Segment,null,e.map((e=>{const r=i.bytes/Math.pow(1024,2),c=n.getConversionFileSizeLimitMB([n.file_extension(n.getFilename(i))],e.actionText),s=r>c,a=o.intl.formatMessage({id:"0vePbC",defaultMessage:"File is larger than the {fileSizeLimitMB}MB limit"},{fileSizeLimitMB:c}),l=ve.default.createElement(n.Menu.ActionItem,{key:e.actionText,disabled:s,value:{handler:()=>(({file:e,user:i,action:t,encryptionOptions:o,logUserAction:r,context:c,shareToken:s,actionSurface:a="",sharedLinkInfo:l,sharePermissions:_,previewSurface:u})=>{if(r(n.UserAction.SelectSaveAs,c,{conversion_type:t.actionText,actionSurface:a}),i)t.convert([e],i,{shareToken:s,source:"preview"});else{const e=new URL(window.location.href);e.searchParams.set("save_as","true"),e.searchParams.set("save_as_action",t.actionText),window.history.replaceState(e.href,"",e.href),n.showAuthModal({mode:n.Mode.REGISTER,sharedLinkUrl:e.href,kind:n.LoginOrRegisterKind.POSTSAVEAS,encryptionOptions:o,loggingExtra:{signup_source:"save_as"},signupTag:n.RegistrationSource.SHMODEL_SAVE_AS_REGISTER,webSignInTag:n.getWebSignInTag(!1,u,_),authDialogPreviousElement:n.AuthDialogPreviousElementTag.SAVE_AS,sharedLinkInfo:l})}})({...t,action:e})},withLeftAccessory:ve.default.createElement(n.UIIcon,{src:e.actionIcon,width:"20px",height:"20px"})},e.actionText);return s?ve.default.createElement(n.Tooltip,{key:e.actionText,title:a,placement:"left",id:"flows-disabled-menu-item-tooltip"},ve.default.createElement("div",null,l)):l}))),me=[n.SDKPreviewSurface.BROWSE,n.SDKPreviewSurface.FILE_LOCKING,n.SDKPreviewSurface.HELLOSIGN,n.SDKPreviewSurface.HOME,n.SDKPreviewSurface.INBAND_SHARE,n.SDKPreviewSurface.PHOTOS,n.SDKPreviewSurface.RECENTS,n.SDKPreviewSurface.SEARCH,n.SDKPreviewSurface.SHARED_CONTENT_LINK,n.SDKPreviewSurface.SHARED_LINK,n.SDKPreviewSurface.STANDALONE_PREVIEW,n.SDKPreviewSurface.STARRED,n.SDKPreviewSurface.FSS_DESKTOP_PREVIEW],De={filterValidFile:e=>!e||n.isInsideSharedFolder(e)||n.isEncryptedFile(e)?void 0:e,filterValidUser:e=>({user:e}),shouldShowForPreviewSurface:n.filterSurfaceIn(me),shouldShowForPreviewType:n.alwaysShow},Te=n.withActionCondition(De,((e,i,t,o,s,a)=>{const l=function({getActiveFile:e,user:i},t){const{file:o,sharedLinkInfo:c,sharePermission:s}=e();return n.canConvertFile(o,s)&&n.canDownloadFile(c,s)?r.getConversionActionsForFiles(i,[o],{},t):[]}({getActiveFile:t,user:e.user},o);if(l.length)return{label:n.FILE_CONVERSION_STRING,userAction:n.UserAction.OpenSaveAs,disabled:{disabled:!1},icon:c.ConvertFileLine,action:{type:"menu",menu:ve.default.createElement(Ce,{context:n.UserActionContext.FileMenu,conversionActions:l,encryptionOptions:s,file:e.file,logUserAction:i,user:e.user,sharedLinkInfo:t().sharedLinkInfo,sharePermissions:t().sharePermission,previewSurface:a})}}}),void 0),be=e=>({userAction:void 0,disabled:{disabled:!1},action:{type:"click",handler:async()=>e()},label:n.INFO_ACTION_STRING,accessibleLabel:n.INFO_ACCESSIBILITY_STRING,icon:n.InfoLine}),Ne=n.withActionCondition(n.moveActionCondition,((i,t,o,r,c,s)=>({label:n.MOVE_ACTION_STRING,icon:n.MoveLine,userAction:n.UserAction.Move,disabled:i.file.read_only?{disabled:!0,tooltipMessage:n.ACTION_DISABLED_STRING}:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_move_action_action"],i,t)})).then((({moveActionWrapper:e})=>e({file:i.file,user:i.user,previewType:t,previewSurface:o,onFileChanged:r,browseContext:c,browseExceptions:s})))}})),void 0);const Le=()=>{const{optionalIOClients:{printClient:e}}=n.useFileViewerContext(),i=function(){var e,i,t;const o=n.useRootPreviewMetadata();if(!o)return"";const{content:r}=o;return"image"===(null==r?void 0:r[".tag"])?null!==(e=null==r?void 0:r.full_size_src)&&void 0!==e?e:"":"ssr_doc"===(null==r?void 0:r[".tag"])?null!==(i=null==r?void 0:r.autoprint_url)&&void 0!==i?i:"":"text"===(null==r?void 0:r[".tag"])&&null!==(t=null==r?void 0:r.extracted_text)&&void 0!==t?t:""}(),t=n.useRootPreviewType();return ve.default.useMemo((()=>()=>{i&&(null==e||e.print(i,t))}),[t,e,i])},Oe=[n.PreviewType.SsrDoc,n.PreviewType.Image,n.PreviewType.Text,n.PreviewType.Excel],Re={shouldShowForPreviewSurface:n.alwaysShow,shouldShowForPreviewType:n.filterPreviewTypeIn(Oe),filterValidUser:e=>({user:e}),filterValidFile:(e,i,t)=>t||n.isEncryptedFile(e)?void 0:e},ye=n.withActionCondition(Re,((e,i)=>({label:n.PRINT_ACTION_STRING,userAction:n.UserAction.Print,disabled:{disabled:!1},action:{type:"click",handler:async()=>i()},icon:c.PrintLine})),void 0),Fe=n.withActionCondition(n.renameActionConditions,((e,i)=>({label:n.RENAME_ACTION_STRING,icon:n.CursorLine,userAction:n.UserAction.Rename,action:{type:"click",handler:async()=>{i(!0)}},disabled:e.file.read_only?{disabled:!0,tooltipMessage:n.ACTION_DISABLED_STRING}:{disabled:!1}})),void 0),Ke=n.withActionCondition(n.starActionConditions,((e,i,t,o,r)=>({label:o,icon:t,userAction:i?n.UserAction.Unstar:n.UserAction.Star,action:{type:"click",handler:async()=>r()},disabled:{disabled:!1}})),void 0),ke=o.defineMessage({id:"pB6h1Y",defaultMessage:"Archive files over 512 MB cannot be extracted"}),Me=n.withActionCondition(n.unzipActionConditions,((i,t)=>{const o=i.file.bytes/1048576;return{label:n.UNZIP_ACTION_MESSAGE,icon:n.UnzipAction.actionIcon,disabled:o>=n.UNZIP_MAX_FILESIZE_MB?{disabled:!0,tooltipMessage:ke}:{disabled:!1},userAction:n.UserAction.Unzip,action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_unzip_action_action"],i,t)})).then((({unzipAction:e})=>e({user:i.user,file:i.file,shareToken:t})))}}}),void 0),xe=[n.SDKPreviewSurface.BROWSE,n.SDKPreviewSurface.BACKUP,n.SDKPreviewSurface.FILE_LOCKING,n.SDKPreviewSurface.HELLOSIGN,n.SDKPreviewSurface.HOME,n.SDKPreviewSurface.INBAND_SHARE,n.SDKPreviewSurface.PHOTOS,n.SDKPreviewSurface.RECENTS,n.SDKPreviewSurface.SEARCH,n.SDKPreviewSurface.SHARED_CONTENT_LINK,n.SDKPreviewSurface.SHARED_LINK,n.SDKPreviewSurface.STANDALONE_PREVIEW,n.SDKPreviewSurface.STARRED,n.SDKPreviewSurface.POLLUX_DESKTOP_PREVIEW,n.SDKPreviewSurface.POLLUX_DESKTOP_SEARCH_PREVIEW],Ue={filterValidFile:e=>function(e){const i=n.fileActionCondition.filterValidFile(e);return!!i&&!l.isCloudBasedDoc(i)&&!n.isWebShortcutByExtension(i.fq_path)}(e)?e:void 0,filterValidUser:n.filterLoggedInUser,shouldShowForPreviewSurface:n.filterSurfaceIn(xe),shouldShowForPreviewType:n.alwaysShow};const Ve=n.withActionCondition(Ue,(i=>({label:n.VERSION_HISTORY_ACTION_STRING,icon:n.ClockLine,userAction:n.UserAction.VersionHistory,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_version_history_action_action"],i,t)})).then((({versionHistoryActionWrapper:e})=>e(i.file,i.user)))}})),void 0);i.default=({contentProps:e})=>{var i,t;const{previewSurface:o,pluginArgs:r,fileConfig:c,hasOpenInActions:a}=n.usePluginMigrationContext(),{logUserAction:l,featureConfig:u}=n.useFileViewerContext(),d=n.useCurrentPreviewMetadata();n.useLogExposureOnce("copy_to_dropbox_folder_picker");const S=null!==(i=d.previewType)&&void 0!==i?i:n.PreviewType.Loading,f=r.getActiveFile().file,v=r.getActiveFile().sharePermission,p=r.user,A=n.useRootFile(),{data:w}=n.useFileContentMetadataQuery(A),I=n.useIsNestedArchiveFile(),E=null===(t=null==w?void 0:w.apiData)||void 0===t?void 0:t.metadata,{onFileChanged:h,browseContext:P,browseExceptions:C,canRestoreRevision:g,getActiveFile:m,shareToken:D,encryptionOptions:T,allowUnrequestedSusiModal:b,onRestoreRevision:N,userPresentableVerdict:L}=r,O=ve.useMemo((()=>({file:f,user:p,previewSurface:o,previewType:S,sharePermission:v,isNestedArchiveFile:I,canRestoreRevision:g})),[f,g,I,o,S,v,p]),R=(e=>{const i=n.useSetLeftSidebarCallback(n.UserActionContext.FileMenu);return ve.default.useMemo((()=>Pe(e,(()=>i(n.FILE_ACTIVITY_PLUGIN_ID)))),[e,i])})(O),y=(()=>{const e=n.useSetLeftSidebarCallback(n.UserActionContext.FileMenu);return ve.default.useMemo((()=>be((()=>e(n.INFO_BLADE_PLUGIN_ID)))),[e])})(),F=((e,i)=>{const{onPrint:t}=n.usePreviewControls(),o=Le(),r=n.useStabilizedCallback((()=>{null==t||t(),o()}));return ve.default.useMemo((()=>i.enable_print?ye(e,r):void 0),[e,i.enable_print,r])})(O,c),K=((e,i)=>{const t=n.getStoreForStarred(),{isStarred:o,message:r,iconSrc:c,handleClick:s}=n.useStarControlWithStore({getActiveFile:i,user:e.user,starredStore:t});return ve.default.useMemo((()=>Ke(e,o,c,r,s)),[e,s,c,o,r])})(O,m),k=n.useToggleRenameStateCallback(),M=n.useSetDeleteFileModalOpenCallback(),x=((e,i)=>{const t=n.useRightSidebarId()===n.DUPLICATE_FILES_BLADE_PLUGIN_ID,o=n.useCloseSidebarCallback(i),r=n.useSetRightSidebarCallback(i),c=n.useDuplicateFilesExperimentVariant(),s=n.shouldShowDuplicateFiles(c,e.previewSurface),a=ve.default.useCallback((()=>{t?o(n.DUPLICATE_FILES_BLADE_PLUGIN_ID):r(n.DUPLICATE_FILES_BLADE_PLUGIN_ID)}),[o,t,r]);return ve.default.useMemo((()=>s?Ie(e,a):void 0),[s,e,a])})(O,n.UserActionContext.FileMenu),U=n.useEmitter$2(),V=ve.useCallback((e=>{n.isSharedFile(f)&&U.select(n.ON_CLICK_SHARED_CONTENT_ACTION).emit({actionElement:"action_bar",action:e})}),[U,f]),G=ve.useMemo((()=>[[Ne(O,S,o,h,P,C),Ae(O,S,P,C),we(O,l,M,o,h),Fe(O,k)],[K],[y,Ve(O),R],[s.makeOpenInAction(O,!!a),Te(O,l,m,E,T,o),Me(O,D),...n.makeDownloadActions(O,m,l,E,o,b,D,v,T,null==A?void 0:A.name,n.UserActionContext.FileMenu,V,L,null==u?void 0:u.copy_to_dropbox_folder_picker,null==u?void 0:u.seamless_download_experiment_variant),n.makeRestoreAction(O,N)],[x],[F]]),[O,S,o,h,P,C,l,M,k,K,y,R,a,m,E,T,D,b,v,null==A?void 0:A.name,V,L,null==u?void 0:u.copy_to_dropbox_folder_picker,null==u?void 0:u.seamless_download_experiment_variant,N,x,F]),H=ve.useCallback((e=>l(e,n.UserActionContext.FileMenu)),[l]);return ve.createElement(_.TitlebarMenuContent,{options:G,elementId:"file-menu",contentProps:e,logAction:H})}}));
//# sourceMappingURL=c_title_bar_dropdowns_titlebar_file_dropdown.after-display.js-vflcE75TM.map

//# debugId=3366495b-e359-3e8d-9a81-4e62dfcb95c5